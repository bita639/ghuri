var Qurl;!function(){"use strict";function n(){var n=window.location.search,e=[],t={};return n?(n=n.replace("?",""),e=n.split("&"),e.forEach(function(n){var e=decodeURIComponent(n).split("="),o=e[0],r=e[1];t[o]=r}),t):t}function e(e,r){var u=n();window.location.search;return r===!1?delete u[e]:u[e]=r,t(o(u)),u}function t(n){history.pushState&&history.pushState({},document.title,n)}function o(n){var e=[];return Object.keys(n).forEach(function(t){"undefined"==typeof n[t]?e.push(t):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n[t]||""))}),0===e.length?"?":"?"+e.join("&")}var r;Qurl=function(){return this instanceof Qurl?void 0:new Qurl},r=Qurl.prototype,r.query=function(t,o){return t?t&&"undefined"==typeof o?n()[t]:t&&"undefined"!=typeof o?e(t,o):void 0:n()},Qurl.create=Qurl}();;!function(a){"function"==typeof define&&define.amd?define([],a):"object"==typeof exports?module.exports=a():window.noUiSlider=a()}(function(){"use strict";function a(a){return a.filter(function(a){return this[a]?!1:this[a]=!0},{})}function b(a,b){return Math.round(a/b)*b}function c(a){var b=a.getBoundingClientRect(),c=a.ownerDocument,d=c.documentElement,e=l();return/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(e.x=0),{top:b.top+e.y-d.clientTop,left:b.left+e.x-d.clientLeft}}function d(a){return"number"==typeof a&&!isNaN(a)&&isFinite(a)}function e(a,b,c){i(a,b),setTimeout(function(){j(a,b)},c)}function f(a){return Math.max(Math.min(a,100),0)}function g(a){return Array.isArray(a)?a:[a]}function h(a){var b=a.split(".");return b.length>1?b[1].length:0}function i(a,b){a.classList?a.classList.add(b):a.className+=" "+b}function j(a,b){a.classList?a.classList.remove(b):a.className=a.className.replace(new RegExp("(^|\\b)"+b.split(" ").join("|")+"(\\b|$)","gi")," ")}function k(a,b){return a.classList?a.classList.contains(b):new RegExp("\\b"+b+"\\b").test(a.className)}function l(){var a=void 0!==window.pageXOffset,b="CSS1Compat"===(document.compatMode||""),c=a?window.pageXOffset:b?document.documentElement.scrollLeft:document.body.scrollLeft,d=a?window.pageYOffset:b?document.documentElement.scrollTop:document.body.scrollTop;return{x:c,y:d}}function m(){return window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"}}function n(a,b){return 100/(b-a)}function o(a,b){return 100*b/(a[1]-a[0])}function p(a,b){return o(a,a[0]<0?b+Math.abs(a[0]):b-a[0])}function q(a,b){return b*(a[1]-a[0])/100+a[0]}function r(a,b){for(var c=1;a>=b[c];)c+=1;return c}function s(a,b,c){if(c>=a.slice(-1)[0])return 100;var d,e,f,g,h=r(c,a);return d=a[h-1],e=a[h],f=b[h-1],g=b[h],f+p([d,e],c)/n(f,g)}function t(a,b,c){if(c>=100)return a.slice(-1)[0];var d,e,f,g,h=r(c,b);return d=a[h-1],e=a[h],f=b[h-1],g=b[h],q([d,e],(c-f)*n(f,g))}function u(a,c,d,e){if(100===e)return e;var f,g,h=r(e,a);return d?(f=a[h-1],g=a[h],e-f>(g-f)/2?g:f):c[h-1]?a[h-1]+b(e-a[h-1],c[h-1]):e}function v(a,b,c){var e;if("number"==typeof b&&(b=[b]),"[object Array]"!==Object.prototype.toString.call(b))throw new Error("noUiSlider: 'range' contains invalid value.");if(e="min"===a?0:"max"===a?100:parseFloat(a),!d(e)||!d(b[0]))throw new Error("noUiSlider: 'range' value isn't numeric.");c.xPct.push(e),c.xVal.push(b[0]),e?c.xSteps.push(isNaN(b[1])?!1:b[1]):isNaN(b[1])||(c.xSteps[0]=b[1])}function w(a,b,c){return b?void(c.xSteps[a]=o([c.xVal[a],c.xVal[a+1]],b)/n(c.xPct[a],c.xPct[a+1])):!0}function x(a,b,c,d){this.xPct=[],this.xVal=[],this.xSteps=[d||!1],this.xNumSteps=[!1],this.snap=b,this.direction=c;var e,f=[];for(e in a)a.hasOwnProperty(e)&&f.push([a[e],e]);for(f.length&&"object"==typeof f[0][0]?f.sort(function(a,b){return a[0][0]-b[0][0]}):f.sort(function(a,b){return a[0]-b[0]}),e=0;e<f.length;e++)v(f[e][1],f[e][0],this);for(this.xNumSteps=this.xSteps.slice(0),e=0;e<this.xNumSteps.length;e++)w(e,this.xNumSteps[e],this)}function y(a,b){if(!d(b))throw new Error("noUiSlider: 'step' is not numeric.");a.singleStep=b}function z(a,b){if("object"!=typeof b||Array.isArray(b))throw new Error("noUiSlider: 'range' is not an object.");if(void 0===b.min||void 0===b.max)throw new Error("noUiSlider: Missing 'min' or 'max' in 'range'.");if(b.min===b.max)throw new Error("noUiSlider: 'range' 'min' and 'max' cannot be equal.");a.spectrum=new x(b,a.snap,a.dir,a.singleStep)}function A(a,b){if(b=g(b),!Array.isArray(b)||!b.length||b.length>2)throw new Error("noUiSlider: 'start' option is incorrect.");a.handles=b.length,a.start=b}function B(a,b){if(a.snap=b,"boolean"!=typeof b)throw new Error("noUiSlider: 'snap' option must be a boolean.")}function C(a,b){if(a.animate=b,"boolean"!=typeof b)throw new Error("noUiSlider: 'animate' option must be a boolean.")}function D(a,b){if(a.animationDuration=b,"number"!=typeof b)throw new Error("noUiSlider: 'animationDuration' option must be a number.")}function E(a,b){if("lower"===b&&1===a.handles)a.connect=1;else if("upper"===b&&1===a.handles)a.connect=2;else if(b===!0&&2===a.handles)a.connect=3;else{if(b!==!1)throw new Error("noUiSlider: 'connect' option doesn't match handle count.");a.connect=0}}function F(a,b){switch(b){case"horizontal":a.ort=0;break;case"vertical":a.ort=1;break;default:throw new Error("noUiSlider: 'orientation' option is invalid.")}}function G(a,b){if(!d(b))throw new Error("noUiSlider: 'margin' option must be numeric.");if(0!==b&&(a.margin=a.spectrum.getMargin(b),!a.margin))throw new Error("noUiSlider: 'margin' option is only supported on linear sliders.")}function H(a,b){if(!d(b))throw new Error("noUiSlider: 'limit' option must be numeric.");if(a.limit=a.spectrum.getMargin(b),!a.limit)throw new Error("noUiSlider: 'limit' option is only supported on linear sliders.")}function I(a,b){switch(b){case"ltr":a.dir=0;break;case"rtl":a.dir=1,a.connect=[0,2,1,3][a.connect];break;default:throw new Error("noUiSlider: 'direction' option was not recognized.")}}function J(a,b){if("string"!=typeof b)throw new Error("noUiSlider: 'behaviour' must be a string containing options.");var c=b.indexOf("tap")>=0,d=b.indexOf("drag")>=0,e=b.indexOf("fixed")>=0,f=b.indexOf("snap")>=0,g=b.indexOf("hover")>=0;if(d&&!a.connect)throw new Error("noUiSlider: 'drag' behaviour must be used with 'connect': true.");a.events={tap:c||f,drag:d,fixed:e,snap:f,hover:g}}function K(a,b){var c;if(b!==!1)if(b===!0)for(a.tooltips=[],c=0;c<a.handles;c++)a.tooltips.push(!0);else{if(a.tooltips=g(b),a.tooltips.length!==a.handles)throw new Error("noUiSlider: must pass a formatter for all handles.");a.tooltips.forEach(function(a){if("boolean"!=typeof a&&("object"!=typeof a||"function"!=typeof a.to))throw new Error("noUiSlider: 'tooltips' must be passed a formatter or 'false'.")})}}function L(a,b){if(a.format=b,"function"==typeof b.to&&"function"==typeof b.from)return!0;throw new Error("noUiSlider: 'format' requires 'to' and 'from' methods.")}function M(a,b){if(void 0!==b&&"string"!=typeof b&&b!==!1)throw new Error("noUiSlider: 'cssPrefix' must be a string or `false`.");a.cssPrefix=b}function N(a,b){if(void 0!==b&&"object"!=typeof b)throw new Error("noUiSlider: 'cssClasses' must be an object.");if("string"==typeof a.cssPrefix){a.cssClasses={};for(var c in b)b.hasOwnProperty(c)&&(a.cssClasses[c]=a.cssPrefix+b[c])}else a.cssClasses=b}function O(a){var b,c={margin:0,limit:0,animate:!0,animationDuration:300,format:R};b={step:{r:!1,t:y},start:{r:!0,t:A},connect:{r:!0,t:E},direction:{r:!0,t:I},snap:{r:!1,t:B},animate:{r:!1,t:C},animationDuration:{r:!1,t:D},range:{r:!0,t:z},orientation:{r:!1,t:F},margin:{r:!1,t:G},limit:{r:!1,t:H},behaviour:{r:!0,t:J},format:{r:!1,t:L},tooltips:{r:!1,t:K},cssPrefix:{r:!1,t:M},cssClasses:{r:!1,t:N}};var d={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",cssPrefix:"noUi-",cssClasses:{target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",ltr:"ltr",rtl:"rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",stacking:"stacking",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"}};return Object.keys(b).forEach(function(e){if(void 0===a[e]&&void 0===d[e]){if(b[e].r)throw new Error("noUiSlider: '"+e+"' is required.");return!0}b[e].t(c,void 0===a[e]?d[e]:a[e])}),c.pips=a.pips,c.style=c.ort?"top":"left",c}function P(b,d,n){function o(a,b,c){var d=a+b[0],e=a+b[1];return c?(0>d&&(e+=Math.abs(d)),e>100&&(d-=e-100),[f(d),f(e)]):[d,e]}function p(a,b){a.preventDefault();var c,d,e=0===a.type.indexOf("touch"),f=0===a.type.indexOf("mouse"),g=0===a.type.indexOf("pointer"),h=a;return 0===a.type.indexOf("MSPointer")&&(g=!0),e&&(c=a.changedTouches[0].pageX,d=a.changedTouches[0].pageY),b=b||l(),(f||g)&&(c=a.clientX+b.x,d=a.clientY+b.y),h.pageOffset=b,h.points=[c,d],h.cursor=f||g,h}function q(a,b){var c=document.createElement("div"),e=document.createElement("div"),f=[d.cssClasses.handleLower,d.cssClasses.handleUpper];return a&&f.reverse(),i(e,d.cssClasses.handle),i(e,f[b]),i(c,d.cssClasses.origin),c.appendChild(e),c}function r(a,b,c){switch(a){case 1:i(b,d.cssClasses.connect),i(c[0],d.cssClasses.background);break;case 3:i(c[1],d.cssClasses.background);case 2:i(c[0],d.cssClasses.connect);case 0:i(b,d.cssClasses.background)}}function s(a,b,c){var d,e=[];for(d=0;a>d;d+=1)e.push(c.appendChild(q(b,d)));return e}function t(a,b,c){i(c,d.cssClasses.target),0===a?i(c,d.cssClasses.ltr):i(c,d.cssClasses.rtl),0===b?i(c,d.cssClasses.horizontal):i(c,d.cssClasses.vertical);var e=document.createElement("div");return i(e,d.cssClasses.base),c.appendChild(e),e}function u(a,b){if(!d.tooltips[b])return!1;var c=document.createElement("div");return c.className=d.cssClasses.tooltip,a.firstChild.appendChild(c)}function v(){d.dir&&d.tooltips.reverse();var a=W.map(u);d.dir&&(a.reverse(),d.tooltips.reverse()),S("update",function(b,c,e){a[c]&&(a[c].innerHTML=d.tooltips[c]===!0?b[c]:d.tooltips[c].to(e[c]))})}function w(a,b,c){if("range"===a||"steps"===a)return _.xVal;if("count"===a){var d,e=100/(b-1),f=0;for(b=[];(d=f++*e)<=100;)b.push(d);a="positions"}return"positions"===a?b.map(function(a){return _.fromStepping(c?_.getStep(a):a)}):"values"===a?c?b.map(function(a){return _.fromStepping(_.getStep(_.toStepping(a)))}):b:void 0}function x(b,c,d){function e(a,b){return(a+b).toFixed(7)/1}var f=_.direction,g={},h=_.xVal[0],i=_.xVal[_.xVal.length-1],j=!1,k=!1,l=0;return _.direction=0,d=a(d.slice().sort(function(a,b){return a-b})),d[0]!==h&&(d.unshift(h),j=!0),d[d.length-1]!==i&&(d.push(i),k=!0),d.forEach(function(a,f){var h,i,m,n,o,p,q,r,s,t,u=a,v=d[f+1];if("steps"===c&&(h=_.xNumSteps[f]),h||(h=v-u),u!==!1&&void 0!==v)for(i=u;v>=i;i=e(i,h)){for(n=_.toStepping(i),o=n-l,r=o/b,s=Math.round(r),t=o/s,m=1;s>=m;m+=1)p=l+m*t,g[p.toFixed(5)]=["x",0];q=d.indexOf(i)>-1?1:"steps"===c?2:0,!f&&j&&(q=0),i===v&&k||(g[n.toFixed(5)]=[i,q]),l=n}}),_.direction=f,g}function y(a,b,c){function e(a,b){var c=b===d.cssClasses.value,e=c?m:n,f=c?k:l;return b+" "+e[d.ort]+" "+f[a]}function f(a,b,c){return'class="'+e(c[1],b)+'" style="'+d.style+": "+a+'%"'}function g(a,e){_.direction&&(a=100-a),e[1]=e[1]&&b?b(e[0],e[1]):e[1],j+="<div "+f(a,d.cssClasses.marker,e)+"></div>",e[1]&&(j+="<div "+f(a,d.cssClasses.value,e)+">"+c.to(e[0])+"</div>")}var h=document.createElement("div"),j="",k=[d.cssClasses.valueNormal,d.cssClasses.valueLarge,d.cssClasses.valueSub],l=[d.cssClasses.markerNormal,d.cssClasses.markerLarge,d.cssClasses.markerSub],m=[d.cssClasses.valueHorizontal,d.cssClasses.valueVertical],n=[d.cssClasses.markerHorizontal,d.cssClasses.markerVertical];return i(h,d.cssClasses.pips),i(h,0===d.ort?d.cssClasses.pipsHorizontal:d.cssClasses.pipsVertical),Object.keys(a).forEach(function(b){g(b,a[b])}),h.innerHTML=j,h}function z(a){var b=a.mode,c=a.density||1,d=a.filter||!1,e=a.values||!1,f=a.stepped||!1,g=w(b,e,f),h=x(c,b,g),i=a.format||{to:Math.round};return Z.appendChild(y(h,d,i))}function A(){var a=V.getBoundingClientRect(),b="offset"+["Width","Height"][d.ort];return 0===d.ort?a.width||V[b]:a.height||V[b]}function B(a,b,c){var e;for(e=0;e<d.handles;e++)if(-1===$[e])return;void 0!==b&&1!==d.handles&&(b=Math.abs(b-d.dir)),Object.keys(ba).forEach(function(d){var e=d.split(".")[0];a===e&&ba[d].forEach(function(a){a.call(X,g(P()),b,g(C(Array.prototype.slice.call(aa))),c||!1,$)})})}function C(a){return 1===a.length?a[0]:d.dir?a.reverse():a}function D(a,b,c,e){var f=function(b){return Z.hasAttribute("disabled")?!1:k(Z,d.cssClasses.tap)?!1:(b=p(b,e.pageOffset),a===Y.start&&void 0!==b.buttons&&b.buttons>1?!1:e.hover&&b.buttons?!1:(b.calcPoint=b.points[d.ort],void c(b,e)))},g=[];return a.split(" ").forEach(function(a){b.addEventListener(a,f,!1),g.push([a,f])}),g}function E(a,b){if(-1===navigator.appVersion.indexOf("MSIE 9")&&0===a.buttons&&0!==b.buttonsProperty)return F(a,b);var c,d,e=b.handles||W,f=!1,g=100*(a.calcPoint-b.start)/b.baseSize,h=e[0]===W[0]?0:1;if(c=o(g,b.positions,e.length>1),f=L(e[0],c[h],1===e.length),e.length>1){if(f=L(e[1],c[h?0:1],!1)||f)for(d=0;d<b.handles.length;d++)B("slide",d)}else f&&B("slide",h)}function F(a,b){var c=V.querySelector("."+d.cssClasses.active),e=b.handles[0]===W[0]?0:1;null!==c&&j(c,d.cssClasses.active),a.cursor&&(document.body.style.cursor="",document.body.removeEventListener("selectstart",document.body.noUiListener));var f=document.documentElement;f.noUiListeners.forEach(function(a){f.removeEventListener(a[0],a[1])}),j(Z,d.cssClasses.drag),B("set",e),B("change",e),void 0!==b.handleNumber&&B("end",b.handleNumber)}function G(a,b){"mouseout"===a.type&&"HTML"===a.target.nodeName&&null===a.relatedTarget&&F(a,b)}function H(a,b){var c=document.documentElement;if(1===b.handles.length){if(b.handles[0].hasAttribute("disabled"))return!1;i(b.handles[0].children[0],d.cssClasses.active)}a.preventDefault(),a.stopPropagation();var e=D(Y.move,c,E,{start:a.calcPoint,baseSize:A(),pageOffset:a.pageOffset,handles:b.handles,handleNumber:b.handleNumber,buttonsProperty:a.buttons,positions:[$[0],$[W.length-1]]}),f=D(Y.end,c,F,{handles:b.handles,handleNumber:b.handleNumber}),g=D("mouseout",c,G,{handles:b.handles,handleNumber:b.handleNumber});if(c.noUiListeners=e.concat(f,g),a.cursor){document.body.style.cursor=getComputedStyle(a.target).cursor,W.length>1&&i(Z,d.cssClasses.drag);var h=function(){return!1};document.body.noUiListener=h,document.body.addEventListener("selectstart",h,!1)}void 0!==b.handleNumber&&B("start",b.handleNumber)}function I(a){var b,f,g=a.calcPoint,h=0;return a.stopPropagation(),W.forEach(function(a){h+=c(a)[d.style]}),b=h/2>g||1===W.length?0:1,W[b].hasAttribute("disabled")&&(b=b?0:1),g-=c(V)[d.style],f=100*g/A(),d.events.snap||e(Z,d.cssClasses.tap,d.animationDuration),W[b].hasAttribute("disabled")?!1:(L(W[b],f),B("slide",b,!0),B("set",b,!0),B("change",b,!0),void(d.events.snap&&H(a,{handles:[W[b]]})))}function J(a){var b=a.calcPoint-c(V)[d.style],e=_.getStep(100*b/A()),f=_.fromStepping(e);Object.keys(ba).forEach(function(a){"hover"===a.split(".")[0]&&ba[a].forEach(function(a){a.call(X,f)})})}function K(a){if(a.fixed||W.forEach(function(a,b){D(Y.start,a.children[0],H,{handles:[a],handleNumber:b})}),a.tap&&D(Y.start,V,I,{handles:W}),a.hover&&D(Y.move,V,J,{hover:!0}),a.drag){var b=[V.querySelector("."+d.cssClasses.connect)];i(b[0],d.cssClasses.draggable),a.fixed&&b.push(W[b[0]===W[0]?1:0].children[0]),b.forEach(function(a){D(Y.start,a,H,{handles:W})})}}function L(a,b,c){var e=a!==W[0]?1:0,g=$[0]+d.margin,h=$[1]-d.margin,k=$[0]+d.limit,l=$[1]-d.limit;return W.length>1&&(b=e?Math.max(b,g):Math.min(b,h)),c!==!1&&d.limit&&W.length>1&&(b=e?Math.min(b,k):Math.max(b,l)),b=_.getStep(b),b=f(b),b===$[e]?!1:(window.requestAnimationFrame?window.requestAnimationFrame(function(){a.style[d.style]=b+"%"}):a.style[d.style]=b+"%",a.previousSibling||(j(a,d.cssClasses.stacking),b>50&&i(a,d.cssClasses.stacking)),$[e]=b,aa[e]=_.fromStepping(b),B("update",e),!0)}function M(a,b){var c,e,f;for(d.limit&&(a+=1),c=0;a>c;c+=1)e=c%2,f=b[e],null!==f&&f!==!1&&("number"==typeof f&&(f=String(f)),f=d.format.from(f),(f===!1||isNaN(f)||L(W[e],_.toStepping(f),c===3-d.dir)===!1)&&B("update",e))}function N(a,b){var c,f,h=g(a);for(b=void 0===b?!0:!!b,d.dir&&d.handles>1&&h.reverse(),d.animate&&-1!==$[0]&&e(Z,d.cssClasses.tap,d.animationDuration),c=W.length>1?3:1,1===h.length&&(c=1),M(c,h),f=0;f<W.length;f++)null!==h[f]&&b&&B("set",f)}function P(){var a,b=[];for(a=0;a<d.handles;a+=1)b[a]=d.format.to(aa[a]);return C(b)}function Q(){for(var a in d.cssClasses)d.cssClasses.hasOwnProperty(a)&&j(Z,d.cssClasses[a]);for(;Z.firstChild;)Z.removeChild(Z.firstChild);delete Z.noUiSlider}function R(){var a=$.map(function(a,b){var c=_.getApplicableStep(a),d=h(String(c[2])),e=aa[b],f=100===a?null:c[2],g=Number((e-c[2]).toFixed(d)),i=0===a?null:g>=c[1]?c[2]:c[0]||!1;return[i,f]});return C(a)}function S(a,b){ba[a]=ba[a]||[],ba[a].push(b),"update"===a.split(".")[0]&&W.forEach(function(a,b){B("update",b)})}function T(a){var b=a&&a.split(".")[0],c=b&&a.substring(b.length);Object.keys(ba).forEach(function(a){var d=a.split(".")[0],e=a.substring(d.length);b&&b!==d||c&&c!==e||delete ba[a]})}function U(a,b){var c=P(),e=O({start:[0,0],margin:a.margin,limit:a.limit,step:void 0===a.step?d.singleStep:a.step,range:a.range,animate:a.animate,snap:void 0===a.snap?d.snap:a.snap});["margin","limit","range","animate"].forEach(function(b){void 0!==a[b]&&(d[b]=a[b])}),e.spectrum.direction=_.direction,_=e.spectrum,$=[-1,-1],N(a.start||c,b)}var V,W,X,Y=m(),Z=b,$=[-1,-1],_=d.spectrum,aa=[],ba={};if(Z.noUiSlider)throw new Error("Slider was already initialized.");return V=t(d.dir,d.ort,Z),W=s(d.handles,d.dir,V),r(d.connect,Z,W),d.pips&&z(d.pips),d.tooltips&&v(),X={destroy:Q,steps:R,on:S,off:T,get:P,set:N,updateOptions:U,options:n,target:Z,pips:z},K(d.events),X}function Q(a,b){if(!a.nodeName)throw new Error("noUiSlider.create requires a single element.");var c=O(b,a),d=P(a,c,b);return d.set(c.start),a.noUiSlider=d,d}x.prototype.getMargin=function(a){return 2===this.xPct.length?o(this.xVal,a):!1},x.prototype.toStepping=function(a){return a=s(this.xVal,this.xPct,a),this.direction&&(a=100-a),a},x.prototype.fromStepping=function(a){return this.direction&&(a=100-a),t(this.xVal,this.xPct,a)},x.prototype.getStep=function(a){return this.direction&&(a=100-a),a=u(this.xPct,this.xSteps,this.snap,a),this.direction&&(a=100-a),a},x.prototype.getApplicableStep=function(a){var b=r(a,this.xPct),c=100===a?2:1;return[this.xNumSteps[b-2],this.xVal[b-c],this.xNumSteps[b-c]]},x.prototype.convert=function(a){return this.getStep(this.toStepping(a))};var R={to:function(a){return void 0!==a&&a.toFixed(2)},from:Number};return{create:Q}});;(function(B){var L,T,Q,M,d,m,J,A,O,z,C=0,H={},j=[],e=0,G={},y=[],f=null,o=new Image,i=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,k=/[^\.]\.(swf)\s*$/i,p,N=1,h=0,t="",b,c,P=false,s=B.extend(B("<div/>")[0],{prop:0}),S=/MSIE 6/.test(navigator.userAgent)&&B.browser.version<7&&!window.XMLHttpRequest,r=function(){T.hide();o.onerror=o.onload=null;if(f){f.abort()}L.empty()},x=function(){if(false===H.onError(j,C,H)){T.hide();P=false;return}H.titleShow=false;H.width="auto";H.height="auto";L.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>');n()},w=function(){var Z=j[C],W,Y,ab,aa,V,X;r();H=B.extend({},B.fn.fancybox.defaults,typeof B(Z).data("fancybox")=="undefined"?H:B(Z).data("fancybox"));X=H.onStart(j,C,H);if(X===false){P=false;return}else{if(typeof X=="object"){H=B.extend(H,X)}}ab=H.title||(Z.nodeName?B(Z).attr("title"):Z.title)||"";if(Z.nodeName&&!H.orig){H.orig=B(Z).children("img:first").length?B(Z).children("img:first"):B(Z)}if(ab===""&&H.orig&&H.titleFromAlt){ab=H.orig.attr("alt")}W=H.href||(Z.nodeName?B(Z).attr("href"):Z.href)||null;if(/^(?:javascript)/i.test(W)||W=="#"){W=null}if(H.type){Y=H.type;if(!W){W=H.content}}else{if(H.content){Y="html"}else{if(W){if(W.match(i)){Y="image"}else{if(W.match(k)){Y="swf"}else{if(B(Z).hasClass("iframe")){Y="iframe"}else{if(W.indexOf("#")===0){Y="inline"}else{Y="ajax"}}}}}}}if(!Y){x();return}if(Y=="inline"){Z=W.substr(W.indexOf("#"));Y=B(Z).length>0?"inline":"ajax"}H.type=Y;H.href=W;H.title=ab;if(H.autoDimensions){if(H.type=="html"||H.type=="inline"||H.type=="ajax"){H.width="auto";H.height="auto"}else{H.autoDimensions=false}}if(H.modal){H.overlayShow=true;H.hideOnOverlayClick=false;H.hideOnContentClick=false;H.enableEscapeButton=false;H.showCloseButton=false}H.padding=parseInt(H.padding,10);H.margin=parseInt(H.margin,10);L.css("padding",H.padding+H.margin);B(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change",function(){B(this).replaceWith(m.children())});switch(Y){case"html":L.html(H.content);n();break;case"inline":if(B(Z).parent().is("#fancybox-content")===true){P=false;return}B('<div class="fancybox-inline-tmp" />').hide().insertBefore(B(Z)).bind("fancybox-cleanup",function(){B(this).replaceWith(m.children())}).bind("fancybox-cancel",function(){B(this).replaceWith(L.children())});B(Z).appendTo(L);n();break;case"image":P=false;B.fancybox.showActivity();o=new Image;o.onerror=function(){x()};o.onload=function(){P=true;o.onerror=o.onload=null;F()};o.src=W;break;case"swf":H.scrolling="no";aa='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+H.width+'" height="'+H.height+'"><param name="movie" value="'+W+'"></param>';V="";B.each(H.swf,function(ac,ad){aa+='<param name="'+ac+'" value="'+ad+'"></param>';V+=" "+ac+'="'+ad+'"'});aa+='<embed src="'+W+'" type="application/x-shockwave-flash" width="'+H.width+'" height="'+H.height+'"'+V+"></embed></object>";L.html(aa);n();break;case"ajax":P=false;B.fancybox.showActivity();H.ajax.win=H.ajax.success;f=B.ajax(B.extend({},H.ajax,{url:W,data:H.ajax.data||{},dataType:"text",error:function(ac,ae,ad){if(ac.status>0){x()}},success:function(ad,af,ac){var ae=typeof ac=="object"?ac:f;if(ae.status==200||ae.status===0){if(typeof H.ajax.win=="function"){X=H.ajax.win(W,ad,af,ac);if(X===false){T.hide();return}else{if(typeof X=="string"||typeof X=="object"){ad=X}}}L.html(ad);n()}}}));break;case"iframe":E();break}},n=function(){var V=H.width,W=H.height;if(V.toString().indexOf("%")>-1){V=parseInt((B(window).width()-H.margin*2)*parseFloat(V)/100,10)+"px"}else{V=V=="auto"?"auto":V+"px"}if(W.toString().indexOf("%")>-1){W=parseInt((B(window).height()-H.margin*2)*parseFloat(W)/100,10)+"px"}else{W=W=="auto"?"auto":W+"px"}L.wrapInner('<div style="width:'+V+";height:"+W+";overflow: "+(H.scrolling=="auto"?"auto":H.scrolling=="yes"?"scroll":"hidden")+';position:relative;"></div>');H.width=L.width();H.height=L.height();E()},F=function(){H.width=o.width;H.height=o.height;B("<img />").attr({id:"fancybox-img",src:o.src,alt:H.title}).appendTo(L);E()},E=function(){var W,V;T.hide();if(M.is(":visible")&&false===G.onCleanup(y,e,G)){B(".fancybox-inline-tmp").trigger("fancybox-cancel");P=false;return}P=true;B(m.add(Q)).unbind();B(window).unbind("resize.fb scroll.fb");B(document).unbind("keydown.fb");if(M.is(":visible")&&G.titlePosition!=="outside"){M.css("height",M.height())}y=j;e=C;G=H;if(G.overlayShow){Q.css({"background-color":G.overlayColor,opacity:G.overlayOpacity,cursor:G.hideOnOverlayClick?"pointer":"auto",height:B(document).height()});if(!Q.is(":visible")){if(S){B("select:not(#fancybox-tmp select)").filter(function(){return this.style.visibility!=="hidden"}).css({visibility:"hidden"}).one("fancybox-cleanup",function(){this.style.visibility="inherit"})}Q.show()}}else{Q.hide()}c=R();l();if(M.is(":visible")){B(J.add(O).add(z)).hide();W=M.position(),b={top:W.top,left:W.left,width:M.width(),height:M.height()};V=b.width==c.width&&b.height==c.height;m.fadeTo(G.changeFade,.3,function(){var X=function(){m.html(L.contents()).fadeTo(G.changeFade,1,v)};B(".fancybox-inline-tmp").trigger("fancybox-change");m.empty().removeAttr("filter").css({"border-width":G.padding,width:c.width-G.padding*2,height:H.autoDimensions?"auto":c.height-h-G.padding*2});if(V){X()}else{s.prop=0;B(s).animate({prop:1},{duration:G.changeSpeed,easing:G.easingChange,step:U,complete:X})}});return}M.removeAttr("style");m.css("border-width",G.padding);if(G.transitionIn=="elastic"){b=I();m.html(L.contents());M.show();if(G.opacity){c.opacity=0}s.prop=0;B(s).animate({prop:1},{duration:G.speedIn,easing:G.easingIn,step:U,complete:v});return}if(G.titlePosition=="inside"&&h>0){A.show()}m.css({width:c.width-G.padding*2,height:H.autoDimensions?"auto":c.height-h-G.padding*2}).html(L.contents());M.css(c).fadeIn(G.transitionIn=="none"?0:G.speedIn,v)},D=function(V){if(V&&V.length){if(G.titlePosition=="float"){return'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">'+V+'</td><td id="fancybox-title-float-right"></td></tr></table>'}return'<div id="fancybox-title-'+G.titlePosition+'">'+V+"</div>"}return false},l=function(){t=G.title||"";h=0;A.empty().removeAttr("style").removeClass();if(G.titleShow===false){A.hide();return}t=B.isFunction(G.titleFormat)?G.titleFormat(t,y,e,G):D(t);if(!t||t===""){A.hide();return}A.addClass("fancybox-title-"+G.titlePosition).html(t).appendTo("body").show();switch(G.titlePosition){case"inside":A.css({width:c.width-G.padding*2,marginLeft:G.padding,marginRight:G.padding});h=A.outerHeight(true);A.appendTo(d);c.height+=h;break;case"over":A.css({marginLeft:G.padding,width:c.width-G.padding*2,bottom:G.padding}).appendTo(d);break;case"float":A.css("left",parseInt((A.width()-c.width-40)/2,10)*-1).appendTo(M);break;default:A.css({width:c.width-G.padding*2,paddingLeft:G.padding,paddingRight:G.padding}).appendTo(M);break}A.hide()},g=function(){if(G.enableEscapeButton||G.enableKeyboardNav){B(document).bind("keydown.fb",function(V){if(V.keyCode==27&&G.enableEscapeButton){V.preventDefault();B.fancybox.close()}else{if((V.keyCode==37||V.keyCode==39)&&G.enableKeyboardNav&&V.target.tagName!=="INPUT"&&V.target.tagName!=="TEXTAREA"&&V.target.tagName!=="SELECT"){V.preventDefault();B.fancybox[V.keyCode==37?"prev":"next"]()}}})}if(!G.showNavArrows){O.hide();z.hide();return}if(G.cyclic&&y.length>1||e!==0){O.show()}if(G.cyclic&&y.length>1||e!=y.length-1){z.show()}},v=function(){if(B.support.opacity===false){m.get(0).style.removeAttribute("filter");M.get(0).style.removeAttribute("filter")}if(H.autoDimensions){m.css("height","auto")}M.css("height","auto");if(t&&t.length){A.show()}if(G.showCloseButton){J.show()}g();if(G.hideOnContentClick){m.bind("click",B.fancybox.close)}if(G.hideOnOverlayClick){Q.bind("click",B.fancybox.close)}B(window).bind("resize.fb",B.fancybox.resize);if(G.centerOnScroll){B(window).bind("scroll.fb",B.fancybox.center)}if(G.type=="iframe"){B('<iframe id="fancybox-frame" name="fancybox-frame'+(new Date).getTime()+'" frameborder="0" hspace="0" '+(window.attachEvent?'allowtransparency="true""':"")+' scrolling="'+H.scrolling+'" src="'+G.href+'"></iframe>').appendTo(m)}M.show();P=false;B.fancybox.center();G.onComplete(y,e,G);K()},K=function(){var V,W;if(y.length-1>e){V=y[e+1].href;if(typeof V!=="undefined"&&V.match(i)){W=new Image;W.src=V}}if(e>0){V=y[e-1].href;if(typeof V!=="undefined"&&V.match(i)){W=new Image;W.src=V}}},U=function(W){var V={width:parseInt(b.width+(c.width-b.width)*W,10),height:parseInt(b.height+(c.height-b.height)*W,10),top:parseInt(b.top+(c.top-b.top)*W,10),left:parseInt(b.left+(c.left-b.left)*W,10)};if(typeof c.opacity!=="undefined"){V.opacity=W<.5?.5:W}M.css(V);m.css({width:V.width-G.padding*2,height:V.height-h*W-G.padding*2})},u=function(){return[B(window).width()-G.margin*2,B(window).height()-G.margin*2,B(document).scrollLeft()+G.margin,B(document).scrollTop()+G.margin]},R=function(){var V=u(),Z={},W=G.autoScale,X=G.padding*2,Y;if(G.width.toString().indexOf("%")>-1){Z.width=parseInt(V[0]*parseFloat(G.width)/100,10)}else{Z.width=G.width+X}if(G.height.toString().indexOf("%")>-1){Z.height=parseInt(V[1]*parseFloat(G.height)/100,10)}else{Z.height=G.height+X}if(W&&(Z.width>V[0]||Z.height>V[1])){if(H.type=="image"||H.type=="swf"){Y=G.width/G.height;if(Z.width>V[0]){Z.width=V[0];Z.height=parseInt((Z.width-X)/Y+X,10)}if(Z.height>V[1]){Z.height=V[1];Z.width=parseInt((Z.height-X)*Y+X,10)}}else{Z.width=Math.min(Z.width,V[0]);Z.height=Math.min(Z.height,V[1])}}Z.top=parseInt(Math.max(V[3]-20,V[3]+(V[1]-Z.height-40)*.5),10);Z.left=parseInt(Math.max(V[2]-20,V[2]+(V[0]-Z.width-40)*.5),10);return Z},q=function(V){var W=V.offset();W.top+=parseInt(V.css("paddingTop"),10)||0;W.left+=parseInt(V.css("paddingLeft"),10)||0;W.top+=parseInt(V.css("border-top-width"),10)||0;W.left+=parseInt(V.css("border-left-width"),10)||0;W.width=V.width();W.height=V.height();return W},I=function(){var Y=H.orig?B(H.orig):false,X={},W,V;if(Y&&Y.length){W=q(Y);X={width:W.width+G.padding*2,height:W.height+G.padding*2,top:W.top-G.padding-20,left:W.left-G.padding-20}}else{V=u();X={width:G.padding*2,height:G.padding*2,top:parseInt(V[3]+V[1]*.5,10),left:parseInt(V[2]+V[0]*.5,10)}}return X},a=function(){if(!T.is(":visible")){clearInterval(p);return}B("div",T).css("top",N*-40+"px");N=(N+1)%12};B.fn.fancybox=function(V){if(!B(this).length){return this}B(this).data("fancybox",B.extend({},V,B.metadata?B(this).metadata():{})).unbind("click.fb").bind("click.fb",function(X){X.preventDefault();if(P){return}P=true;B(this).blur();j=[];C=0;var W=B(this).attr("rel")||"";if(!W||W==""||W==="nofollow"){j.push(this)}else{j=B('a[rel="'+W+'"], area[rel="'+W+'"]');C=j.index(this)}w();return});return this};B.fancybox=function(Y){var X;if(P){return}P=true;X=typeof arguments[1]!=="undefined"?arguments[1]:{};j=[];C=parseInt(X.index,10)||0;if(B.isArray(Y)){for(var W=0,V=Y.length;W<V;W++){if(typeof Y[W]=="object"){B(Y[W]).data("fancybox",B.extend({},X,Y[W]))}else{Y[W]=B({}).data("fancybox",B.extend({content:Y[W]},X))}}j=jQuery.merge(j,Y)}else{if(typeof Y=="object"){B(Y).data("fancybox",B.extend({},X,Y))}else{Y=B({}).data("fancybox",B.extend({content:Y},X))}j.push(Y)}if(C>j.length||C<0){C=0}w()};B.fancybox.showActivity=function(){clearInterval(p);T.show();p=setInterval(a,66)};B.fancybox.hideActivity=function(){T.hide()};B.fancybox.next=function(){return B.fancybox.pos(e+1)};B.fancybox.prev=function(){return B.fancybox.pos(e-1)};B.fancybox.pos=function(V){if(P){return}V=parseInt(V);j=y;if(V>-1&&V<y.length){C=V;w()}else{if(G.cyclic&&y.length>1){C=V>=y.length?0:y.length-1;w()}}return};B.fancybox.cancel=function(){if(P){return}P=true;B(".fancybox-inline-tmp").trigger("fancybox-cancel");r();H.onCancel(j,C,H);P=false};B.fancybox.close=function(){if(P||M.is(":hidden")){return}P=true;if(G&&false===G.onCleanup(y,e,G)){P=false;return}r();B(J.add(O).add(z)).hide();B(m.add(Q)).unbind();B(window).unbind("resize.fb scroll.fb");B(document).unbind("keydown.fb");if(G.type==="iframe"){m.find("iframe").attr("src",S&&/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank")}if(G.titlePosition!=="inside"){A.empty()}M.stop();function V(){Q.fadeOut("fast");A.empty().hide();M.hide();B(".fancybox-inline-tmp").trigger("fancybox-cleanup");m.empty();G.onClosed(y,e,G);y=H=[];e=C=0;G=H={};P=false}if(G.transitionOut=="elastic"){b=I();var W=M.position();c={top:W.top,left:W.left,width:M.width(),height:M.height()};if(G.opacity){c.opacity=1}A.empty().hide();s.prop=1;B(s).animate({prop:0},{duration:G.speedOut,easing:G.easingOut,step:U,complete:V})}else{M.fadeOut(G.transitionOut=="none"?0:G.speedOut,V)}};B.fancybox.resize=function(){if(Q.is(":visible")){Q.css("height",B(document).height())}B.fancybox.center(true)};B.fancybox.center=function(){var V,W;if(P){return}W=arguments[0]===true?1:0;V=u();if(!W&&(M.width()>V[0]||M.height()>V[1])){return}M.stop().animate({top:parseInt(Math.max(V[3]-20,V[3]+(V[1]-m.height()-40)*.5-G.padding)),left:parseInt(Math.max(V[2]-20,V[2]+(V[0]-m.width()-40)*.5-G.padding))},typeof arguments[0]=="number"?arguments[0]:200)};B.fancybox.init=function(){if(B("#fancybox-wrap").length){return}B("body").append(L=B('<div id="fancybox-tmp"></div>'),T=B('<div id="fancybox-loading"><span class="spinner-circle"></span></div>'),Q=B('<div id="fancybox-overlay"></div>'),M=B('<div id="fancybox-wrap"></div>'));d=B('<div id="fancybox-outer"></div>').append('<div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div>').appendTo(M);d.append(m=B('<div id="fancybox-content"></div>'),J=B('<a id="fancybox-close"></a>'),A=B('<div id="fancybox-title"></div>'),O=B('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'),z=B('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>'));J.click(B.fancybox.close);T.click(B.fancybox.cancel);O.click(function(V){V.preventDefault();B.fancybox.prev()});z.click(function(V){V.preventDefault();B.fancybox.next()});if(B.fn.mousewheel){M.bind("mousewheel.fb",function(V,W){if(P){V.preventDefault()}else{if(B(V.target).get(0).clientHeight==0||B(V.target).get(0).scrollHeight===B(V.target).get(0).clientHeight){V.preventDefault();B.fancybox[W>0?"prev":"next"]()}}})}if(B.support.opacity===false){M.addClass("fancybox-ie")}if(S){T.addClass("fancybox-ie6");M.addClass("fancybox-ie6");B('<iframe id="fancybox-hide-sel-frame" src="'+(/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank")+'" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(d)}};B.fn.fancybox.defaults={padding:10,margin:40,opacity:false,modal:false,cyclic:false,scrolling:"auto",width:560,height:340,autoScale:true,autoDimensions:true,centerOnScroll:false,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:true,hideOnContentClick:false,overlayShow:true,overlayOpacity:.7,overlayColor:"#777",titleShow:true,titlePosition:"float",titleFormat:null,titleFromAlt:false,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:true,showNavArrows:true,enableEscapeButton:true,enableKeyboardNav:true,onStart:function(){},onCancel:function(){},onComplete:function(){},onCleanup:function(){},onClosed:function(){},onError:function(){}};B(document).ready(function(){B.fancybox.init()})})(jQuery);function initLightbox(){jQuery('a.lightbox, a[data-rel*="lightbox"]').addClass("ready");jQuery('a.lightbox, a[data-rel*="lightbox"]').each(function(){var link=jQuery(this);link.attr("rel",link.attr("data-rel")).fancybox({padding:0,margin:25,cyclic:true,autoScale:true,overlayShow:true,overlayOpacity:.8,overlayColor:"#000000",titlePosition:"outside",onComplete:function(box){if(link.attr("href").indexOf("#")===0){jQuery("#fancybox-content").find("a.close").unbind("click.fb").bind("click.fb",function(e){jQuery.fancybox.close();e.preventDefault()})}}})})}jQuery(function(){initLightbox();var isTouchDevice="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch;var isWinPhoneDevice=navigator.msPointerEnabled&&/MSIE 10.*Touch/.test(navigator.userAgent);var styleTag=jQuery("<style>").appendTo("head");styleSheet=styleTag.prop("sheet")||styleTag.prop("styleSheet");var addCSSRule=function(selector,rules,index){if(styleSheet.insertRule){styleSheet.insertRule(selector+"{"+rules+"}",index)}else{styleSheet.addRule(selector,rules,index)}};if(isTouchDevice||isWinPhoneDevice){setTimeout(function(){var page=jQuery("body"),fancySideShadows=jQuery("#fancybox-bg-ne, #fancybox-bg-e, #fancybox-bg-se"),fancyOverlay=jQuery("#fancybox-overlay"),fancyWrap=jQuery("#fancybox-wrap");jQuery.fancybox.center=function(){if(fancyWrap.innerWidth()>fancyOverlay.innerWidth()){fancyWrap.css({padding:0});fancySideShadows.css({display:"none"})}else{fancyWrap.css({padding:""});fancySideShadows.css({display:""})}fancyWrap.css({left:(page.innerWidth()-fancyWrap.innerWidth())/2})};jQuery(window).on("resize orientationchange",function(){jQuery.fancybox.center()})},1)}else{addCSSRule("#fancybox-overlay","position:fixed;top:0;left:0")}});;var onClick,onChange,onSelect,onFocusDate,onInnerFilterClick,isMobileFilterActive,initResultDOMListners=false;function BmFilter(){"use strict";var filters={cid:new Array,aid:new Array,daytours:new Array,packagetours:new Array,grouptours:new Array,privatetours:new Array,selfguidedtours:new Array,discount:new Array,last_minute_deals:new Array,departure_month:new Array,oid:new Array,did:new Array,sort:new Array,date:new Array,price:new Array,duration:new Array,continent:new Array,age:new Array,sdid:new Array,edid:new Array};var filterTexts={duration:"Duration: ",price:"Price: "};var ajaxTimer;var doneAjaxInterval=305;var eventListners=[];var url=Qurl.create();var filterHistory=new Array;var sortHistory=new Array;var selector="[data-filter]";var searchSelector="[data-search]";var innerSelector="[data-innerfilter]";var innerDatatarget="[data-target]";var removeFiltersSelector="[data-remove]";var dataValue="data-value";var dataFilter="data-filter";var dataInnerSelector="data-target";var dataSearch="data-search";var dataRemove="data-remove";var dataName="data-name";var dataChildren="data-children";var resultsDiv="trips-results";var loadingDiv="tours-main-holder";var loadingClass=" loading";var seperator=".";var resultsTitleDiv="resultTitle";var resultsFound="resultsFound";var appliedFiltersDiv="applied-filters";var noresultsDiv="filter-noresults";var scrollDiv="search-two-columns";var sortByName="sort-by-name";var defaultSort="Popularity";var filterButtons="filter-buttons";var noResultsBtn="no-results-button";var filterSideBar="fixed-filter";var isMobileDevice=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);var durationSlider=document.getElementById("duration-slider");var priceSlider=document.getElementById("price-slider");var flatPickerInstance=null;if(window.isMobile){var noresultsDiv=false;var scrollDiv=false}var isDesktopTemplate=false;if(window.isDesktopTemplate){isDesktopTemplate=true}var __construct=function(){activateFilters();_noUiSlider();var elements=document.querySelectorAll(selector);for(var i=elements.length-1;i>=0;i--){if(elements[i].type=="text"){if(elements[i].id=="specific-pick-date"&&window.isMobile||isDesktopTemplate){elements[i].addEventListener("focus",function(e){onFocusDate(e);e.stopPropagation()})}elements[i].addEventListener("change",function(e){onChange(e);e.stopPropagation()})}else if(elements[i].id=="mbl-trip-sort"){elements[i].addEventListener("change",function(e){onSelect(e);e.stopPropagation()})}else{elements[i].addEventListener("click",function(e){onClick(e);e.stopPropagation()})}}initResultDOMListners=function(){var elements=document.querySelectorAll(innerSelector);for(var i=elements.length-1;i>=0;i--){elements[i].addEventListener("click",function(e){onInnerFilterClick(e);e.stopPropagation()})}};initResultDOMListners();var elements=document.querySelectorAll(searchSelector);for(var i=elements.length-1;i>=0;i--){elements[i].addEventListener("keyup",function(e){onSearch(e)})}window.onerror=function(msg,url,line,col,error){var extra=!col?"":"\ncolumn: "+col;extra+=!error?"":"\nerror: "+error;var error="Error: "+msg+"\nurl: "+url+"\nline: "+line+extra;if(!!window.jQuery){$.post(baseUrl+"/site/savejserror",{error:error})}}};onClick=function(e){var element=e.target;var value=element.getAttribute(dataValue);var filter=element.getAttribute(dataFilter);var name=element.getAttribute(dataName);var children=element.getAttribute(dataChildren);var type=element.previousElementSibling.getAttribute("type");if(type==="radio"){removeFilter(filter,name,value)}pushPopFilters(filter,name,value,{},function(){applyFilters(function(){loadNewResults();makeActiveFilters();makeActiveSort();listenRemovers()})});if(!!children&&children!=0){setTimeout(function(){var childrenArray=children.split(",");for(var ci=0;ci<childrenArray.length;ci++){var parentCheckBox=element.previousElementSibling;var parentChecked=parentCheckBox.checked;var parentElm=document.getElementById(childrenArray[ci]);var previouslyCheckBox=document.getElementById(childrenArray[ci]);var previouslyChecked=previouslyCheckBox.checked;var childElement=document.getElementById(childrenArray[ci]).nextElementSibling;var change=false;if(parentChecked&&!parentElm.checked){parentElm.checked=true;change=true}else if(!parentChecked&&parentElm.checked){parentElm.checked=false;change=true}if(!change){continue}var value=childElement.getAttribute(dataValue);var filter=childElement.getAttribute(dataFilter);var name=childElement.getAttribute(dataName);pushPopFilters(filter,name,value,{child:true},function(){applyFilters(function(){loadNewResults();makeActiveFilters();makeActiveSort();listenRemovers()})})}},100)}};onSelect=function(e){var element=e.target;var s=document.getElementById("mbl-trip-sort");if(sortView.selectedValue!=s.selectedIndex){sortView.selectedValue=s.selectedIndex;var selected=sortView.getSelectedOptionValue();var value=selected.value;var filter=element.getAttribute(dataFilter);var name=selected.title;removeFilter(filter,name,value);pushPopFilters(filter,name,value,{},function(){applyFilters(function(){loadNewResults();makeActiveFilters();makeActiveSort();listenRemovers()})})}};onInnerFilterClick=function(e){var element=e.target;var target=element.getAttribute(dataInnerSelector);var targetEl=document.getElementById(target);try{targetEl.nextElementSibling.click()}catch(e){}};onFocusDate=function(e){var element=$bm("#specific-pick-date");var loc=baseUrl+"/themes/rupa/resources/css/common/datepicker.css";element.loadCSS(loc,function(){element.loadCSS("https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css",function(){element.loadJS("https://cdn.jsdelivr.net/npm/flatpickr",function(){if(!flatPickerInstance){flatPickerInstance=flatpickr("#specific-pick-date",{"date-format":"Y-m-d",clickOpens:true,disableMobile:true,onChange:function(selectedDates,dateStr,e){element.setAttribute("data-value",dateStr);element.setAttribute("data-name",dateStr)}})}!flatPickerInstance.isOpen&&flatPickerInstance.open()})})})};onChange=function(e){var element=e.target;var value=element.value;var filter=element.getAttribute(dataFilter);var name=element.getAttribute(dataName);removeTextFilter(filter,name,value);pushPopFilters(filter,name,value,{},function(){applyFilters(function(){loadNewResults();makeActiveFilters();makeActiveSort();listenRemovers()})})};var onSearch=function(e){var element=e.target;var value=element.value;var filter=element.getAttribute(dataSearch);var filterName=element.getAttribute("data-name");var filterData=filterValues[filter];var filteredData=[];var searchLength=value.length;var filterLinks=false;if(typeof filterValues[filter+"Links"]!="undefined"){var filterLinks=filterValues[filter+"Links"]}if(searchLength>0){filterData.forEach(function(element){var index=element.name.toLowerCase().indexOf(value.toLowerCase());var q=element.name.substring(index,index+searchLength);if(q.toLowerCase()==value.toLowerCase()){filteredData.push(element)}if(typeof element.children!=="undefined"){if(element.children.length>0){element.children.forEach(function(e){var subIndex=e.name.toLowerCase().indexOf(value.toLowerCase());var q=e.name.substring(subIndex,subIndex+searchLength);if(q.toLowerCase()==value.toLowerCase()){filteredData.push(e)}})}}})}if(filteredData.length>0){filteredData=remove_duplicates(filteredData,"id");var op="";var timestamp=Number(new Date);filteredData.forEach(function(element){var checked="";if(inArray(filters[filterName],element.id)){checked="checked"}if(filterLinks){var dUrl="";if(typeof filterLinks=="object"){if(Object.keys(filterLinks)[0]=="country"){dUrl=baseUrl+"/"+urlize(filterLinks.country)+"/"+urlize(element.name)+"/a"+element.id+"-bm"}else if(Object.keys(filterLinks)[0]=="continent"){dUrl=baseUrl+"/"+urlize(filterLinks.continent)+"/"+urlize(element.name)+"/a"+element.id+"-bm"}else if(Object.keys(filterLinks)[0]=="destination"){dUrl=baseUrl+"/"+urlize(filterLinks.destination)+"/"+urlize(element.name)+"/d"+filterLinks.destinationId+"-a"+element.id}}else{if(filter=="destinations"){dUrl=baseUrl+"/"+urlize(element.name)+"/d"+element.id+"-bm"}else if(filter=="countries"){dUrl=baseUrl+"/"+urlize(element.name)}}op+='<li><a href="'+dUrl+'">'+element.name+"</a></li>"}else{op+="<li><input "+checked+' type="checkbox" id="search-filter-'+element.id+'" class="custom-checkbox" autocomplete="off"><label for="search-filter-'+element.id+'" data-value="'+element.id+'" data-filter-'+timestamp+'="true" data-filter="'+filterName+'" data-name="'+element.name+'">'+element.name+"</label></li>"}});document.getElementById(filter+"-original").setAttribute("style","display: none");var moreElem=document.getElementById(filter+"-more");if(!!moreElem)moreElem.setAttribute("style","display: none");var filteredElement=document.getElementById(filter+"-filtered");filteredElement.innerHTML=op;filteredElement.setAttribute("style","display: block");setTimeout(function(){var elements=document.querySelectorAll("[data-filter-"+timestamp+"]");for(var i=elements.length-1;i>=0;i--){elements[i].addEventListener("click",function(e){onClick(e);checkUncheckOriginal(e,filter)})}},100)}else{document.getElementById(filter+"-original").setAttribute("style","display: block");var moreElem=document.getElementById(filter+"-more");if(!!moreElem)moreElem.setAttribute("style","display: block");var filteredElement=document.getElementById(filter+"-filtered");filteredElement.innerHTML=op;filteredElement.setAttribute("style","display: none");if(value.length>2){var noresultsElem=document.getElementById(filter+"-noresults");noresultsElem.setAttribute("style","display: block");setTimeout(function(){noresultsElem.setAttribute("style","display: none")},3e3)}}};var checkUncheckOriginal=function(e,filter){var element=e.target;var _dataFilter=element.getAttribute(dataFilter);var _dataValue=element.getAttribute(dataValue);var originalElement=document.getElementById(filter+"-original");var mainElement=originalElement.querySelector('[data-filter="'+_dataFilter+'"][data-value="'+_dataValue+'"]');if(!!mainElement){var inputElement=mainElement.previousElementSibling;var checked=inputElement.getAttribute("checked");if(checked){inputElement.removeAttribute("checked")}else{inputElement.setAttribute("checked",true)}}else{var originalElement=document.getElementById(filter+"-more");if(!!originalElement){var mainElement=originalElement.querySelector('[data-filter="'+_dataFilter+'"][data-value="'+_dataValue+'"]');if(!!mainElement){var inputElement=mainElement.previousElementSibling;var checked=inputElement.getAttribute("checked");if(checked){inputElement.removeAttribute("checked")}else{inputElement.setAttribute("checked",true)}}}}};var pushPopAgeFilters=function(value){var filter="age";if(filters[filter].length>0){var _dataValue=filters[filter][0];var lastAgeFilterLabel=document.querySelector('[data-filter="'+filter+'"][data-value="'+_dataValue+'"]');if(lastAgeFilterLabel){var lastAgeFilterInput=lastAgeFilterLabel.previousElementSibling;if(lastAgeFilterInput)lastAgeFilterInput.checked=false}removeFilter(filter,null,null);removeTextFilter(filter,null,null)}filters[filter]=[value]};var pushPopFilters=function(filter,name,value,options,callback){var dontPush=!!options.dontPush?options.dontPush:false;if(inArray(filters[filter],value)){var index=filters[filter].indexOf(value);if(index>-1){filters[filter].splice(index,1)}var index2=filterHistory.map(function(element){return element.name+"-"+element.value}).indexOf(name+"-"+value);if(index2>-1){filterHistory.splice(index2,1)}callback()}else if(!dontPush){if(filter!="age")filters[filter].push(value);else{pushPopAgeFilters(value)}if(filter!=="sort"){var isChild=!!options.child?options.child:false;var pushData={filter:filter,name:name,value:value,child:isChild};filterHistory.push(pushData)}else{sortHistory={filter:filter,name:name,value:value}}callback()}else{callback()}};var removeFilter=function(filter,name,value){filters[filter]=new Array};var removeTextFilter=function(filter,name,value){filters[filter]=new Array;if(filterHistory.length>0){var index2=filterHistory.map(function(element){return element.filter}).indexOf(filter);if(index2>-1){filterHistory.splice(index2,1)}}};var applyFilters=function(callback){var existingQuery=url.query();url.query("page",false);for(var k in filters){if(filters[k].length>0)var v=filters[k].join(seperator);else var v=false;if(!!k&&!!v){url.query(k,v)}else if(!v&&existingQuery.hasOwnProperty(k)){url.query(k,false)}}callback()};var loadNewResults=function(){if(!window.isMobile){var loadingElm=document.getElementById(loadingDiv);var loadingSidebar=document.getElementById(filterSideBar);var applyingLoading=document.getElementById(noResultsBtn);if(!!loadingElm)loadingElm.className+=loadingClass;if(!!loadingSidebar)loadingSidebar.className+=loadingClass;if(!!applyingLoading)applyingLoading.className+=" applying";if(!window.jQuery){var query=makeQuery();if(!!ajaxTimer){ajaxTimer.abort()}ajaxTimer=callAjax(baseUrl+query,function(response){var data=JSON.parse(response);processResults(data);loadingElm.className=loadingDiv;applyingLoading.className="btn btn-primary btn-filter";loadingSidebar.className="filter-sidebar-holder"})}else{var queryData={};for(var k in filters){if(filters[k].length>0)var v=filters[k].join(seperator);else var v=false;if(!!k&&!!v){queryData[k]=v}}queryData["m"]=newmap;$.ajax({url:baseUrl+"/"+canonical,method:"GET",data:queryData,cache:false,success:function(data){processResults(data);loadingElm.className=loadingDiv;applyingLoading.className="btn btn-primary btn-filter";loadingSidebar.className="filter-sidebar-holder"},dataType:"json"})}}else{var loadingDivElm=document.getElementById("loading_spinner");var applyingLoading=document.getElementById(noResultsBtn);if(!!applyingLoading)applyingLoading.className+=" applying";if(!!applyingLoading)loadingDivElm.style.display="block";var query=makeQuery()+"&mobile=1";if(!!ajaxTimer){ajaxTimer.abort()}ajaxTimer=callAjax(baseUrl+query,function(response){var data=JSON.parse(response);processResults(data);applyingLoading.className="btn btn-primary btn-filter";if(!!applyingLoading)loadingDivElm.style.display="none"})}};var processResults=function(data){var responseText=data.searchHtml;var resultTitle=data.resultTitle;var resultCount=data.searchCount;if(resultCount==0){document.getElementById(filterButtons).className="filter-btn-holder btn-apply-filters hidden-lg no-results";document.getElementById(noResultsBtn).setAttribute("disabled","");if(!window.isMobile){document.getElementById(noresultsDiv).removeAttribute("style");document.getElementById(scrollDiv).className="no-results-div"}}else{document.getElementById(filterButtons).className="filter-btn-holder btn-apply-filters hidden-lg";document.getElementById(noResultsBtn).removeAttribute("disabled");if(!window.isMobile){document.getElementById(noresultsDiv).setAttribute("style","display: none");document.getElementById(scrollDiv).className=""}}document.getElementById(resultsTitleDiv).innerHTML=resultTitle;document.getElementById(resultsDiv).innerHTML=responseText;document.getElementById(resultsFound).innerHTML=resultCount==0?"No Results":resultCount==1?"See 1 result":"See "+resultCount+" results";if(!window.isMobile){if(!isDesktopTemplate){previewInitialize();initFixedScrollBlock();initAnchors();disableNewTab();initSameHeight();initLightbox();reinitController();$('[data-toggle="popover"]').popover();if(resultCount<6&&!isMobileFilterActive){document.getElementById("content").scrollIntoView({block:"start",behavior:"smooth"})}}else{if(resultCount<6&&!isMobileFilterActive){BMScrollTo.scrollVerticalToElementById("content",0)}else{window.scrollBy(0,1)}if(typeof reInitDomVariables=="function"){reInitDomVariables()}}}else{if(typeof reListenerSearchMobile=="function"){reListenerSearchMobile()}}initResultDOMListners()};var reinitController=function(){angular.element(document).injector().invoke(function($compile){var container=$("#smcontroller");var scope=angular.element(container).scope();$compile(container)(scope)})};var activateFilters=function(){var query=url.query();for(var k in query){if(query.hasOwnProperty(k)){var _dataFilter=k;if(!!query[k]){var values=query[k].split(seperator);for(var i=values.length-1;i>=0;i--){var _dataValue=values[i];var mainElement=document.querySelector('[data-filter="'+_dataFilter+'"][data-value="'+_dataValue+'"]');if(!!mainElement){var inputElement=mainElement.previousElementSibling;inputElement.setAttribute("checked",true);var _dataName=mainElement.getAttribute(dataName);pushPopFilters(_dataFilter,_dataName,_dataValue,{},function(){makeActiveFilters();makeActiveSort()})}else{var mainElement=document.querySelector('[data-filter="'+_dataFilter+'"]');if(!!mainElement){_dataValue=values[i];mainElement.value=_dataValue;var _dataName=_dataValue;if(_dataFilter=="price"||_dataFilter=="duration"){makeSliderFilters(_dataFilter,_dataValue,function(){makeActiveFilters();makeActiveSort()})}else{pushPopFilters(_dataFilter,_dataName,_dataValue,{},function(){makeActiveFilters();makeActiveSort()})}}}}listenRemovers()}}}};function makeSliderFilters(_dataFilter,_dataValue,callback){var slider=document.getElementById(_dataFilter+"-slider");if(slider){var values=getStartMinMaxValues(slider);var units=getSliderData(slider,"units");var input=getSliderData(slider,"input");var thouSep=getSliderData(slider,"seperator");var elm=document.getElementById(input);var unitsArr=units.split("|");if(unitsArr.length==2){var _dn=parseInt(values[0])+" - "+parseInt(values[1])+" "+unitsArr[1];var _dv=parseInt(values[0])+"-"+parseInt(values[1]);pushPopFilters(_dataFilter,_dn,_dv,{},function(){callback()})}else{var _dn=commaSeperator(parseInt(values[0]),thouSep)+" - "+commaSeperator(parseInt(values[1]),thouSep)+" "+unitsArr[0];var _dv=parseInt(values[0])+"-"+parseInt(values[1]);pushPopFilters(_dataFilter,_dn,_dv,{},function(){callback()})}}}function callAjax(url,callback){var xmlhttp;xmlhttp=new XMLHttpRequest;xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4&&xmlhttp.status==200){callback(xmlhttp.responseText)}};xmlhttp.open("GET",url,true);xmlhttp.send();return xmlhttp}var makeQuery=function(){var query=url.query();var params=Object.keys(query).map(function(k){return encodeURIComponent(k)+"="+encodeURIComponent(query[k])}).join("&");var ret="?q="+q;if(q2)ret+="&q2="+q2;if(q3)ret+="&q3="+q3;if(q2)ret+="&q2="+q2;return ret+"&ajax=1&"+params};var remove_duplicates=function(originalArray,prop){var newArray=[];var lookupObject={};for(var i in originalArray){lookupObject[originalArray[i][prop]]=originalArray[i]}for(i in lookupObject){newArray.push(lookupObject[i])}return newArray};var makeActiveFilters=function(){if(filterHistory.length==0){document.getElementById(appliedFiltersDiv).innerHTML='<a href="javascript:void(0)" id="filter-fixed-btn"><span class="glyphicon glyphicon-filter"></span>Filters</a>';document.getElementById("appliedFilters").innerHTML="Filters";return}var filtersApplied=0;var preDom="";for(var i=filterHistory.length-1;i>=0;i--){var text="";if(filterTexts[filterHistory[i].filter]){var text=filterTexts[filterHistory[i].filter]+" "}if(filterHistory[i].child==false){filtersApplied++;var filterAppliedText="";if(filterHistory[i].filter=="sdid"){filterAppliedText="Starts: "}if(filterHistory[i].filter=="edid"){filterAppliedText="Ends: "}text=filterAppliedText+text;preDom+='<li> <a href="javascript:void(0);">'+text+filterHistory[i].name+'<span class="icon-cross97" data-remove="'+filterHistory[i].filter+'" data-name="'+filterHistory[i].name+'" data-value="'+filterHistory[i].value+'"></span> </a> </li>'}}var dom='<div class="filters-selection"><div class="filters-heading"><strong class="title">'+filtersApplied+" Filter"+(filtersApplied>1?"s":"")+' Applied</strong><a href="javascript:void(0);" data-remove="all" class="clear-all">Clear all</a></div><ul class="selection-list">';dom+=preDom;dom+='</ul></div><a href="javascript:void(0)" id="filter-fixed-btn"><span class="glyphicon glyphicon-filter"></span>Filters</a>';document.getElementById(appliedFiltersDiv).innerHTML=dom;document.getElementById("appliedFilters").innerHTML=filtersApplied+" Filter"+(filtersApplied>1?"s":"")+" Applied"};var makeActiveSort=function(){if(!window.isMobile){if(sortHistory.length==0)var text=defaultSort;else document.getElementById(sortByName).innerHTML=sortHistory.name}};var removeFilterHandler=function(event){onRemoveClick(event)};var listenRemovers=function(){var elements=document.querySelectorAll(removeFiltersSelector);for(var i=elements.length-1;i>=0;i--){var filter=elements[i].getAttribute(dataRemove);if(filter==="last")if(!inArray(eventListners,filter)){eventListners.push(filter)}else{break}elements[i].addEventListener("click",removeFilterHandler,false)}var fixedFilterBtn=document.getElementById("filter-fixed-btn");if(!!fixedFilterBtn){fixedFilterBtn.addEventListener("click",function(e){document.getElementById("content").scrollIntoView({block:"start",behavior:"smooth"})})}};var onRemoveClick=function(e){var element=e.target;var value=element.getAttribute(dataValue);var filter=element.getAttribute(dataRemove);var name=element.getAttribute(dataName);if(filter=="all"){filters={cid:new Array,aid:new Array,daytours:new Array,packagetours:new Array,grouptours:new Array,selfguidedtours:new Array,privatetours:new Array,discount:new Array,last_minute_deals:new Array,departure_month:new Array,oid:new Array,did:new Array,date:new Array,price:new Array,duration:new Array,continent:new Array,age:new Array,sdid:new Array,edid:new Array};filterHistory=new Array;var container=document.querySelector("#content");var checkBoxesSelected=container.querySelectorAll('input[type="checkbox"]:checked');for(var i=checkBoxesSelected.length-1;i>=0;i--){checkBoxesSelected[i].checked=false}var inputElements=container.querySelectorAll('input[type="text"]');for(var i=inputElements.length-1;i>=0;i--){inputElements[i].value=null;inputElements[i].name=null}applyFilters(function(){if(!!durationSlider){setTimeout(function(){initSlider(durationSlider)},300)}if(!!priceSlider){setTimeout(function(){initSlider(priceSlider)},300)}loadNewResults();makeActiveFilters();listenRemovers()});return}else{if(filter=="last"){var lastFilter=filterHistory[filterHistory.length-1];if(lastFilter){filter=lastFilter.filter;name=lastFilter.name;value=lastFilter.value}}var filterElements=document.querySelectorAll('[data-filter="'+filter+'"][data-value="'+value+'"]');if(filterElements){for(var i=filterElements.length-1;i>=0;i--){filterElements[i].previousElementSibling.checked=false;var children=filterElements[i].getAttribute(dataChildren);if(!!children&&children!=0){setTimeout(function(){var childrenArray=children.split(",");for(var ci=0;ci<childrenArray.length;ci++){var previouslyCheckBox=document.getElementById(childrenArray[ci]);var previouslyChecked=previouslyCheckBox.checked;var childElement=document.getElementById(childrenArray[ci]).nextElementSibling;previouslyCheckBox.checked=false;var value=childElement.getAttribute(dataValue);var filter=childElement.getAttribute(dataFilter);var name=childElement.getAttribute(dataName);pushPopFilters(filter,name,value,{child:true,dontPush:true},function(){applyFilters(function(){loadNewResults();makeActiveFilters();makeActiveSort();listenRemovers()})})}},100)}}}else{var filterElement=document.querySelector('[data-filter="'+filter+'"][type="text"]');if(filterElement){filterElement.value=null}}pushPopFilters(filter,name,value,{},function(){if(filter=="duration"&&!!durationSlider){setTimeout(function(){initSlider(durationSlider)},800)}if(filter=="price"&&!!priceSlider){setTimeout(function(){initSlider(priceSlider)},800)}applyFilters(function(){loadNewResults();makeActiveFilters();listenRemovers()})})}};var urlize=function(input){if(input){return input.toLowerCase().replace(/[,]/,"").replace(/[&]/,"and").replace(/[^a-z0-9-]/gi,"-")}return};var inArray=function(array,value){if(typeof array==="undefined")return false;var inArray=false;array.map(function(key){if(key===value){inArray=true}});return inArray};var _noUiSlider=function(){if(!!noUiSlider){if(!!durationSlider){initSlider(durationSlider)}if(!!priceSlider){initSlider(priceSlider)}}};var initSlider=function(slider){var minMax=getMinMaxValues(slider);var startMinMax=getStartMinMaxValues(slider);var sliderSteps=getSliderData(slider,"steps");var units=getSliderData(slider,"units");var input=getSliderData(slider,"input");var thouSep=getSliderData(slider,"seperator");var divs=[document.getElementById([getSliderData(slider,"lower")]),document.getElementById([getSliderData(slider,"upper")])];if(!!slider.noUiSlider){slider.noUiSlider.set(minMax);for(var i=divs.length-1;i>=0;i--){if(thouSep.length>0){divs[i].innerHTML=commaSeperator(minMax[i],thouSep)}else{divs[i].innerHTML=minMax[i]}}}else{noUiSlider.create(slider,{start:startMinMax,connect:true,step:parseInt(sliderSteps),range:{min:minMax[0],max:minMax[1]}})}slider.noUiSlider.on("slide",function(values,handle){var changedValue=parseInt(values[handle]);if(thouSep.length>0){divs[handle].innerHTML=commaSeperator(changedValue,thouSep)}else{divs[handle].innerHTML=changedValue}var unitsArr=units.split("|");if(unitsArr.length==2){if(changedValue==1){divs[handle].nextElementSibling.innerHTML=unitsArr[0]}else{divs[handle].nextElementSibling.innerHTML=unitsArr[1]}}});slider.noUiSlider.on("change",function(values,handle){setTimeout(function(){var changedValue=parseInt(values[handle]);if(thouSep.length>0){divs[handle].innerHTML=commaSeperator(changedValue,thouSep)}else{divs[handle].innerHTML=changedValue}var elm=document.getElementById(input);var unitsArr=units.split("|");if(unitsArr.length==2){if(changedValue==1){divs[handle].nextElementSibling.innerHTML=unitsArr[0]}else{divs[handle].nextElementSibling.innerHTML=unitsArr[1]}elm.setAttribute("data-name",parseInt(values[0])+" - "+parseInt(values[1])+" "+unitsArr[1]);elm.value=parseInt(values[0])+"-"+parseInt(values[1])}else{elm.setAttribute("data-name",commaSeperator(parseInt(values[0]),thouSep)+" - "+commaSeperator(parseInt(values[1]),thouSep)+" "+unitsArr[0]);elm.value=parseInt(values[0])+"-"+parseInt(values[1])}setTimeout(function(){onChange({target:elm})},500)},100)})};var commaSeperator=function(x,s){return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g,s)};var getMinMaxValues=function(slider){return[parseInt(slider.getAttribute("data-min")),parseInt(slider.getAttribute("data-max"))]};var getStartMinMaxValues=function(slider){return[parseInt(slider.getAttribute("data-init-min")),parseInt(slider.getAttribute("data-init-max"))]};var getSliderData=function(slider,name){return slider.getAttribute("data-"+name)};var startDestOpener=document.getElementById("se-collapse-start"),endDestOpener=document.getElementById("se-collapse-end"),startDestCollapse=document.getElementById("start-end-dest-collapse"),endDestCollapse=document.getElementById("end-dest-collapse");if(!!startDestOpener){startDestOpener.addEventListener("focus",function(e){startDestCollapse.classList.add("show")});startDestOpener.addEventListener("blur",function(e){setTimeout(function(){if(filters["sdid"].length==0){startDestCollapse.classList.remove("show")}},500)});startDestOpener.addEventListener("keyup",function(){if(this.value.length>0){startDestCollapse.classList.add("collapse-hidden");delayActivateFilters()}else{startDestCollapse.classList.remove("collapse-hidden");delayActivateFilters()}})}if(!!endDestOpener){endDestOpener.addEventListener("focus",function(){endDestCollapse.classList.add("show")});endDestOpener.addEventListener("blur",function(){setTimeout(function(){if(filters["edid"].length==0){endDestCollapse.classList.remove("show")}},500)});endDestOpener.addEventListener("keyup",function(){if(this.value.length>0){endDestCollapse.classList.add("collapse-hidden");delayActivateFilters()}else{endDestCollapse.classList.remove("collapse-hidden");delayActivateFilters()}})}function delayActivateFilters(){}__construct();return{initResultDOMListners:initResultDOMListners}}try{var bmf=new BmFilter}catch(e){console.log(e)}(function(w,d,undefined){"use strict";function polyfill(){if("scrollBehavior"in d.documentElement.style){return}var Element=w.HTMLElement||w.Element;var SCROLL_TIME=468;var original={scroll:w.scroll||w.scrollTo,scrollBy:w.scrollBy,elScroll:Element.prototype.scroll||scrollElement,scrollIntoView:Element.prototype.scrollIntoView};var now=w.performance&&w.performance.now?w.performance.now.bind(w.performance):Date.now;function scrollElement(x,y){this.scrollLeft=x;this.scrollTop=y}function ease(k){return.5*(1-Math.cos(Math.PI*k))}function shouldBailOut(x){if(typeof x!=="object"||x===null||x.behavior===undefined||x.behavior==="auto"||x.behavior==="instant"){return true}if(typeof x==="object"&&x.behavior==="smooth"){return false}throw new TypeError("behavior not valid")}function findScrollableParent(el){var isBody;var hasScrollableSpace;var hasVisibleOverflow;do{el=el.parentNode;isBody=el===d.body;hasScrollableSpace=el.clientHeight<el.scrollHeight||el.clientWidth<el.scrollWidth;hasVisibleOverflow=w.getComputedStyle(el,null).overflow==="visible"}while(!isBody&&!(hasScrollableSpace&&!hasVisibleOverflow));isBody=hasScrollableSpace=hasVisibleOverflow=null;return el}function step(context){var time=now();var value;var currentX;var currentY;var elapsed=(time-context.startTime)/SCROLL_TIME;elapsed=elapsed>1?1:elapsed;value=ease(elapsed);currentX=context.startX+(context.x-context.startX)*value;currentY=context.startY+(context.y-context.startY)*value;context.method.call(context.scrollable,currentX,currentY);if(currentX!==context.x||currentY!==context.y){w.requestAnimationFrame(step.bind(w,context))}}function smoothScroll(el,x,y){var scrollable;var startX;var startY;var method;var startTime=now();if(el===d.body){scrollable=w;startX=w.scrollX||w.pageXOffset;startY=w.scrollY||w.pageYOffset;method=original.scroll}else{scrollable=el;startX=el.scrollLeft;startY=el.scrollTop;method=scrollElement}step({scrollable:scrollable,method:method,startTime:startTime,startX:startX,startY:startY,x:x,y:y})}w.scroll=w.scrollTo=function(){if(shouldBailOut(arguments[0])){original.scroll.call(w,arguments[0].left||arguments[0],arguments[0].top||arguments[1]);return}smoothScroll.call(w,d.body,~~arguments[0].left,~~arguments[0].top)};w.scrollBy=function(){if(shouldBailOut(arguments[0])){original.scrollBy.call(w,arguments[0].left||arguments[0],arguments[0].top||arguments[1]);return}smoothScroll.call(w,d.body,~~arguments[0].left+(w.scrollX||w.pageXOffset),~~arguments[0].top+(w.scrollY||w.pageYOffset))};Element.prototype.scroll=Element.prototype.scrollTo=function(){if(shouldBailOut(arguments[0])){original.elScroll.call(this,arguments[0].left||arguments[0],arguments[0].top||arguments[1]);return}var left=arguments[0].left;var top=arguments[0].top;smoothScroll.call(this,this,typeof left==="number"?left:this.scrollLeft,typeof top==="number"?top:this.scrollTop)};Element.prototype.scrollBy=function(){var arg0=arguments[0];if(typeof arg0==="object"){this.scroll({left:arg0.left+this.scrollLeft,top:arg0.top+this.scrollTop,behavior:arg0.behavior})}else{this.scroll(this.scrollLeft+arg0,this.scrollTop+arguments[1])}};Element.prototype.scrollIntoView=function(){if(shouldBailOut(arguments[0])){original.scrollIntoView.call(this,arguments[0]===undefined?true:arguments[0]);return}var scrollableParent=findScrollableParent(this);var parentRects=scrollableParent.getBoundingClientRect();var clientRects=this.getBoundingClientRect();if(scrollableParent!==d.body){smoothScroll.call(this,scrollableParent,scrollableParent.scrollLeft+clientRects.left-parentRects.left,scrollableParent.scrollTop+clientRects.top-parentRects.top);w.scrollBy({left:parentRects.left,top:parentRects.top,behavior:"smooth"})}else{w.scrollBy({left:clientRects.left,top:clientRects.top,behavior:"smooth"})}}}if(typeof exports==="object"){module.exports={polyfill:polyfill}}else{polyfill()}})(window,document);;jQuery(function(){initSameHeight();previewInitialize();$('[data-toggle="popover"]').popover();$(window).off("scroll",offerScrollHandler);setTimeout(function(){initCarousel();initFixedScrollBlock();initSameHeight();initAnchors()},1500);$("#filter-fixed-btn").click(function(){$("html, body").animate({scrollTop:$("#content").offset().top},450)});$(".specific-pick-date").datepicker({format:"yyyy-mm-dd",startDate:"today",autoclose:true,todayHighlight:true,weekStart:1}).on("changeDate",function(e){e.target.setAttribute("data-value",e.target.value);e.target.setAttribute("data-name",e.target.value);onChange(e)}.bind(this));$(".heading-text .link-more-article").click(function(){var moreOffset=0;if($(window).width()<768)moreOffset=40;setTimeout(function(){initFixedScrollBlock();$("html, body").animate({scrollTop:$(".search-article").offset().top-moreOffset},350)},100)});$(".search-article .content-nav>ul>li a").click(function(){setTimeout(function(){initAnchors();initFixedScrollBlock()},450)});if($(window).width()>979){$(window).scroll(function(){var filtersBlock=$(".filter-sidebar-holder");var filtersFixed=$("#applied-filters");var searchBlock=$("#search-two-columns");if($(window).scrollTop()>=filtersBlock.offset().top+filtersBlock.innerHeight()){filtersFixed.css("width",filtersBlock.width());filtersFixed.addClass("filters-fixed")}else{filtersFixed.css("width","auto");filtersFixed.removeClass("filters-fixed")}if($(window).scrollTop()>=searchBlock.offset().top+searchBlock.innerHeight()-filtersFixed.innerHeight()-30){filtersFixed.css("width","auto");filtersFixed.removeClass("filters-fixed")}})}var searchMapView=false;if($("#searchPageMap").length&&$(window).width()>979)$(window).on("scroll",searchMapCheck);function searchMapCheck(){if(searchMapView==false){var sMap=document.getElementById("searchPageMap");searchMapView=searchMapView==false?isElementInViewport(sMap):true;if(searchMapView){initSearchMap();$(window).off("scroll",searchMapCheck)}}}$(".reviews-holder .star-rating-holder, .reviews-holder .of-reviews, .reviews-top, .nav-reviews-link").click(function(){$("html, body").animate({scrollTop:$("#customer-reviews-block").offset().top},350)});$(".guide-close").click(function(){$(".banner-guide").addClass("hidden")});if($(".search-article").length&&$(window).width()>979){$(window).bind("scroll",function(){var searchSidebarBlock=$(".search-article .sidebar-block");if($(window).scrollTop()>=searchSidebarBlock.offset().top+searchSidebarBlock.innerHeight()){searchSidebarBlock.addClass("custom-fixed")}else{searchSidebarBlock.removeClass("custom-fixed")}if($(window).scrollTop()>=$(".search-article").offset().top+$(".search-article").innerHeight()-$(".search-article .sidebar-fixed-later").innerHeight()-50){searchSidebarBlock.removeClass("custom-fixed")}})}if(typeof Storage!=="undefined"){sessionStorage.removeItem("squirrel")}var scrollTopPos=0;$(".btn-filter-toggle").click(function(){scrollTopPos=window.scrollY;isMobileFilterActive=true;$(".filters-sidebar").addClass("filter-active");$(".btn-filter-toggle").hide();$("body").addClass("mobile-filter-active");window.scrollTo(0,0)});$("a.filter-cross, #no-results-button").click(function(){isMobileFilterActive=false;$(".filters-sidebar").removeClass("filter-active");$(".btn-filter-toggle").show();$("body").removeClass("mobile-filter-active")});$("#no-results-button").click(function(){document.getElementById("content").scrollIntoView({block:"start",behavior:"smooth"})});$("a.filter-cross").click(function(){if(scrollTopPos>0)window.scrollTo(0,scrollTopPos)});$(".v-m").click(function(){$(this).closest("li").addClass("showing")});$(".v-l").click(function(){$(this).closest("li").removeClass("showing")})});function initSearchMap(){var src="https://maps.googleapis.com/maps/api/js?libraries=geometry,places&language=en&v=3.33&key="+bmGlobalVars.GOOGLE_KEY;load_js(src,function(){var mapId=$("#searchPageMap");var latitude=mapId.data("latitude");var longitude=mapId.data("longitude");var zoom=mapId.data("zoom");var mapOptions={center:new google.maps.LatLng(latitude,longitude),zoom:zoom,mapTypeId:google.maps.MapTypeId.ROADMAP};var map=new google.maps.Map(document.getElementById("searchPageMap"),mapOptions);var marker=new google.maps.Marker({position:new google.maps.LatLng(latitude,longitude),icon:"https://www.bookmundi.com/themes/global/resources/images/bookmundi-pin.png"});marker.setMap(map);google.maps.event.trigger(marker,"resize")})}function initCarousel(){jQuery("div.photo-carousel").scrollGallery({mask:"div.mask",slider:"div.slideset",slides:"div.slide",btnPrev:"a.btn-prev",btnNext:"a.btn-next",pagerLinks:".pagination li",autoRotation:true,switchTime:3e3,animSpeed:500,step:1});jQuery("div.dest-act-carousel").scrollGallery({mask:"div.mask",slider:"ul.slideset",slides:"li.slide",btnPrev:"a.btn-prev",btnNext:"a.btn-next",autoRotation:false,maskAutoSize:false,switchTime:3e3,animSpeed:500,step:1})}function loadReviews(page,did){var url=baseUrl+"/rating/default/destinationratings/did/"+did+"/page/"+page;var activity=$("#moreReviewsSecLoadMore").data("activity");if(!!activity){url=url+"?activity_id="+activity}$.ajax({type:"GET",url:url,dataType:"html",success:function(data){$("#moreReviewsSec").remove();$("#agencyReviewRatings-holder").append(data);initFixedScrollBlock();initAnchors();setTimeout(function(){if($(window).width()>767){initSameHeight()}},1e3)},error:function(){}})}function previewInitialize(){$('[data-toggle="tooltip"]').tooltip();$(".see-preview").click(function(){$(".trips-block").removeClass("preview-active");$(this).closest(".trips-block").toggleClass("preview-active")});$(".see-preview.cross").click(function(){$(".trips-block").removeClass("preview-active")});$(".map-link-close").click(function(){var tripBlock=$(this).closest(".trips-block");tripBlock.removeClass("map-active");tripBlock.find(".see-map-link").text($(this).text()=="View Map"?"Hide Map":"View Map")});$(".see-map-link").click(function(){$(this).text($(this).text()=="View Map"?"Hide Map":"View Map");var tripBlock=$(this).closest(".trips-block");tripBlock.toggleClass("map-active");var lazyMap=tripBlock.find(".lazy-map");lazyMap.attr("src",lazyMap.attr("data-original-src"));lazyMap[0].onload=function(){tripBlock.find(".spinner-circle").hide()}});$(".pagination-nav .pagination-list>li>a").click(function(){$("#tours-main-holder").addClass("loading loading-page")})}var cachedTooltipData=Array();function loadGroupTours(id){data=fetchGroupTours(id);$("#loadGroupTours-"+id).tooltip({title:data,html:true,placement:"top"});$("#loadGroupTours-"+id).tooltip("show")}function fetchGroupTours(id){if(id in cachedTooltipData){return cachedTooltipData[id]}var localData="Error Loading Data";$.ajax({url:baseUrl+"/products/ws/gettripdates/id/"+id,cache:true,async:false,success:function(data){localData=data},dataType:"html"});cachedTooltipData[id]=localData;return localData}(function($){function ScrollGallery(options){this.options=$.extend({mask:"div.mask",slider:">*",slides:">*",activeClass:"active",disabledClass:"disabled",btnPrev:"a.btn-prev",btnNext:"a.btn-next",generatePagination:false,pagerList:"<ul>",pagerListItem:'<li><a href="#"></a></li>',pagerListItemText:"a",pagerLinks:".pagination li",currentNumber:"span.current-num",totalNumber:"span.total-num",btnPlay:".btn-play",btnPause:".btn-pause",btnPlayPause:".btn-play-pause",galleryReadyClass:"gallery-js-ready",autorotationActiveClass:"autorotation-active",autorotationDisabledClass:"autorotation-disabled",stretchSlideToMask:false,circularRotation:true,disableWhileAnimating:false,autoRotation:false,pauseOnHover:isTouchDevice?false:true,maskAutoSize:false,switchTime:4e3,animSpeed:600,event:"click",swipeThreshold:15,handleTouch:true,vertical:false,useTranslate3D:false,step:false},options);this.init()}ScrollGallery.prototype={init:function(){if(this.options.holder){this.findElements();this.attachEvents();this.refreshPosition();this.refreshState(true);this.resumeRotation();this.makeCallback("onInit",this)}},findElements:function(){this.fullSizeFunction=this.options.vertical?"outerHeight":"outerWidth";this.innerSizeFunction=this.options.vertical?"height":"width";this.slideSizeFunction="outerHeight";this.maskSizeProperty="height";this.animProperty=this.options.vertical?"marginTop":"marginLeft";this.gallery=$(this.options.holder).addClass(this.options.galleryReadyClass);this.mask=this.gallery.find(this.options.mask);this.slider=this.mask.find(this.options.slider);this.slides=this.slider.find(this.options.slides);this.btnPrev=this.gallery.find(this.options.btnPrev);this.btnNext=this.gallery.find(this.options.btnNext);this.currentStep=0;this.stepsCount=0;if(this.options.step===false){var activeSlide=this.slides.filter("."+this.options.activeClass);if(activeSlide.length){this.currentStep=this.slides.index(activeSlide)}}this.calculateOffsets();if(typeof this.options.generatePagination==="string"){this.pagerLinks=$();this.buildPagination()}else{this.pagerLinks=this.gallery.find(this.options.pagerLinks);this.attachPaginationEvents()}this.btnPlay=this.gallery.find(this.options.btnPlay);this.btnPause=this.gallery.find(this.options.btnPause);this.btnPlayPause=this.gallery.find(this.options.btnPlayPause);this.curNum=this.gallery.find(this.options.currentNumber);this.allNum=this.gallery.find(this.options.totalNumber)},attachEvents:function(){var self=this;this.bindHandlers(["onWindowResize"]);$(window).bind("load resize orientationchange",this.onWindowResize);if(this.btnPrev.length){this.prevSlideHandler=function(e){e.preventDefault();self.prevSlide()};this.btnPrev.bind(this.options.event,this.prevSlideHandler)}if(this.btnNext.length){this.nextSlideHandler=function(e){e.preventDefault();self.nextSlide()};this.btnNext.bind(this.options.event,this.nextSlideHandler)}if(this.options.pauseOnHover&&!isTouchDevice){this.hoverHandler=function(){if(self.options.autoRotation){self.galleryHover=true;self.pauseRotation()}};this.leaveHandler=function(){if(self.options.autoRotation){self.galleryHover=false;self.resumeRotation()}};this.gallery.bind({mouseenter:this.hoverHandler,mouseleave:this.leaveHandler})}if(this.btnPlay.length){this.btnPlayHandler=function(e){e.preventDefault();self.startRotation()};this.btnPlay.bind(this.options.event,this.btnPlayHandler)}if(this.btnPause.length){this.btnPauseHandler=function(e){e.preventDefault();self.stopRotation()};this.btnPause.bind(this.options.event,this.btnPauseHandler)}if(this.btnPlayPause.length){this.btnPlayPauseHandler=function(e){e.preventDefault();if(!self.gallery.hasClass(self.options.autorotationActiveClass)){self.startRotation()}else{self.stopRotation()}};this.btnPlayPause.bind(this.options.event,this.btnPlayPauseHandler)}if(isTouchDevice&&this.options.useTranslate3D){this.slider.css({"-webkit-transform":"translate3d(0px, 0px, 0px)"})}if(isTouchDevice&&this.options.handleTouch&&window.Hammer&&this.mask.length){this.swipeHandler=new Hammer.Manager(this.mask[0]);this.swipeHandler.add(new Hammer.Pan({direction:self.options.vertical?Hammer.DIRECTION_VERTICAL:Hammer.DIRECTION_HORIZONTAL,threshold:self.options.swipeThreshold}));this.swipeHandler.on("panstart",function(){if(self.galleryAnimating){self.swipeHandler.stop()}else{self.pauseRotation();self.originalOffset=parseFloat(self.slider.css(self.animProperty))}}).on("panmove",function(e){var tmpOffset=self.originalOffset+e[self.options.vertical?"deltaY":"deltaX"];tmpOffset=Math.max(Math.min(0,tmpOffset),self.maxOffset);self.slider.css(self.animProperty,tmpOffset)}).on("panend",function(e){self.resumeRotation();if(e.distance>self.options.swipeThreshold){if(e.offsetDirection===Hammer.DIRECTION_RIGHT||e.offsetDirection===Hammer.DIRECTION_DOWN){self.nextSlide()}else{self.prevSlide()}}else{self.switchSlide()}})}},onWindowResize:function(){if(!this.galleryAnimating){this.calculateOffsets();this.refreshPosition();this.buildPagination();this.refreshState();this.resizeQueue=false}else{this.resizeQueue=true}},refreshPosition:function(){this.currentStep=Math.min(this.currentStep,this.stepsCount-1);this.tmpProps={};this.tmpProps[this.animProperty]=this.getStepOffset();this.slider.stop().css(this.tmpProps)},calculateOffsets:function(){var self=this,tmpOffset,tmpStep;if(this.options.stretchSlideToMask){var tmpObj={};tmpObj[this.innerSizeFunction]=this.mask[this.innerSizeFunction]();this.slides.css(tmpObj)}this.maskSize=this.mask[this.innerSizeFunction]();this.sumSize=this.getSumSize();this.maxOffset=this.maskSize-this.sumSize;if(this.options.vertical&&this.options.maskAutoSize){this.options.step=1;this.stepsCount=this.slides.length;this.stepOffsets=[0];tmpOffset=0;for(var i=0;i<this.slides.length;i++){tmpOffset-=$(this.slides[i])[this.fullSizeFunction](true);this.stepOffsets.push(tmpOffset)}this.maxOffset=tmpOffset;return}if(typeof this.options.step==="number"&&this.options.step>0){this.slideDimensions=[];this.slides.each($.proxy(function(ind,obj){self.slideDimensions.push($(obj)[self.fullSizeFunction](true))},this));this.stepOffsets=[0];this.stepsCount=1;tmpOffset=tmpStep=0;while(tmpOffset>this.maxOffset){tmpOffset-=this.getSlideSize(tmpStep,tmpStep+this.options.step);tmpStep+=this.options.step;this.stepOffsets.push(Math.max(tmpOffset,this.maxOffset));this.stepsCount++}}else{this.stepSize=this.maskSize;this.stepsCount=1;tmpOffset=0;while(tmpOffset>this.maxOffset){tmpOffset-=this.stepSize;this.stepsCount++}}},getSumSize:function(){var sum=0;this.slides.each($.proxy(function(ind,obj){sum+=$(obj)[this.fullSizeFunction](true)},this));this.slider.css(this.innerSizeFunction,sum);return sum},getStepOffset:function(step){step=step||this.currentStep;if(typeof this.options.step==="number"){return this.stepOffsets[this.currentStep]}else{return Math.min(0,Math.max(-this.currentStep*this.stepSize,this.maxOffset))}},getSlideSize:function(i1,i2){var sum=0;for(var i=i1;i<Math.min(i2,this.slideDimensions.length);i++){sum+=this.slideDimensions[i]}return sum},buildPagination:function(){if(typeof this.options.generatePagination==="string"){if(!this.pagerHolder){this.pagerHolder=this.gallery.find(this.options.generatePagination)}if(this.pagerHolder.length&&this.oldStepsCount!=this.stepsCount){this.oldStepsCount=this.stepsCount;this.pagerHolder.empty();this.pagerList=$(this.options.pagerList).appendTo(this.pagerHolder);for(var i=0;i<this.stepsCount;i++){$(this.options.pagerListItem).appendTo(this.pagerList).find(this.options.pagerListItemText).text(i+1)}this.pagerLinks=this.pagerList.children();this.attachPaginationEvents()}}},attachPaginationEvents:function(){var self=this;this.pagerLinksHandler=function(e){e.preventDefault();self.numSlide(self.pagerLinks.index(e.currentTarget))};this.pagerLinks.bind(this.options.event,this.pagerLinksHandler)},prevSlide:function(){if(!(this.options.disableWhileAnimating&&this.galleryAnimating)){if(this.currentStep>0){this.currentStep--;this.switchSlide()}else if(this.options.circularRotation){this.currentStep=this.stepsCount-1;this.switchSlide()}}},nextSlide:function(fromAutoRotation){if(!(this.options.disableWhileAnimating&&this.galleryAnimating)){if(this.currentStep<this.stepsCount-1){this.currentStep++;this.switchSlide()}else if(this.options.circularRotation||fromAutoRotation===true){this.currentStep=0;this.switchSlide()}}},numSlide:function(c){if(this.currentStep!=c){this.currentStep=c;this.switchSlide()}},switchSlide:function(){var self=this;this.galleryAnimating=true;this.tmpProps={};this.tmpProps[this.animProperty]=this.getStepOffset();this.slider.stop().animate(this.tmpProps,{duration:this.options.animSpeed,complete:function(){self.galleryAnimating=false;if(self.resizeQueue){self.onWindowResize()}self.makeCallback("onChange",self);self.autoRotate()}});this.refreshState();this.makeCallback("onBeforeChange",this)},refreshState:function(initial){if(this.options.step===1||this.stepsCount===this.slides.length){this.slides.removeClass(this.options.activeClass).eq(this.currentStep).addClass(this.options.activeClass)}this.pagerLinks.removeClass(this.options.activeClass).eq(this.currentStep).addClass(this.options.activeClass);this.curNum.html(this.currentStep+1);this.allNum.html(this.stepsCount);if(this.options.maskAutoSize&&typeof this.options.step==="number"){this.tmpProps={};this.tmpProps[this.maskSizeProperty]=this.slides.eq(Math.min(this.currentStep,this.slides.length-1))[this.slideSizeFunction](true);this.mask.stop()[initial?"css":"animate"](this.tmpProps)}if(!this.options.circularRotation){this.btnPrev.add(this.btnNext).removeClass(this.options.disabledClass);if(this.currentStep===0)this.btnPrev.addClass(this.options.disabledClass);if(this.currentStep===this.stepsCount-1)this.btnNext.addClass(this.options.disabledClass)}this.gallery.toggleClass("not-enough-slides",this.sumSize<=this.maskSize)},startRotation:function(){this.options.autoRotation=true;this.galleryHover=false;this.autoRotationStopped=false;this.resumeRotation()},stopRotation:function(){this.galleryHover=true;this.autoRotationStopped=true;this.pauseRotation()},pauseRotation:function(){this.gallery.addClass(this.options.autorotationDisabledClass);this.gallery.removeClass(this.options.autorotationActiveClass);clearTimeout(this.timer)},resumeRotation:function(){if(!this.autoRotationStopped){this.gallery.addClass(this.options.autorotationActiveClass);this.gallery.removeClass(this.options.autorotationDisabledClass);this.autoRotate()}},autoRotate:function(){var self=this;clearTimeout(this.timer);if(this.options.autoRotation&&!this.galleryHover&&!this.autoRotationStopped){this.timer=setTimeout(function(){self.nextSlide(true)},this.options.switchTime)}else{this.pauseRotation()}},bindHandlers:function(handlersList){var self=this;$.each(handlersList,function(index,handler){var origHandler=self[handler];self[handler]=function(){return origHandler.apply(self,arguments)}})},makeCallback:function(name){if(typeof this.options[name]==="function"){var args=Array.prototype.slice.call(arguments);args.shift();this.options[name].apply(this,args)}},destroy:function(){$(window).unbind("load resize orientationchange",this.onWindowResize);this.btnPrev.unbind(this.options.event,this.prevSlideHandler);this.btnNext.unbind(this.options.event,this.nextSlideHandler);this.pagerLinks.unbind(this.options.event,this.pagerLinksHandler);this.gallery.unbind("mouseenter",this.hoverHandler);this.gallery.unbind("mouseleave",this.leaveHandler);this.stopRotation();this.btnPlay.unbind(this.options.event,this.btnPlayHandler);this.btnPause.unbind(this.options.event,this.btnPauseHandler);this.btnPlayPause.unbind(this.options.event,this.btnPlayPauseHandler);if(this.swipeHandler){this.swipeHandler.destroy()}var unneededClasses=[this.options.galleryReadyClass,this.options.autorotationActiveClass,this.options.autorotationDisabledClass];this.gallery.removeClass(unneededClasses.join(" "));this.slider.add(this.slides).removeAttr("style");if(typeof this.options.generatePagination==="string"){this.pagerHolder.empty()}}};var isTouchDevice=/Windows Phone/.test(navigator.userAgent)||"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch;$.fn.scrollGallery=function(opt){return this.each(function(){$(this).data("ScrollGallery",new ScrollGallery($.extend(opt,{holder:this})))})}})(jQuery);if(Object.create){!function(a,b,c,d){"use strict";function e(a,b,c){return setTimeout(k(a,c),b)}function f(a,b,c){return Array.isArray(a)?(g(a,c[b],c),!0):!1}function g(a,b,c){var e;if(a)if(a.forEach)a.forEach(b,c);else if(a.length!==d)for(e=0;e<a.length;)b.call(c,a[e],e,a),e++;else for(e in a)a.hasOwnProperty(e)&&b.call(c,a[e],e,a)}function h(a,b,c){for(var e=Object.keys(b),f=0;f<e.length;)(!c||c&&a[e[f]]===d)&&(a[e[f]]=b[e[f]]),f++;return a}function i(a,b){return h(a,b,!0)}function j(a,b,c){var d,e=b.prototype;d=a.prototype=Object.create(e),d.constructor=a,d._super=e,c&&h(d,c)}function k(a,b){return function(){return a.apply(b,arguments)}}function l(a,b){return typeof a==kb?a.apply(b?b[0]||d:d,b):a}function m(a,b){return a===d?b:a}function n(a,b,c){g(r(b),function(b){a.addEventListener(b,c,!1)})}function o(a,b,c){g(r(b),function(b){a.removeEventListener(b,c,!1)})}function p(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}function q(a,b){return a.indexOf(b)>-1}function r(a){return a.trim().split(/\s+/g)}function s(a,b,c){if(a.indexOf&&!c)return a.indexOf(b);for(var d=0;d<a.length;){if(c&&a[d][c]==b||!c&&a[d]===b)return d;d++}return-1}function t(a){return Array.prototype.slice.call(a,0)}function u(a,b,c){for(var d=[],e=[],f=0;f<a.length;){var g=b?a[f][b]:a[f];s(e,g)<0&&d.push(a[f]),e[f]=g,f++}return c&&(d=b?d.sort(function(a,c){return a[b]>c[b]}):d.sort()),d}function v(a,b){for(var c,e,f=b[0].toUpperCase()+b.slice(1),g=0;g<ib.length;){if(c=ib[g],e=c?c+f:b,e in a)return e;g++}return d}function w(){return ob++}function x(a){var b=a.ownerDocument;return b.defaultView||b.parentWindow}function y(a,b){var c=this;this.manager=a,this.callback=b,this.element=a.element,this.target=a.options.inputTarget,this.domHandler=function(b){l(a.options.enable,[a])&&c.handler(b)},this.init()}function z(a){var b,c=a.options.inputClass;return new(b=c?c:rb?N:sb?Q:qb?S:M)(a,A)}function A(a,b,c){var d=c.pointers.length,e=c.changedPointers.length,f=b&yb&&d-e===0,g=b&(Ab|Bb)&&d-e===0;c.isFirst=!!f,c.isFinal=!!g,f&&(a.session={}),c.eventType=b,B(a,c),a.emit("hammer.input",c),a.recognize(c),a.session.prevInput=c}function B(a,b){var c=a.session,d=b.pointers,e=d.length;c.firstInput||(c.firstInput=E(b)),e>1&&!c.firstMultiple?c.firstMultiple=E(b):1===e&&(c.firstMultiple=!1);var f=c.firstInput,g=c.firstMultiple,h=g?g.center:f.center,i=b.center=F(d);b.timeStamp=nb(),b.deltaTime=b.timeStamp-f.timeStamp,b.angle=J(h,i),b.distance=I(h,i),C(c,b),b.offsetDirection=H(b.deltaX,b.deltaY),b.scale=g?L(g.pointers,d):1,b.rotation=g?K(g.pointers,d):0,D(c,b);var j=a.element;p(b.srcEvent.target,j)&&(j=b.srcEvent.target),b.target=j}function C(a,b){var c=b.center,d=a.offsetDelta||{},e=a.prevDelta||{},f=a.prevInput||{};(b.eventType===yb||f.eventType===Ab)&&(e=a.prevDelta={x:f.deltaX||0,y:f.deltaY||0},d=a.offsetDelta={x:c.x,y:c.y}),b.deltaX=e.x+(c.x-d.x),b.deltaY=e.y+(c.y-d.y)}function D(a,b){var c,e,f,g,h=a.lastInterval||b,i=b.timeStamp-h.timeStamp;if(b.eventType!=Bb&&(i>xb||h.velocity===d)){var j=h.deltaX-b.deltaX,k=h.deltaY-b.deltaY,l=G(i,j,k);e=l.x,f=l.y,c=mb(l.x)>mb(l.y)?l.x:l.y,g=H(j,k),a.lastInterval=b}else c=h.velocity,e=h.velocityX,f=h.velocityY,g=h.direction;b.velocity=c,b.velocityX=e,b.velocityY=f,b.direction=g}function E(a){for(var b=[],c=0;c<a.pointers.length;)b[c]={clientX:lb(a.pointers[c].clientX),clientY:lb(a.pointers[c].clientY)},c++;return{timeStamp:nb(),pointers:b,center:F(b),deltaX:a.deltaX,deltaY:a.deltaY}}function F(a){var b=a.length;if(1===b)return{x:lb(a[0].clientX),y:lb(a[0].clientY)};for(var c=0,d=0,e=0;b>e;)c+=a[e].clientX,d+=a[e].clientY,e++;return{x:lb(c/b),y:lb(d/b)}}function G(a,b,c){return{x:b/a||0,y:c/a||0}}function H(a,b){return a===b?Cb:mb(a)>=mb(b)?a>0?Db:Eb:b>0?Fb:Gb}function I(a,b,c){c||(c=Kb);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return Math.sqrt(d*d+e*e)}function J(a,b,c){c||(c=Kb);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return 180*Math.atan2(e,d)/Math.PI}function K(a,b){return J(b[1],b[0],Lb)-J(a[1],a[0],Lb)}function L(a,b){return I(b[0],b[1],Lb)/I(a[0],a[1],Lb)}function M(){this.evEl=Nb,this.evWin=Ob,this.allow=!0,this.pressed=!1,y.apply(this,arguments)}function N(){this.evEl=Rb,this.evWin=Sb,y.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function O(){this.evTarget=Ub,this.evWin=Vb,this.started=!1,y.apply(this,arguments)}function P(a,b){var c=t(a.touches),d=t(a.changedTouches);return b&(Ab|Bb)&&(c=u(c.concat(d),"identifier",!0)),[c,d]}function Q(){this.evTarget=Xb,this.targetIds={},y.apply(this,arguments)}function R(a,b){var c=t(a.touches),d=this.targetIds;if(b&(yb|zb)&&1===c.length)return d[c[0].identifier]=!0,[c,c];var e,f,g=t(a.changedTouches),h=[],i=this.target;if(f=c.filter(function(a){return p(a.target,i)}),b===yb)for(e=0;e<f.length;)d[f[e].identifier]=!0,e++;for(e=0;e<g.length;)d[g[e].identifier]&&h.push(g[e]),b&(Ab|Bb)&&delete d[g[e].identifier],e++;return h.length?[u(f.concat(h),"identifier",!0),h]:void 0}function S(){y.apply(this,arguments);var a=k(this.handler,this);this.touch=new Q(this.manager,a),this.mouse=new M(this.manager,a)}function T(a,b){this.manager=a,this.set(b)}function U(a){if(q(a,bc))return bc;var b=q(a,cc),c=q(a,dc);return b&&c?cc+" "+dc:b||c?b?cc:dc:q(a,ac)?ac:_b}function V(a){this.id=w(),this.manager=null,this.options=i(a||{},this.defaults),this.options.enable=m(this.options.enable,!0),this.state=ec,this.simultaneous={},this.requireFail=[]}function W(a){return a&jc?"cancel":a&hc?"end":a&gc?"move":a&fc?"start":""}function X(a){return a==Gb?"down":a==Fb?"up":a==Db?"left":a==Eb?"right":""}function Y(a,b){var c=b.manager;return c?c.get(a):a}function Z(){V.apply(this,arguments)}function $(){Z.apply(this,arguments),this.pX=null,this.pY=null}function _(){Z.apply(this,arguments)}function ab(){V.apply(this,arguments),this._timer=null,this._input=null}function bb(){Z.apply(this,arguments)}function cb(){Z.apply(this,arguments)}function db(){V.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function eb(a,b){return b=b||{},b.recognizers=m(b.recognizers,eb.defaults.preset),new fb(a,b)}function fb(a,b){b=b||{},this.options=i(b,eb.defaults),this.options.inputTarget=this.options.inputTarget||a,this.handlers={},this.session={},this.recognizers=[],this.element=a,this.input=z(this),this.touchAction=new T(this,this.options.touchAction),gb(this,!0),g(b.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]),a[3]&&b.requireFailure(a[3])},this)}function gb(a,b){var c=a.element;g(a.options.cssProps,function(a,d){c.style[v(c.style,d)]=b?a:""})}function hb(a,c){var d=b.createEvent("Event");d.initEvent(a,!0,!0),d.gesture=c,c.target.dispatchEvent(d)}var ib=["","webkit","moz","MS","ms","o"],jb=b.createElement("div"),kb="function",lb=Math.round,mb=Math.abs,nb=Date.now,ob=1,pb=/mobile|tablet|ip(ad|hone|od)|android/i,qb="ontouchstart"in a,rb=v(a,"PointerEvent")!==d,sb=qb&&pb.test(navigator.userAgent),tb="touch",ub="pen",vb="mouse",wb="kinect",xb=25,yb=1,zb=2,Ab=4,Bb=8,Cb=1,Db=2,Eb=4,Fb=8,Gb=16,Hb=Db|Eb,Ib=Fb|Gb,Jb=Hb|Ib,Kb=["x","y"],Lb=["clientX","clientY"];y.prototype={handler:function(){},init:function(){this.evEl&&n(this.element,this.evEl,this.domHandler),this.evTarget&&n(this.target,this.evTarget,this.domHandler),this.evWin&&n(x(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&o(this.element,this.evEl,this.domHandler),this.evTarget&&o(this.target,this.evTarget,this.domHandler),this.evWin&&o(x(this.element),this.evWin,this.domHandler)}};var Mb={mousedown:yb,mousemove:zb,mouseup:Ab},Nb="mousedown",Ob="mousemove mouseup";j(M,y,{handler:function(a){var b=Mb[a.type];b&yb&&0===a.button&&(this.pressed=!0),b&zb&&1!==a.which&&(b=Ab),this.pressed&&this.allow&&(b&Ab&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:vb,srcEvent:a}))}});var Pb={pointerdown:yb,pointermove:zb,pointerup:Ab,pointercancel:Bb,pointerout:Bb},Qb={2:tb,3:ub,4:vb,5:wb},Rb="pointerdown",Sb="pointermove pointerup pointercancel";a.MSPointerEvent&&(Rb="MSPointerDown",Sb="MSPointerMove MSPointerUp MSPointerCancel"),j(N,y,{handler:function(a){var b=this.store,c=!1,d=a.type.toLowerCase().replace("ms",""),e=Pb[d],f=Qb[a.pointerType]||a.pointerType,g=f==tb,h=s(b,a.pointerId,"pointerId");e&yb&&(0===a.button||g)?0>h&&(b.push(a),h=b.length-1):e&(Ab|Bb)&&(c=!0),0>h||(b[h]=a,this.callback(this.manager,e,{pointers:b,changedPointers:[a],pointerType:f,srcEvent:a}),c&&b.splice(h,1))}});var Tb={touchstart:yb,touchmove:zb,touchend:Ab,touchcancel:Bb},Ub="touchstart",Vb="touchstart touchmove touchend touchcancel";j(O,y,{handler:function(a){var b=Tb[a.type];if(b===yb&&(this.started=!0),this.started){var c=P.call(this,a,b);b&(Ab|Bb)&&c[0].length-c[1].length===0&&(this.started=!1),this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:tb,srcEvent:a})}}});var Wb={touchstart:yb,touchmove:zb,touchend:Ab,touchcancel:Bb},Xb="touchstart touchmove touchend touchcancel";j(Q,y,{handler:function(a){var b=Wb[a.type],c=R.call(this,a,b);c&&this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:tb,srcEvent:a})}}),j(S,y,{handler:function(a,b,c){var d=c.pointerType==tb,e=c.pointerType==vb;if(d)this.mouse.allow=!1;else if(e&&!this.mouse.allow)return;b&(Ab|Bb)&&(this.mouse.allow=!0),this.callback(a,b,c)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Yb=v(jb.style,"touchAction"),Zb=Yb!==d,$b="compute",_b="auto",ac="manipulation",bc="none",cc="pan-x",dc="pan-y";T.prototype={set:function(a){a==$b&&(a=this.compute()),Zb&&(this.manager.element.style[Yb]=a),this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var a=[];return g(this.manager.recognizers,function(b){l(b.options.enable,[b])&&(a=a.concat(b.getTouchAction()))}),U(a.join(" "))},preventDefaults:function(a){if(!Zb){var b=a.srcEvent,c=a.offsetDirection;if(this.manager.session.prevented)return void b.preventDefault();var d=this.actions,e=q(d,bc),f=q(d,dc),g=q(d,cc);return e||f&&c&Hb||g&&c&Ib?this.preventSrc(b):void 0}},preventSrc:function(a){this.manager.session.prevented=!0,a.preventDefault()}};var ec=1,fc=2,gc=4,hc=8,ic=hc,jc=16,kc=32;V.prototype={defaults:{},set:function(a){return h(this.options,a),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(a){if(f(a,"recognizeWith",this))return this;var b=this.simultaneous;return a=Y(a,this),b[a.id]||(b[a.id]=a,a.recognizeWith(this)),this},dropRecognizeWith:function(a){return f(a,"dropRecognizeWith",this)?this:(a=Y(a,this),delete this.simultaneous[a.id],this)},requireFailure:function(a){if(f(a,"requireFailure",this))return this;var b=this.requireFail;return a=Y(a,this),-1===s(b,a)&&(b.push(a),a.requireFailure(this)),this},dropRequireFailure:function(a){if(f(a,"dropRequireFailure",this))return this;a=Y(a,this);var b=s(this.requireFail,a);return b>-1&&this.requireFail.splice(b,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){function b(b){c.manager.emit(c.options.event+(b?W(d):""),a)}var c=this,d=this.state;hc>d&&b(!0),b(),d>=hc&&b(!0)},tryEmit:function(a){return this.canEmit()?this.emit(a):void(this.state=kc)},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&(kc|ec)))return!1;a++}return!0},recognize:function(a){var b=h({},a);return l(this.options.enable,[this,b])?(this.state&(ic|jc|kc)&&(this.state=ec),this.state=this.process(b),void(this.state&(fc|gc|hc|jc)&&this.tryEmit(b))):(this.reset(),void(this.state=kc))},process:function(){},getTouchAction:function(){},reset:function(){}},j(Z,V,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=this.state,c=a.eventType,d=b&(fc|gc),e=this.attrTest(a);return d&&(c&Bb||!e)?b|jc:d||e?c&Ab?b|hc:b&fc?b|gc:fc:kc}}),j($,Z,{defaults:{event:"pan",threshold:10,pointers:1,direction:Jb},getTouchAction:function(){var a=this.options.direction,b=[];return a&Hb&&b.push(dc),a&Ib&&b.push(cc),b},directionTest:function(a){var b=this.options,c=!0,d=a.distance,e=a.direction,f=a.deltaX,g=a.deltaY;return e&b.direction||(b.direction&Hb?(e=0===f?Cb:0>f?Db:Eb,c=f!=this.pX,d=Math.abs(a.deltaX)):(e=0===g?Cb:0>g?Fb:Gb,c=g!=this.pY,d=Math.abs(a.deltaY))),a.direction=e,c&&d>b.threshold&&e&b.direction},attrTest:function(a){return Z.prototype.attrTest.call(this,a)&&(this.state&fc||!(this.state&fc)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX,this.pY=a.deltaY;var b=X(a.direction);b&&this.manager.emit(this.options.event+b,a),this._super.emit.call(this,a)}}),j(_,Z,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[bc]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&fc);},emit:function(a){if(this._super.emit.call(this,a),1!==a.scale){var b=a.scale<1?"in":"out";this.manager.emit(this.options.event+b,a)}}}),j(ab,V,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[_b]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime>b.time;if(this._input=a,!d||!c||a.eventType&(Ab|Bb)&&!f)this.reset();else if(a.eventType&yb)this.reset(),this._timer=e(function(){this.state=ic,this.tryEmit()},b.time,this);else if(a.eventType&Ab)return ic;return kc},reset:function(){clearTimeout(this._timer)},emit:function(a){this.state===ic&&(a&&a.eventType&Ab?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=nb(),this.manager.emit(this.options.event,this._input)))}}),j(bb,Z,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[bc]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&fc)}}),j(cb,Z,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:Hb|Ib,pointers:1},getTouchAction:function(){return $.prototype.getTouchAction.call(this)},attrTest:function(a){var b,c=this.options.direction;return c&(Hb|Ib)?b=a.velocity:c&Hb?b=a.velocityX:c&Ib&&(b=a.velocityY),this._super.attrTest.call(this,a)&&c&a.direction&&a.distance>this.options.threshold&&mb(b)>this.options.velocity&&a.eventType&Ab},emit:function(a){var b=X(a.direction);b&&this.manager.emit(this.options.event+b,a),this.manager.emit(this.options.event,a)}}),j(db,V,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[ac]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime<b.time;if(this.reset(),a.eventType&yb&&0===this.count)return this.failTimeout();if(d&&f&&c){if(a.eventType!=Ab)return this.failTimeout();var g=this.pTime?a.timeStamp-this.pTime<b.interval:!0,h=!this.pCenter||I(this.pCenter,a.center)<b.posThreshold;this.pTime=a.timeStamp,this.pCenter=a.center,h&&g?this.count+=1:this.count=1,this._input=a;var i=this.count%b.taps;if(0===i)return this.hasRequireFailures()?(this._timer=e(function(){this.state=ic,this.tryEmit()},b.interval,this),fc):ic}return kc},failTimeout:function(){return this._timer=e(function(){this.state=kc},this.options.interval,this),kc},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ic&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),eb.VERSION="2.0.4",eb.defaults={domEvents:!1,touchAction:$b,enable:!0,inputTarget:null,inputClass:null,preset:[[bb,{enable:!1}],[_,{enable:!1},["rotate"]],[cb,{direction:Hb}],[$,{direction:Hb},["swipe"]],[db],[db,{event:"doubletap",taps:2},["tap"]],[ab]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var lc=1,mc=2;fb.prototype={set:function(a){return h(this.options,a),a.touchAction&&this.touchAction.update(),a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init()),this},stop:function(a){this.session.stopped=a?mc:lc},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);var c,d=this.recognizers,e=b.curRecognizer;(!e||e&&e.state&ic)&&(e=b.curRecognizer=null);for(var f=0;f<d.length;)c=d[f],b.stopped===mc||e&&c!=e&&!c.canRecognizeWith(e)?c.reset():c.recognize(a),!e&&c.state&(fc|gc|hc)&&(e=b.curRecognizer=c),f++}},get:function(a){if(a instanceof V)return a;for(var b=this.recognizers,c=0;c<b.length;c++)if(b[c].options.event==a)return b[c];return null},add:function(a){if(f(a,"add",this))return this;var b=this.get(a.options.event);return b&&this.remove(b),this.recognizers.push(a),a.manager=this,this.touchAction.update(),a},remove:function(a){if(f(a,"remove",this))return this;var b=this.recognizers;return a=this.get(a),b.splice(s(b,a),1),this.touchAction.update(),this},on:function(a,b){var c=this.handlers;return g(r(a),function(a){c[a]=c[a]||[],c[a].push(b)}),this},off:function(a,b){var c=this.handlers;return g(r(a),function(a){b?c[a].splice(s(c[a],b),1):delete c[a]}),this},emit:function(a,b){this.options.domEvents&&hb(a,b);var c=this.handlers[a]&&this.handlers[a].slice();if(c&&c.length){b.type=a,b.preventDefault=function(){b.srcEvent.preventDefault()};for(var d=0;d<c.length;)c[d](b),d++}},destroy:function(){this.element&&gb(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},h(eb,{INPUT_START:yb,INPUT_MOVE:zb,INPUT_END:Ab,INPUT_CANCEL:Bb,STATE_POSSIBLE:ec,STATE_BEGAN:fc,STATE_CHANGED:gc,STATE_ENDED:hc,STATE_RECOGNIZED:ic,STATE_CANCELLED:jc,STATE_FAILED:kc,DIRECTION_NONE:Cb,DIRECTION_LEFT:Db,DIRECTION_RIGHT:Eb,DIRECTION_UP:Fb,DIRECTION_DOWN:Gb,DIRECTION_HORIZONTAL:Hb,DIRECTION_VERTICAL:Ib,DIRECTION_ALL:Jb,Manager:fb,Input:y,TouchAction:T,TouchInput:Q,MouseInput:M,PointerEventInput:N,TouchMouseInput:S,SingleTouchInput:O,Recognizer:V,AttrRecognizer:Z,Tap:db,Pan:$,Swipe:cb,Pinch:_,Rotate:bb,Press:ab,on:n,off:o,each:g,merge:i,extend:h,inherit:j,bindFn:k,prefixed:v}),typeof define==kb&&define.amd?define(function(){return eb}):"undefined"!=typeof module&&module.exports?module.exports=eb:a[c]=eb}(window,document,"Hammer")}!function(a){var b=navigator.userAgent;a.HTMLPictureElement&&/ecko/.test(b)&&b.match(/rv\:(\d+)/)&&RegExp.$1<45&&addEventListener("resize",function(){var b,c=document.createElement("source"),d=function(a){var b,d,e=a.parentNode;"PICTURE"===e.nodeName.toUpperCase()?(b=c.cloneNode(),e.insertBefore(b,e.firstElementChild),setTimeout(function(){e.removeChild(b)})):(!a._pfLastSize||a.offsetWidth>a._pfLastSize)&&(a._pfLastSize=a.offsetWidth,d=a.sizes,a.sizes+=",100vw",setTimeout(function(){a.sizes=d}))},e=function(){var a,b=document.querySelectorAll("picture > img, img[srcset][sizes]");for(a=0;a<b.length;a++)d(b[a])},f=function(){clearTimeout(b),b=setTimeout(e,99)},g=a.matchMedia&&matchMedia("(orientation: landscape)"),h=function(){f(),g&&g.addListener&&g.addListener(f)};return c.srcset="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",/^[c|i]|d$/.test(document.readyState||"")?h():document.addEventListener("DOMContentLoaded",h),f}())}(window),function(a,b,c){"use strict";function d(a){return" "===a||"    "===a||"\n"===a||"\f"===a||"\r"===a}function e(b,c){var d=new a.Image;return d.onerror=function(){A[b]=!1,ba()},d.onload=function(){A[b]=1===d.width,ba()},d.src=c,"pending"}function f(){M=!1,P=a.devicePixelRatio,N={},O={},s.DPR=P||1,Q.width=Math.max(a.innerWidth||0,z.clientWidth),Q.height=Math.max(a.innerHeight||0,z.clientHeight),Q.vw=Q.width/100,Q.vh=Q.height/100,r=[Q.height,Q.width,P].join("-"),Q.em=s.getEmValue(),Q.rem=Q.em}function g(a,b,c,d){var e,f,g,h;return"saveData"===B.algorithm?a>2.7?h=c+1:(f=b-c,e=Math.pow(a-.6,1.5),g=f*e,d&&(g+=.1*e),h=a+g):h=c>1?Math.sqrt(a*b):a,h>c}function h(a){var b,c=s.getSet(a),d=!1;"pending"!==c&&(d=r,c&&(b=s.setRes(c),s.applySetCandidate(b,a))),a[s.ns].evaled=d}function i(a,b){return a.res-b.res}function j(a,b,c){var d;return!c&&b&&(c=a[s.ns].sets,c=c&&c[c.length-1]),d=k(b,c),d&&(b=s.makeUrl(b),a[s.ns].curSrc=b,a[s.ns].curCan=d,d.res||aa(d,d.set.sizes)),d}function k(a,b){var c,d,e;if(a&&b)for(e=s.parseSet(b),a=s.makeUrl(a),c=0;c<e.length;c++)if(a===s.makeUrl(e[c].url)){d=e[c];break}return d}function l(a,b){var c,d,e,f,g=a.getElementsByTagName("source");for(c=0,d=g.length;d>c;c++)e=g[c],e[s.ns]=!0,f=e.getAttribute("srcset"),f&&b.push({srcset:f,media:e.getAttribute("media"),type:e.getAttribute("type"),sizes:e.getAttribute("sizes")})}function m(a,b){function c(b){var c,d=b.exec(a.substring(m));return d?(c=d[0],m+=c.length,c):void 0}function e(){var a,c,d,e,f,i,j,k,l,m=!1,o={};for(e=0;e<h.length;e++)f=h[e],i=f[f.length-1],j=f.substring(0,f.length-1),k=parseInt(j,10),l=parseFloat(j),X.test(j)&&"w"===i?((a||c)&&(m=!0),0===k?m=!0:a=k):Y.test(j)&&"x"===i?((a||c||d)&&(m=!0),0>l?m=!0:c=l):X.test(j)&&"h"===i?((d||c)&&(m=!0),0===k?m=!0:d=k):m=!0;m||(o.url=g,a&&(o.w=a),c&&(o.d=c),d&&(o.h=d),d||c||a||(o.d=1),1===o.d&&(b.has1x=!0),o.set=b,n.push(o))}function f(){for(c(T),i="",j="in descriptor";;){if(k=a.charAt(m),"in descriptor"===j)if(d(k))i&&(h.push(i),i="",j="after descriptor");else{if(","===k)return m+=1,i&&h.push(i),void e();if("("===k)i+=k,j="in parens";else{if(""===k)return i&&h.push(i),void e();i+=k}}else if("in parens"===j)if(")"===k)i+=k,j="in descriptor";else{if(""===k)return h.push(i),void e();i+=k}else if("after descriptor"===j)if(d(k));else{if(""===k)return void e();j="in descriptor",m-=1}m+=1}}for(var g,h,i,j,k,l=a.length,m=0,n=[];;){if(c(U),m>=l)return n;g=c(V),h=[],","===g.slice(-1)?(g=g.replace(W,""),e()):f()}}function n(a){function b(a){function b(){f&&(g.push(f),f="")}function c(){g[0]&&(h.push(g),g=[])}for(var e,f="",g=[],h=[],i=0,j=0,k=!1;;){if(e=a.charAt(j),""===e)return b(),c(),h;if(k){if("*"===e&&"/"===a[j+1]){k=!1,j+=2,b();continue}j+=1}else{if(d(e)){if(a.charAt(j-1)&&d(a.charAt(j-1))||!f){j+=1;continue}if(0===i){b(),j+=1;continue}e=" "}else if("("===e)i+=1;else if(")"===e)i-=1;else{if(","===e){b(),c(),j+=1;continue}if("/"===e&&"*"===a.charAt(j+1)){k=!0,j+=2;continue}}f+=e,j+=1}}}function c(a){return k.test(a)&&parseFloat(a)>=0?!0:l.test(a)?!0:"0"===a||"-0"===a||"+0"===a?!0:!1}var e,f,g,h,i,j,k=/^(?:[+-]?[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?(?:ch|cm|em|ex|in|mm|pc|pt|px|rem|vh|vmin|vmax|vw)$/i,l=/^calc\((?:[0-9a-z \.\+\-\*\/\(\)]+)\)$/i;for(f=b(a),g=f.length,e=0;g>e;e++)if(h=f[e],i=h[h.length-1],c(i)){if(j=i,h.pop(),0===h.length)return j;if(h=h.join(" "),s.matchesMedia(h))return j}return"100vw"}b.createElement("picture");var o,p,q,r,s={},t=!1,u=function(){},v=b.createElement("img"),w=v.getAttribute,x=v.setAttribute,y=v.removeAttribute,z=b.documentElement,A={},B={algorithm:""},C="data-pfsrc",D=C+"set",E=navigator.userAgent,F=/rident/.test(E)||/ecko/.test(E)&&E.match(/rv\:(\d+)/)&&RegExp.$1>35,G="currentSrc",H=/\s+\+?\d+(e\d+)?w/,I=/(\([^)]+\))?\s*(.+)/,J=a.picturefillCFG,K="position:absolute;left:0;visibility:hidden;display:block;padding:0;border:none;font-size:1em;width:1em;overflow:hidden;clip:rect(0px, 0px, 0px, 0px)",L="font-size:100%!important;",M=!0,N={},O={},P=a.devicePixelRatio,Q={px:1,"in":96},R=b.createElement("a"),S=!1,T=/^[ \t\n\r\u000c]+/,U=/^[, \t\n\r\u000c]+/,V=/^[^ \t\n\r\u000c]+/,W=/[,]+$/,X=/^\d+$/,Y=/^-?(?:[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?$/,Z=function(a,b,c,d){a.addEventListener?a.addEventListener(b,c,d||!1):a.attachEvent&&a.attachEvent("on"+b,c)},$=function(a){var b={};return function(c){return c in b||(b[c]=a(c)),b[c]}},_=function(){var a=/^([\d\.]+)(em|vw|px)$/,b=function(){for(var a=arguments,b=0,c=a[0];++b in a;)c=c.replace(a[b],a[++b]);return c},c=$(function(a){return"return "+b((a||"").toLowerCase(),/\band\b/g,"&&",/,/g,"||",/min-([a-z-\s]+):/g,"e.$1>=",/max-([a-z-\s]+):/g,"e.$1<=",/calc([^)]+)/g,"($1)",/(\d+[\.]*[\d]*)([a-z]+)/g,"($1 * e.$2)",/^(?!(e.[a-z]|[0-9\.&=|><\+\-\*\(\)\/])).*/gi,"")+";"});return function(b,d){var e;if(!(b in N))if(N[b]=!1,d&&(e=b.match(a)))N[b]=e[1]*Q[e[2]];else try{N[b]=new Function("e",c(b))(Q)}catch(f){}return N[b]}}(),aa=function(a,b){return a.w?(a.cWidth=s.calcListLength(b||"100vw"),a.res=a.w/a.cWidth):a.res=a.d,a},ba=function(a){if(t){var c,d,e,f=a||{};if(f.elements&&1===f.elements.nodeType&&("IMG"===f.elements.nodeName.toUpperCase()?f.elements=[f.elements]:(f.context=f.elements,f.elements=null)),c=f.elements||s.qsa(f.context||b,f.reevaluate||f.reselect?s.sel:s.selShort),e=c.length){for(s.setupRun(f),S=!0,d=0;e>d;d++)s.fillImg(c[d],f);s.teardownRun(f)}}};o=a.console&&console.warn?function(a){console.warn(a)}:u,G in v||(G="src"),A["image/jpeg"]=!0,A["image/gif"]=!0,A["image/png"]=!0,A["image/svg+xml"]=b.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1"),s.ns=("pf"+(new Date).getTime()).substr(0,9),s.supSrcset="srcset"in v,s.supSizes="sizes"in v,s.supPicture=!!a.HTMLPictureElement,s.supSrcset&&s.supPicture&&!s.supSizes&&!function(a){v.srcset="data:,a",a.src="data:,a",s.supSrcset=v.complete===a.complete,s.supPicture=s.supSrcset&&s.supPicture}(b.createElement("img")),s.supSrcset&&!s.supSizes?!function(){var a="data:image/gif;base64,R0lGODlhAgABAPAAAP///wAAACH5BAAAAAAALAAAAAACAAEAAAICBAoAOw==",c="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",d=b.createElement("img"),e=function(){var a=d.width;2===a&&(s.supSizes=!0),q=s.supSrcset&&!s.supSizes,t=!0,setTimeout(ba)};d.onload=e,d.onerror=e,d.setAttribute("sizes","9px"),d.srcset=c+" 1w,"+a+" 9w",d.src=c}():t=!0,s.selShort="picture>img,img[srcset]",s.sel=s.selShort,s.cfg=B,s.DPR=P||1,s.u=Q,s.types=A,s.setSize=u,s.makeUrl=$(function(a){return R.href=a,R.href}),s.qsa=function(a,b){return"querySelector"in a?a.querySelectorAll(b):[]},s.matchesMedia=function(){return a.matchMedia&&(matchMedia("(min-width: 0.1em)")||{}).matches?s.matchesMedia=function(a){return!a||matchMedia(a).matches}:s.matchesMedia=s.mMQ,s.matchesMedia.apply(this,arguments)},s.mMQ=function(a){return a?_(a):!0},s.calcLength=function(a){var b=_(a,!0)||!1;return 0>b&&(b=!1),b},s.supportsType=function(a){return a?A[a]:!0},s.parseSize=$(function(a){var b=(a||"").match(I);return{media:b&&b[1],length:b&&b[2]}}),s.parseSet=function(a){return a.cands||(a.cands=m(a.srcset,a)),a.cands},s.getEmValue=function(){var a;if(!p&&(a=b.body)){var c=b.createElement("div"),d=z.style.cssText,e=a.style.cssText;c.style.cssText=K,z.style.cssText=L,a.style.cssText=L,a.appendChild(c),p=c.offsetWidth,a.removeChild(c),p=parseFloat(p,10),z.style.cssText=d,a.style.cssText=e}return p||16},s.calcListLength=function(a){if(!(a in O)||B.uT){var b=s.calcLength(n(a));O[a]=b?b:Q.width}return O[a]},s.setRes=function(a){var b;if(a){b=s.parseSet(a);for(var c=0,d=b.length;d>c;c++)aa(b[c],a.sizes)}return b},s.setRes.res=aa,s.applySetCandidate=function(a,b){if(a.length){var c,d,e,f,h,k,l,m,n,o=b[s.ns],p=s.DPR;if(k=o.curSrc||b[G],l=o.curCan||j(b,k,a[0].set),l&&l.set===a[0].set&&(n=F&&!b.complete&&l.res-.1>p,n||(l.cached=!0,l.res>=p&&(h=l))),!h)for(a.sort(i),f=a.length,h=a[f-1],d=0;f>d;d++)if(c=a[d],c.res>=p){e=d-1,h=a[e]&&(n||k!==s.makeUrl(c.url))&&g(a[e].res,c.res,p,a[e].cached)?a[e]:c;break}h&&(m=s.makeUrl(h.url),o.curSrc=m,o.curCan=h,m!==k&&s.setSrc(b,h),s.setSize(b))}},s.setSrc=function(a,b){var c;a.src=b.url,"image/svg+xml"===b.set.type&&(c=a.style.width,a.style.width=a.offsetWidth+1+"px",a.offsetWidth+1&&(a.style.width=c))},s.getSet=function(a){var b,c,d,e=!1,f=a[s.ns].sets;for(b=0;b<f.length&&!e;b++)if(c=f[b],c.srcset&&s.matchesMedia(c.media)&&(d=s.supportsType(c.type))){"pending"===d&&(c=d),e=c;break}return e},s.parseSets=function(a,b,d){var e,f,g,h,i=b&&"PICTURE"===b.nodeName.toUpperCase(),j=a[s.ns];(j.src===c||d.src)&&(j.src=w.call(a,"src"),j.src?x.call(a,C,j.src):y.call(a,C)),(j.srcset===c||d.srcset||!s.supSrcset||a.srcset)&&(e=w.call(a,"srcset"),j.srcset=e,h=!0),j.sets=[],i&&(j.pic=!0,l(b,j.sets)),j.srcset?(f={srcset:j.srcset,sizes:w.call(a,"sizes")},j.sets.push(f),g=(q||j.src)&&H.test(j.srcset||""),g||!j.src||k(j.src,f)||f.has1x||(f.srcset+=", "+j.src,f.cands.push({url:j.src,d:1,set:f}))):j.src&&j.sets.push({srcset:j.src,sizes:null}),j.curCan=null,j.curSrc=c,j.supported=!(i||f&&!s.supSrcset||g&&!s.supSizes),h&&s.supSrcset&&!j.supported&&(e?(x.call(a,D,e),a.srcset=""):y.call(a,D)),j.supported&&!j.srcset&&(!j.src&&a.src||a.src!==s.makeUrl(j.src))&&(null===j.src?a.removeAttribute("src"):a.src=j.src),j.parsed=!0},s.fillImg=function(a,b){var c,d=b.reselect||b.reevaluate;a[s.ns]||(a[s.ns]={}),c=a[s.ns],(d||c.evaled!==r)&&((!c.parsed||b.reevaluate)&&s.parseSets(a,a.parentNode,b),c.supported?c.evaled=r:h(a))},s.setupRun=function(){(!S||M||P!==a.devicePixelRatio)&&f()},s.supPicture?(ba=u,s.fillImg=u):!function(){var c,d=a.attachEvent?/d$|^c/:/d$|^c|^i/,e=function(){var a=b.readyState||"";f=setTimeout(e,"loading"===a?200:999),b.body&&(s.fillImgs(),c=c||d.test(a),c&&clearTimeout(f))},f=setTimeout(e,b.body?9:99),g=function(a,b){var c,d,e=function(){var f=new Date-d;b>f?c=setTimeout(e,b-f):(c=null,a())};return function(){d=new Date,c||(c=setTimeout(e,b))}},h=z.clientHeight,i=function(){M=Math.max(a.innerWidth||0,z.clientWidth)!==Q.width||z.clientHeight!==h,h=z.clientHeight,M&&s.fillImgs()};Z(a,"resize",g(i,99)),Z(b,"readystatechange",e)}(),s.picturefill=ba,s.fillImgs=ba,s.teardownRun=u,ba._=s,a.picturefillCFG={pf:s,push:function(a){var b=a.shift();"function"==typeof s[b]?s[b].apply(s,a):(B[b]=a[0],S&&s.fillImgs({reselect:!0}))}};for(;J&&J.length;)a.picturefillCFG.push(J.shift());a.picturefill=ba,"object"==typeof module&&"object"==typeof module.exports?module.exports=ba:"function"==typeof define&&define.amd&&define("picturefill",function(){return ba}),s.supPicture||(A["image/webp"]=e("image/webp","data:image/webp;base64,UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAABBxAR/Q9ERP8DAABWUDggGAAAADABAJ0BKgEAAQADADQlpAADcAD++/1QAA=="))}(window,document);;trkbook.controller("searchTripController",["$scope","$http","$window","$timeout",function($scope,$http,$window,$timeout){$scope.enter_email="";$scope.pdfemailError="";$scope.s_d="";$scope.d_name="";$scope.baseurl=$window.baseUrl;$scope.OpenPdfModalDestination=function(){$("#pdf-guide-modal").modal("show");$scope.validateSubEmail=false;$scope.enter_email="";$scope.dCompleted=false;$scope.ddInitializing=false};$scope.sendEmailPdf=function(){$scope.dInitializing=true;$scope.validateSubEmail=false;$http.post($scope.baseurl+"/products/ws/sendemailpdf/",{destination_id:$scope.s_d,email:$scope.enter_email}).success(function(data){if(data.pdf_link){$scope.enter_email="";downloadURI(data.pdf_link,$scope.d_name+".pdf");$scope.validateSubEmail=false;$scope.dCompleted=true;$scope.dInitializing=false}else{$scope.pdfemailError="Something went wrong. Try Again!";$scope.dInitializing=false;$scope.validateSubEmail=true}}).error(function(err){});setTimeout(function(){$scope.pdfemailError="";$scope.$apply()},5e3)};$scope.validateEmail=function(){var re=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;$scope.validateSubEmail=re.test($scope.enter_email)};function downloadURI(uri,name){var link=document.createElement("a");link.download=name;link.target="_blank";link.href=uri;link.click()}}]);trkbook.config(["cfpLoadingBarProvider",function(cfpLoadingBarProvider){cfpLoadingBarProvider.includeBar=false}]);;$bm(".home-search-button").addListener("click",function(e){e.preventDefault();var pos=1;if(e.target.tagName=="BUTTON"){pos=e.target.dataset.position}else{pos=e.target.parentElement.dataset.position}var scope=angular.element("#homeSearch"+pos).scope();scope.goSearch()});function toggleMonthFilter(pos){if($bm("#month-dep-select"+pos).hasClass("active")){$bm("#month-dep-select"+pos).removeClass("active")}else{$bm("#month-dep-select"+pos).addClass("active")}}function updateSearch(){$bm(".suggestions-dropdown .item-list a.searchkey").addListener("click",function(e){var data=e.target.dataset;var pos=data.position;var scope=angular.element("#homeSearch"+pos).scope();var search=data.name;var url=data.ngHref;document.getElementById("homeSearch"+pos).value=search;toggleMonthFilter(pos);scope.redirectUrl=url})}function searchClassListener(){if(document.querySelector("#suggestions1").className!=="suggestions-dropdown s ng-hide"){var loader=document.querySelector("#suggestions1 .spinner-circle");var loaderClass="";var timer=setInterval(function(){loaderClass=loader.className;if(loaderClass==="spinner-circle ng-hide"){updateSearch();clearInterval(timer)}},300)}if(document.querySelector("#suggestions2").className!=="suggestions-dropdown s ng-hide"){var suggestionloader=document.querySelector("#suggestions2 .spinner-circle");var suggestionloaderClass="";var suggestionTimer=setInterval(function(){suggestionloaderClass=suggestionloader.className;if(suggestionloaderClass==="spinner-circle ng-hide"){updateSearch();clearInterval(suggestionTimer)}},300)}}$("#homeSearch2, #homeSearch1").change(function(e){console.log(e);var id=e.target.id;var scope=angular.element("#"+id).scope();scope.redirectUrl=""});var chosen="";$("#homeSearch2, #homeSearch1").keydown(function(e){var selector="";if(document.querySelectorAll(".suggestions-dropdown.ng-hide.suggest1").length==1){selector=".suggest1"}if(document.querySelectorAll(".suggestions-dropdown.ng-hide.suggest1").length==2){selector=".suggest2"}var suggestionDiv=document.querySelector(".suggestions-dropdown.ng-hide"+selector).classList;if(suggestionDiv.contains("s")){selector+=".sb";$(".s .item-list").removeClass("selected")}else{selector+=".s";$(".sb .item-list").removeClass("selected")}if(e.keyCode==40){if(chosen===""){chosen=0}else if(chosen+1<$(selector+" .item-list").length){chosen++}$(selector+" .item-list").removeClass("selected");$(selector+" .item-list:eq("+chosen+")").addClass("selected");return false}if(e.keyCode==38){if(chosen===""){chosen=0}else if(chosen>0){chosen--}$(selector+" .item-list").removeClass("selected");$(selector+" .item-list:eq("+chosen+")").addClass("selected");return false}if(e.keyCode==13){e.preventDefault();var id=e.target.id;var searchkey="";var scope=angular.element("#"+id).scope();var pos=$(".item-list.selected a").data("position");var href=$(".item-list.selected a").data("ng-href");searchkey=$(".item-list.selected a").text().trim();if(!!href){e.preventDefault();scope.redirectUrl=href;$("#"+id).val(searchkey).unbind("change");$(selector+" .item-list").removeClass("selected");$("#"+id).blur();$(".s").addClass("ng-hide");toggleMonthFilter(pos)}else{scope.hideSuggestions();scope.goSearch()}}});$(document).ready(function(){setTimeout(function(){$("#dis-homepage").addClass("active")},1e3);updateSearch();$(".month-dep-select .month-list a.dateFilter").click(function(e){var date=e.target.innerHTML.trim();var pos=$(e.target).data("position");var filter=$(e.target).data("filter");var scope=angular.element("#homeSearch"+pos).scope();$("#month-dep-select"+pos+" li.active").removeClass("active");$(e.target).parent().addClass("active");$("#homeSearchDate"+pos).val(date);scope.dateFilter=encodeURI("departure_month="+filter);toggleMonthFilter(pos)});$("body").click(function(e){var test=$(e.target).hasClass("searchkey");var dateFilter=$(e.target).hasClass("dateFilter");if(test||dateFilter){return false}else if(e.target.id=="month-dep-select1"||$(e.target).parents("#month-dep-select1").length){toggleMonthFilter(1)}else if(e.target.id=="month-dep-select2"||$(e.target).parents("#month-dep-select2").length){toggleMonthFilter(2)}else{$("#month-dep-select1").removeClass("active");$("#month-dep-select2").removeClass("active")}});$("#how-it-works").addClass("on");checkResize();$(window).resize(function(){checkResize()});$("#btn-top-deals").on("click",function(){$("img.lazy-tab").lazyload({effect:"fadeIn",event:"lazyload"}).trigger("lazyload")});$("#btn-how").on("click",function(){$("img.lazy-click").lazyload({placeholder:false,effect:"fadeIn",event:"lazy-click"}).trigger("lazy-click");$("#how-it-works").removeClass("scrolled");$("#how-it-works").addClass("open");$("html, body").scrollTop(0)});$("#btn-how-close").on("click",function(){$("#how-it-works").removeClass("open")});$(".trip-block.tabbed .nav-tabs>li a").click(function(){setTimeout(function(){$(window).trigger("resize").trigger("scroll")},500)});$(document).mouseup(function(e){var container=$("#how-it-works");if(!container.is(e.target)&&container.has(e.target).length===0){container.removeClass("open")}});$(window).bind("scroll",function(){if($("#how-it-works").hasClass("open")){if($(window).scrollTop()>=$("#how-it-works").outerHeight()){$("#how-it-works").removeClass("open");$("#how-it-works").addClass("scrolled");$("html, body").scrollTop(0)}}});if($("#salesModalBox").length){var salesName=$("#salesModalBox").data("name");var iOSDevice=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;$("#sales-btn").click(function(){$(this).hide();$("#sales-email").fadeIn(300,function(){$("#email-input").focus()})});$(".sales-close,.sales-btn-cross").click(function(){if(typeof Storage!=="undefined"){try{localStorage.setItem(salesName+"-sales-hide",true)}catch(e){}}$(".salesModal").fadeOut(250);if(iOSDevice)$("body").removeClass("modal-open")});if(typeof Storage!=="undefined"){if(localStorage.getItem(salesName+"-sales-hide")==null){setTimeout(function(){if($(window).width()<681)window.scrollTo(0,0);else{if(iOSDevice)$("body").addClass("modal-open")}$(".salesModal").addClass("flipAni")},4e3)}}}});function checkResize(){if($(window).width()<1200){$("img.lazy-tab").lazyload({effect:"fadeIn",event:"lazyload"}).trigger("lazyload")}}function playPause(){var myVideo=document.getElementById("bookmundi-video");var MyVideoBtn=document.getElementById("video-button");if(myVideo.paused){myVideo.play();MyVideoBtn.innerHTML='<span class="icon-interface play-pause"></span><span class="sr-only">Video Playing. Click to Pause</span>'}else{myVideo.pause();MyVideoBtn.innerHTML='<span class="icon-multimedia play-pause"></span><span class="sr-only">Video Paused. Click to Play</span>'}}var $$=function(){var Constructor=function(selector){if(!selector)return;if(selector==="document"){this.elems=[document]}else if(selector==="window"){this.elems=[window]}else{this.elems=document.querySelectorAll(selector)}};function sendRequest(url,callback,postData){var req=createXMLHTTPObject();if(!req)return;var method=postData?"POST":"GET";req.open(method,url,true);if(postData)req.setRequestHeader("Content-type","text/html");req.onreadystatechange=function(){if(req.readyState!=4)return;if(req.status!=200&&req.status!=304){return}callback(req)};if(req.readyState==4)return;req.send(postData)}function createXMLHTTPObject(){var XMLHttpFactories=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];var xmlhttp=false;for(var i=0;i<XMLHttpFactories.length;i++){try{xmlhttp=XMLHttpFactories[i]()}catch(e){continue}break}return xmlhttp}var storage=function(){return{set:function(key,value){localStorage.setItem(key,JSON.stringify(value));localStorage.setItem(key+"_timestamp",getOneWeek())},get:function(key){var store=localStorage.getItem(key);var isExpired=checkExpiration(localStorage.getItem(key+"_timestamp"));console.log(isExpired);return isExpired?null:store}}}();function getOneWeek(){var now=new Date;now.setDate(now.getDate()+7);return now.getTime()}function checkExpiration(expirationTime){var now=new Date;var currentTime=now.getTime();return expirationTime<currentTime}Constructor.prototype.each=function(callback){if(!callback||typeof callback!=="function")return;for(var i=0;i<this.elems.length;i++){callback(this.elems[i],i)}};Constructor.prototype.insertDom=function(action){this.each(function(item){item.addEventListener(action,function(event){event.preventDefault();handlerEvent(item)})});return this};function handlerEvent(item){var url=item.dataset.url;var storeData=storage.get(url);var dom=document.getElementById(item.dataset.containerId);storeData?dom.innerHTML=JSON.parse(storeData):sendRequest(url,function(res){dom.innerHTML=res.response;storage.set(url,res.response)})}Constructor.prototype.callFunction=function(func){func()};var instantiate=function(selector){return new Constructor(selector)};return instantiate}();var destinationsDom=$$("[data-url]");destinationsDom.insertDom("click");;trkbook.controller("homeController",["$scope","$http","$window","$timeout","$element","$rootScope","homeService",function($scope,$http,$window,$timeout,$element,$rootScope,homeService){$scope.showSuggestionDiv=false;$scope.showListsDiv=false;$scope.suggestions=[];$scope.defaultSuggestions=[];$scope.loading=false;$scope.redirectUrl="";$scope.dateFilter="";var typingTimer;var doneTypingInterval=300;$scope.getSuggestions=function(){$scope.showListsDiv=false;$scope.showSuggestionDiv=true;clearTimeout(typingTimer);if($scope.q.length>2){typingTimer=setTimeout(doSearch,doneTypingInterval)}else{$scope.suggestions=$scope.defaultSuggestions}};function doSearch(){if($scope.suggestions.length==0){if(!$scope.$$phase)$scope.$apply(function(){$scope.loading=true})}else{$scope.loading=true}homeService.getSuggestions($scope.q).then(function(suggestions){if(!$scope.$$phase){$scope.$apply(function(){$scope.loading=false;$scope.showSuggestionDiv=true;$scope.suggestions=suggestions;$window.chosen=""})}else{$scope.loading=false;$scope.showSuggestionDiv=true;$scope.suggestions=suggestions;$window.chosen=""}searchClassListener()},function(error){})}$scope.showSuggestions=function(id){if(isMob){$("html, body").animate({scrollTop:$("#homeSearch"+id).offset().top-20},100)}if($("#homeSearch"+id).val()==""){$scope.showListsDiv=true}else{$scope.showSuggestionDiv=true}};$scope.hideSuggestions=function(){$timeout(function(){$scope.showSuggestionDiv=false;$scope.showListsDiv=false},500)};$scope.convertToSlug=function(Text){return Text.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,"")};$scope.checkClick=function(evt){q=$("#homeSearch1").val();var active="1";if(q==""){q=$("#homeSearch2").val();var active="2"}if(!(q==null||q=="")){$("#home-search-button"+active).addClass("loading")}};$scope.goSearch=function(){var sep="&";if($scope.redirectUrl.search(/(\?q=)/g)==-1){sep="?"}$scope.checkClick();var searchUrl="";if($scope.redirectUrl==""){var q=$("#homeSearch1").val();if(q==""){q=$("#homeSearch2").val()}if($scope.dateFilter!=""){q+="&"+$scope.dateFilter}if(q.length>0){searchUrl=baseUrl+"/?q="+q}}else{if($scope.dateFilter.length>0){searchUrl=$scope.redirectUrl+sep+$scope.dateFilter}else{searchUrl=$scope.redirectUrl}}$window.open(searchUrl,"_self")}}]);;trkbook.service("homeService",function($http,$window,$q){return{getSuggestions:getSuggestions};var canceler;function getSuggestions(q){if(canceler)canceler.resolve();canceler=$q.defer();var request=$http({method:"get",url:$window.baseUrl+"/ws/getSuggestions/?q="+q,dataType:"json",cache:true,ignoreLoadingBar:true,timeout:canceler.promise});return request.then(handleSuccess,handleError)}function handleSuccess(response){return response.data}function handleError(response){if(!angular.isObject(response.data)||!response.data.message){return $q.reject("An unknown error has occurred. Please refresh the browser.")}return $q.reject(response.data.message)}});;angular.module("bw.paging",[]).directive("paging",function(){function a(a,b,c){a.$watchCollection("[page,pageSize,total,disabled]",function(){l(a,c)})}function b(a,b){return'<ul data-ng-hide="Hide" data-ng-class="ulClass"> <li title="{{Item.title}}" data-ng-class="Item.liClass" data-ng-repeat="Item in List"> <a '+(b.pgHref?'data-ng-href="{{Item.pgHref}}" ':"href ")+'data-ng-class="Item.aClass" data-ng-click="Item.action()" data-ng-bind="Item.value"></a> </li></ul>'}function c(a,b){a.List=[],a.Hide=!1,a.page=parseInt(a.page)||1,a.total=parseInt(a.total)||0,a.adjacent=parseInt(a.adjacent)||2,a.pgHref=a.pgHref||"",a.dots=a.dots||"...",a.ulClass=a.ulClass||"pagination",a.activeClass=a.activeClass||"active",a.disabledClass=a.disabledClass||"disabled",a.textFirst=a.textFirst||"<<",a.textLast=a.textLast||">>",a.textNext=a.textNext||">",a.textPrev=a.textPrev||"<",a.dotsClass=a.dotsClass||"",a.textFirstClass=a.textFirstClass||"",a.textLastClass=a.textLastClass||"",a.textNextClass=a.textNextClass||"",a.textPrevClass=a.textPrevClass||"",a.textTitlePage=a.textTitlePage||"Page {page}",a.textTitleFirst=a.textTitleFirst||"First Page",a.textTitleLast=a.textTitleLast||"Last Page",a.textTitleNext=a.textTitleNext||"Next Page",a.textTitlePrev=a.textTitlePrev||"Previous Page",a.hideIfEmpty=d(a,b.hideIfEmpty),a.showPrevNext=d(a,b.showPrevNext),a.showFirstLast=d(a,b.showFirstLast),a.scrollTop=d(a,b.scrollTop),a.isDisabled=d(a,b.disabled)}function d(a,b){return angular.isDefined(b)?!!a.$parent.$eval(b):!1}function e(a,b){a.page>b&&(a.page=b),a.page<=0&&(a.page=1),a.adjacent<=0&&(a.adjacent=2),1>=b&&(a.Hide=a.hideIfEmpty)}function f(a,b){a.page!=b&&(a.isDisabled||(a.page=b,a.pagingAction({page:a.page,pageSize:a.pageSize,total:a.total}),a.scrollTop&&scrollTo(0,0)))}function g(a,b,c){if(!(!a.showPrevNext&&!a.showFirstLast||1>b)){var d,e,g;if("prev"===c){d=a.page-1<=0;var h=a.page-1<=0?1:a.page-1;a.showFirstLast&&(e={value:a.textFirst,title:a.textTitleFirst,aClass:a.textFirstClass,page:1}),a.showPrevNext&&(g={value:a.textPrev,title:a.textTitlePrev,aClass:a.textPrevClass,page:h})}else{d=a.page+1>b;var i=a.page+1>=b?b:a.page+1;a.showPrevNext&&(e={value:a.textNext,title:a.textTitleNext,aClass:a.textNextClass,page:i}),a.showFirstLast&&(g={value:a.textLast,title:a.textTitleLast,aClass:a.textLastClass,page:b})}var j=function(b,c){return{title:b.title,aClass:b.aClass,value:b.aClass?"":b.value,liClass:c?a.disabledClass:"",pgHref:c?"":a.pgHref.replace(m,b.page),action:function(){c||f(a,b.page)}}};if(a.isDisabled&&(d=!0),e){var k=j(e,d);a.List.push(k)}if(g){var l=j(g,d);a.List.push(l)}}}function h(a,b,c){var d=0;for(d=a;b>=d;d++){var e=c.pgHref.replace(m,d),g=c.page==d?c.activeClass:"";c.isDisabled&&(e="",g=c.disabledClass),c.List.push({value:d,title:c.textTitlePage.replace(m,d),liClass:g,pgHref:e,action:function(){f(c,this.value)}})}}function i(a){a.List.push({value:a.dots,liClass:a.dotsClass?a.dotsClass:a.disabledClass})}function j(a,b){h(1,2,a),3!=b&&i(a)}function k(a,b,c){c!=a-2&&i(b),h(a-1,a,b)}function l(a,b){setTimeout(function(){(!a.pageSize||a.pageSize<=0)&&(a.pageSize=1);var d=Math.ceil(a.total/a.pageSize);c(a,b),e(a,d);var f,i,l=2*a.adjacent+2;g(a,d,"prev"),l+2>=d?(f=1,h(f,d,a)):a.page-a.adjacent<=2?(f=1,i=1+l,h(f,i,a),k(d,a,i)):a.page<d-(a.adjacent+2)?(f=a.page-a.adjacent,i=a.page+a.adjacent,j(a,f),h(f,i,a),k(d,a,i)):(f=d-l,i=d,j(a,f),h(f,i,a)),g(a,d,"next")},300);}var m=/\{page\}/g;return{restrict:"EA",link:a,template:b,scope:{page:"=",pageSize:"=",total:"=",disabled:"@",dots:"@",dotsClass:"@",ulClass:"@",activeClass:"@",disabledClass:"@",adjacent:"@",pagingAction:"&",pgHref:"@",textFirst:"@",textLast:"@",textNext:"@",textPrev:"@",textFirstClass:"@",textLastClass:"@",textNextClass:"@",textPrevClass:"@",textTitlePage:"@",textTitleFirst:"@",textTitleLast:"@",textTitleNext:"@",textTitlePrev:"@"}}});;!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t,e){function i(){return new Date(Date.UTC.apply(Date,arguments))}function a(){var t=new Date;return i(t.getFullYear(),t.getMonth(),t.getDate())}function s(t,e){return t.getUTCFullYear()===e.getUTCFullYear()&&t.getUTCMonth()===e.getUTCMonth()&&t.getUTCDate()===e.getUTCDate()}function n(t){return function(){return this[t].apply(this,arguments)}}function r(e,i){function a(t,e){return e.toLowerCase()}var s,n=t(e).data(),r={},h=new RegExp("^"+i.toLowerCase()+"([A-Z])");i=new RegExp("^"+i.toLowerCase());for(var o in n)i.test(o)&&(s=o.replace(h,a),r[s]=n[o]);return r}function h(e){var i={};if(g[e]||(e=e.split("-")[0],g[e])){var a=g[e];return t.each(f,function(t,e){e in a&&(i[e]=a[e])}),i}}var o=function(){var e={get:function(t){return this.slice(t)[0]},contains:function(t){for(var e=t&&t.valueOf(),i=0,a=this.length;a>i;i++)if(this[i].valueOf()===e)return i;return-1},remove:function(t){this.splice(t,1)},replace:function(e){e&&(t.isArray(e)||(e=[e]),this.clear(),this.push.apply(this,e))},clear:function(){this.length=0},copy:function(){var t=new o;return t.replace(this),t}};return function(){var i=[];return i.push.apply(i,arguments),t.extend(i,e),i}}(),d=function(e,i){this._process_options(i),this.dates=new o,this.viewDate=this.o.defaultViewDate,this.focusDate=null,this.element=t(e),this.isInline=!1,this.isInput=this.element.is("input"),this.component=this.element.hasClass("date")?this.element.find(".add-on, .input-group-addon, .btn"):!1,this.hasInput=this.component&&this.element.find("input").length,this.component&&0===this.component.length&&(this.component=!1),this.picker=t(D.template),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu"),this.o.rtl&&this.picker.addClass("datepicker-rtl"),this.viewMode=this.o.startView,this.o.calendarWeeks&&this.picker.find("tfoot .today, tfoot .clear").attr("colspan",function(t,e){return parseInt(e)+1}),this._allow_update=!1,this.setStartDate(this._o.startDate),this.setEndDate(this._o.endDate),this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled),this.setDaysOfWeekHighlighted(this.o.daysOfWeekHighlighted),this.setDatesDisabled(this.o.datesDisabled),this.fillDow(),this.fillMonths(),this._allow_update=!0,this.update(),this.showMode(),this.isInline&&this.show()};d.prototype={constructor:d,_process_options:function(s){this._o=t.extend({},this._o,s);var n=this.o=t.extend({},this._o),r=n.language;switch(g[r]||(r=r.split("-")[0],g[r]||(r=p.language)),n.language=r,n.startView){case 2:case"decade":n.startView=2;break;case 1:case"year":n.startView=1;break;default:n.startView=0}switch(n.minViewMode){case 1:case"months":n.minViewMode=1;break;case 2:case"years":n.minViewMode=2;break;default:n.minViewMode=0}switch(n.maxViewMode){case 0:case"days":n.maxViewMode=0;break;case 1:case"months":n.maxViewMode=1;break;default:n.maxViewMode=2}n.startView=Math.min(n.startView,n.maxViewMode),n.startView=Math.max(n.startView,n.minViewMode),n.multidate!==!0&&(n.multidate=Number(n.multidate)||!1,n.multidate!==!1&&(n.multidate=Math.max(0,n.multidate))),n.multidateSeparator=String(n.multidateSeparator),n.weekStart%=7,n.weekEnd=(n.weekStart+6)%7;var h=D.parseFormat(n.format);if(n.startDate!==-(1/0)&&(n.startDate?n.startDate instanceof Date?n.startDate=this._local_to_utc(this._zero_time(n.startDate)):n.startDate=D.parseDate(n.startDate,h,n.language):n.startDate=-(1/0)),n.endDate!==1/0&&(n.endDate?n.endDate instanceof Date?n.endDate=this._local_to_utc(this._zero_time(n.endDate)):n.endDate=D.parseDate(n.endDate,h,n.language):n.endDate=1/0),n.daysOfWeekDisabled=n.daysOfWeekDisabled||[],t.isArray(n.daysOfWeekDisabled)||(n.daysOfWeekDisabled=n.daysOfWeekDisabled.split(/[,\s]*/)),n.daysOfWeekDisabled=t.map(n.daysOfWeekDisabled,function(t){return parseInt(t,10)}),n.daysOfWeekHighlighted=n.daysOfWeekHighlighted||[],t.isArray(n.daysOfWeekHighlighted)||(n.daysOfWeekHighlighted=n.daysOfWeekHighlighted.split(/[,\s]*/)),n.daysOfWeekHighlighted=t.map(n.daysOfWeekHighlighted,function(t){return parseInt(t,10)}),n.datesDisabled=n.datesDisabled||[],!t.isArray(n.datesDisabled)){var o=[];o.push(D.parseDate(n.datesDisabled,h,n.language)),n.datesDisabled=o}n.datesDisabled=t.map(n.datesDisabled,function(t){return D.parseDate(t,h,n.language)});var d=String(n.orientation).toLowerCase().split(/\s+/g),l=n.orientation.toLowerCase();if(d=t.grep(d,function(t){return/^auto|left|right|top|bottom$/.test(t)}),n.orientation={x:"auto",y:"auto"},l&&"auto"!==l)if(1===d.length)switch(d[0]){case"top":case"bottom":n.orientation.y=d[0];break;case"left":case"right":n.orientation.x=d[0]}else l=t.grep(d,function(t){return/^left|right$/.test(t)}),n.orientation.x=l[0]||"auto",l=t.grep(d,function(t){return/^top|bottom$/.test(t)}),n.orientation.y=l[0]||"auto";else;if(n.defaultViewDate){var c=n.defaultViewDate.year||(new Date).getFullYear(),u=n.defaultViewDate.month||0,f=n.defaultViewDate.day||1;n.defaultViewDate=i(c,u,f)}else n.defaultViewDate=a();n.showOnFocus=n.showOnFocus!==e?n.showOnFocus:!0},_events:[],_secondaryEvents:[],_applyEvents:function(t){for(var i,a,s,n=0;n<t.length;n++)i=t[n][0],2===t[n].length?(a=e,s=t[n][1]):3===t[n].length&&(a=t[n][1],s=t[n][2]),i.on(s,a)},_unapplyEvents:function(t){for(var i,a,s,n=0;n<t.length;n++)i=t[n][0],2===t[n].length?(s=e,a=t[n][1]):3===t[n].length&&(s=t[n][1],a=t[n][2]),i.off(a,s)},_buildEvents:function(){var e={keyup:t.proxy(function(e){-1===t.inArray(e.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:t.proxy(this.keydown,this),paste:t.proxy(this.paste,this)};this.o.showOnFocus===!0&&(e.focus=t.proxy(this.show,this)),this.isInput?this._events=[[this.element,e]]:this.component&&this.hasInput?this._events=[[this.element.find("input"),e],[this.component,{click:t.proxy(this.show,this)}]]:this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:t.proxy(this.show,this)}]],this._events.push([this.element,"*",{blur:t.proxy(function(t){this._focused_from=t.target},this)}],[this.element,{blur:t.proxy(function(t){this._focused_from=t.target},this)}]),this.o.immediateUpdates&&this._events.push([this.element,{"changeYear changeMonth":t.proxy(function(t){this.update(t.date)},this)}]),this._secondaryEvents=[[this.picker,{click:t.proxy(this.click,this)}],[t(window),{resize:t.proxy(this.place,this)}],[t(document),{mousedown:t.proxy(function(e){this.element.is(e.target)||this.element.find(e.target).length||this.picker.is(e.target)||this.picker.find(e.target).length||t(this.picker).hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(e,i){var a=i||this.dates.get(-1),s=this._utc_to_local(a);this.element.trigger({type:e,date:s,dates:t.map(this.dates,this._utc_to_local),format:t.proxy(function(t,e){0===arguments.length?(t=this.dates.length-1,e=this.o.format):"string"==typeof t&&(e=t,t=this.dates.length-1),e=e||this.o.format;var i=this.dates.get(t);return D.formatDate(i,e,this.o.language)},this)})},show:function(){return this.element.attr("readonly")&&this.o.enableOnReadonly===!1?void 0:(this.isInline||this.picker.appendTo(this.o.container),this.place(),this.picker.show(),this._attachSecondaryEvents(),this._trigger("show"),(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&this.o.disableTouchKeyboard&&t(this.element).blur(),this)},hide:function(){return this.isInline?this:this.picker.is(":visible")?(this.focusDate=null,this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this._trigger("hide"),this):this},remove:function(){return this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date,this},paste:function(e){var i;if(e.originalEvent.clipboardData&&e.originalEvent.clipboardData.types&&-1!==t.inArray("text/plain",e.originalEvent.clipboardData.types))i=e.originalEvent.clipboardData.getData("text/plain");else{if(!window.clipboardData)return;i=window.clipboardData.getData("Text")}this.setDate(i),this.update(),e.preventDefault()},_utc_to_local:function(t){return t&&new Date(t.getTime()+6e4*t.getTimezoneOffset())},_local_to_utc:function(t){return t&&new Date(t.getTime()-6e4*t.getTimezoneOffset())},_zero_time:function(t){return t&&new Date(t.getFullYear(),t.getMonth(),t.getDate())},_zero_utc_time:function(t){return t&&new Date(Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()))},getDates:function(){return t.map(this.dates,this._utc_to_local)},getUTCDates:function(){return t.map(this.dates,function(t){return new Date(t)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){var t=this.dates.get(-1);return"undefined"!=typeof t?new Date(t):null},clearDates:function(){var t;this.isInput?t=this.element:this.component&&(t=this.element.find("input")),t&&t.val(""),this.update(),this._trigger("changeDate"),this.o.autoclose&&this.hide()},setDates:function(){var e=t.isArray(arguments[0])?arguments[0]:arguments;return this.update.apply(this,e),this._trigger("changeDate"),this.setValue(),this},setUTCDates:function(){var e=t.isArray(arguments[0])?arguments[0]:arguments;return this.update.apply(this,t.map(e,this._utc_to_local)),this._trigger("changeDate"),this.setValue(),this},setDate:n("setDates"),setUTCDate:n("setUTCDates"),setValue:function(){var t=this.getFormattedDate();return this.isInput?this.element.val(t):this.component&&this.element.find("input").val(t),this},getFormattedDate:function(i){i===e&&(i=this.o.format);var a=this.o.language;return t.map(this.dates,function(t){return D.formatDate(t,i,a)}).join(this.o.multidateSeparator)},setStartDate:function(t){return this._process_options({startDate:t}),this.update(),this.updateNavArrows(),this},setEndDate:function(t){return this._process_options({endDate:t}),this.update(),this.updateNavArrows(),this},setDaysOfWeekDisabled:function(t){return this._process_options({daysOfWeekDisabled:t}),this.update(),this.updateNavArrows(),this},setDaysOfWeekHighlighted:function(t){return this._process_options({daysOfWeekHighlighted:t}),this.update(),this},setDatesDisabled:function(t){this._process_options({datesDisabled:t}),this.update(),this.updateNavArrows()},place:function(){if(this.isInline)return this;var e=this.picker.outerWidth(),i=this.picker.outerHeight(),a=10,s=t(this.o.container),n=s.width(),r=s.height(),h=s.scrollTop(),o=s.offset(),d=[];this.element.parents().each(function(){var e=t(this).css("z-index");"auto"!==e&&0!==e&&d.push(parseInt(e))});var l=Math.max.apply(Math,d)+10,c=this.component?this.component.parent().offset():this.element.offset(),u=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),p=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),f=c.left-o.left,g=c.top-o.top;this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left"),"auto"!==this.o.orientation.x?(this.picker.addClass("datepicker-orient-"+this.o.orientation.x),"right"===this.o.orientation.x&&(f-=e-p)):c.left<0?(this.picker.addClass("datepicker-orient-left"),f-=c.left-a):f+e>n?(this.picker.addClass("datepicker-orient-right"),f=c.left+p-e):this.picker.addClass("datepicker-orient-left");var D,v,m=this.o.orientation.y;if("auto"===m&&(D=-h+g-i,v=h+r-(g+u+i),m=Math.max(D,v)===v?"top":"bottom"),this.picker.addClass("datepicker-orient-"+m),"top"===m?g+=u:g-=i+parseInt(this.picker.css("padding-top")),this.o.rtl){var y=n-(f+p);this.picker.css({top:g,right:y,zIndex:l})}else this.picker.css({top:g,left:f,zIndex:l});return this},_allow_update:!0,update:function(){if(!this._allow_update)return this;var e=this.dates.copy(),i=[],a=!1;return arguments.length?(t.each(arguments,t.proxy(function(t,e){e instanceof Date&&(e=this._local_to_utc(e)),i.push(e)},this)),a=!0):(i=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val(),i=i&&this.o.multidate?i.split(this.o.multidateSeparator):[i],delete this.element.data().date),i=t.map(i,t.proxy(function(t){return D.parseDate(t,this.o.format,this.o.language)},this)),i=t.grep(i,t.proxy(function(t){return t<this.o.startDate||t>this.o.endDate||!t},this),!0),this.dates.replace(i),this.dates.length?this.viewDate=new Date(this.dates.get(-1)):this.viewDate<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.viewDate>this.o.endDate?this.viewDate=new Date(this.o.endDate):this.viewDate=this.o.defaultViewDate,a?this.setValue():i.length&&String(e)!==String(this.dates)&&this._trigger("changeDate"),!this.dates.length&&e.length&&this._trigger("clearDate"),this.fill(),this.element.change(),this},fillDow:function(){var t=this.o.weekStart,e="<tr>";for(this.o.calendarWeeks&&(this.picker.find(".datepicker-days thead tr:first-child .datepicker-switch").attr("colspan",function(t,e){return parseInt(e)+1}),e+='<th class="cw">&#160;</th>');t<this.o.weekStart+7;)e+='<th class="dow">'+g[this.o.language].daysMin[t++%7]+"</th>";e+="</tr>",this.picker.find(".datepicker-days thead").append(e)},fillMonths:function(){for(var t="",e=0;12>e;)t+='<span class="month">'+g[this.o.language].monthsShort[e++]+"</span>";this.picker.find(".datepicker-months td").html(t)},setRange:function(e){e&&e.length?this.range=t.map(e,function(t){return t.valueOf()}):delete this.range,this.fill()},getClassNames:function(e){var i=[],a=this.viewDate.getUTCFullYear(),n=this.viewDate.getUTCMonth(),r=new Date;return e.getUTCFullYear()<a||e.getUTCFullYear()===a&&e.getUTCMonth()<n?i.push("old"):(e.getUTCFullYear()>a||e.getUTCFullYear()===a&&e.getUTCMonth()>n)&&i.push("new"),this.focusDate&&e.valueOf()===this.focusDate.valueOf()&&i.push("focused"),this.o.todayHighlight&&e.getUTCFullYear()===r.getFullYear()&&e.getUTCMonth()===r.getMonth()&&e.getUTCDate()===r.getDate()&&i.push("today"),-1!==this.dates.contains(e)&&i.push("active"),(e.valueOf()<this.o.startDate||e.valueOf()>this.o.endDate||-1!==t.inArray(e.getUTCDay(),this.o.daysOfWeekDisabled))&&i.push("disabled"),(e.valueOf()<this.o.startDate||e.valueOf()>this.o.endDate||-1!==t.inArray(e.getUTCDay(),this.o.daysOfWeekHighlighted))&&i.push("highlighted"),this.o.datesDisabled.length>0&&t.grep(this.o.datesDisabled,function(t){return s(e,t)}).length>0&&i.push("disabled","disabled-date"),this.range&&(e>this.range[0]&&e<this.range[this.range.length-1]&&i.push("range"),-1!==t.inArray(e.valueOf(),this.range)&&i.push("selected")),i},fill:function(){var a,s=new Date(this.viewDate),n=s.getUTCFullYear(),r=s.getUTCMonth(),h=this.o.startDate!==-(1/0)?this.o.startDate.getUTCFullYear():-(1/0),o=this.o.startDate!==-(1/0)?this.o.startDate.getUTCMonth():-(1/0),d=this.o.endDate!==1/0?this.o.endDate.getUTCFullYear():1/0,l=this.o.endDate!==1/0?this.o.endDate.getUTCMonth():1/0,c=g[this.o.language].today||g.en.today||"",u=g[this.o.language].clear||g.en.clear||"";if(!isNaN(n)&&!isNaN(r)){this.picker.find(".datepicker-days thead .datepicker-switch").text(g[this.o.language].months[r]+" "+(this.o.maxViewMode<2?"":n)),this.picker.find("tfoot .today").text(c).toggle(this.o.todayBtn!==!1),this.picker.find("tfoot .clear").text(u).toggle(this.o.clearBtn!==!1),this.updateNavArrows(),this.fillMonths();var p=i(n,r-1,28),f=D.getDaysInMonth(p.getUTCFullYear(),p.getUTCMonth());p.setUTCDate(f),p.setUTCDate(f-(p.getUTCDay()-this.o.weekStart+7)%7);var v=new Date(p);v.setUTCDate(v.getUTCDate()+42),v=v.valueOf();for(var m,y=[];p.valueOf()<v;){if(p.getUTCDay()===this.o.weekStart&&(y.push("<tr>"),this.o.calendarWeeks)){var w=new Date(+p+(this.o.weekStart-p.getUTCDay()-7)%7*864e5),k=new Date(Number(w)+(11-w.getUTCDay())%7*864e5),C=new Date(Number(C=i(k.getUTCFullYear(),0,1))+(11-C.getUTCDay())%7*864e5),b=(k-C)/864e5/7+1;y.push('<td class="cw">'+b+"</td>")}if(m=this.getClassNames(p),m.push("day"),this.o.beforeShowDay!==t.noop){var T=this.o.beforeShowDay(this._utc_to_local(p));T===e?T={}:"boolean"==typeof T?T={enabled:T}:"string"==typeof T&&(T={classes:T}),T.enabled===!1&&m.push("disabled"),T.classes&&(m=m.concat(T.classes.split(/\s+/))),T.tooltip&&(a=T.tooltip)}m=t.unique(m),y.push('<td class="'+m.join(" ")+'"'+(a?' title="'+a+'"':"")+">"+p.getUTCDate()+"</td>"),a=null,p.getUTCDay()===this.o.weekEnd&&y.push("</tr>"),p.setUTCDate(p.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(y.join(""));var _=this.picker.find(".datepicker-months").find("th:eq(1)").text(this.o.maxViewMode<2?"Months":n).end().find("span").removeClass("active");if(t.each(this.dates,function(t,e){e.getUTCFullYear()===n&&_.eq(e.getUTCMonth()).addClass("active")}),(h>n||n>d)&&_.addClass("disabled"),n===h&&_.slice(0,o).addClass("disabled"),n===d&&_.slice(l+1).addClass("disabled"),this.o.beforeShowMonth!==t.noop){var M=this;t.each(_,function(e,i){if(!t(i).hasClass("disabled")){var a=new Date(n,e,1),s=M.o.beforeShowMonth(a);s===!1&&t(i).addClass("disabled")}})}y="",n=10*parseInt(n/10,10);var U=this.picker.find(".datepicker-years").find("th:eq(1)").text(n+"-"+(n+9)).end().find("td");n-=1;for(var x,F=t.map(this.dates,function(t){return t.getUTCFullYear()}),S=-1;11>S;S++)x=["year"],-1===S?x.push("old"):10===S&&x.push("new"),-1!==t.inArray(n,F)&&x.push("active"),(h>n||n>d)&&x.push("disabled"),y+='<span class="'+x.join(" ")+'">'+n+"</span>",n+=1;U.html(y)}},updateNavArrows:function(){if(this._allow_update){var t=new Date(this.viewDate),e=t.getUTCFullYear(),i=t.getUTCMonth();switch(this.viewMode){case 0:this.o.startDate!==-(1/0)&&e<=this.o.startDate.getUTCFullYear()&&i<=this.o.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==1/0&&e>=this.o.endDate.getUTCFullYear()&&i>=this.o.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 1:case 2:this.o.startDate!==-(1/0)&&e<=this.o.startDate.getUTCFullYear()||this.o.maxViewMode<2?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==1/0&&e>=this.o.endDate.getUTCFullYear()||this.o.maxViewMode<2?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}}},click:function(e){e.preventDefault(),e.stopPropagation();var a,s,n,r=t(e.target).closest("span, td, th");if(1===r.length)switch(r[0].nodeName.toLowerCase()){case"th":switch(r[0].className){case"datepicker-switch":this.showMode(1);break;case"prev":case"next":var h=D.modes[this.viewMode].navStep*("prev"===r[0].className?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,h),this._trigger("changeMonth",this.viewDate);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,h),1===this.viewMode&&this._trigger("changeYear",this.viewDate)}this.fill();break;case"today":var o=new Date;o=i(o.getFullYear(),o.getMonth(),o.getDate(),0,0,0),this.showMode(-2);var d="linked"===this.o.todayBtn?null:"view";this._setDate(o,d);break;case"clear":this.clearDates()}break;case"span":r.hasClass("disabled")||(this.viewDate.setUTCDate(1),r.hasClass("month")?(n=1,s=r.parent().find("span").index(r),a=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(s),this._trigger("changeMonth",this.viewDate),1===this.o.minViewMode?(this._setDate(i(a,s,n)),this.showMode()):this.showMode(-1)):(n=1,s=0,a=parseInt(r.text(),10)||0,this.viewDate.setUTCFullYear(a),this._trigger("changeYear",this.viewDate),2===this.o.minViewMode&&this._setDate(i(a,s,n)),this.showMode(-1)),this.fill());break;case"td":r.hasClass("day")&&!r.hasClass("disabled")&&(n=parseInt(r.text(),10)||1,a=this.viewDate.getUTCFullYear(),s=this.viewDate.getUTCMonth(),r.hasClass("old")?0===s?(s=11,a-=1):s-=1:r.hasClass("new")&&(11===s?(s=0,a+=1):s+=1),this._setDate(i(a,s,n)))}this.picker.is(":visible")&&this._focused_from&&t(this._focused_from).focus(),delete this._focused_from},_toggle_multidate:function(t){var e=this.dates.contains(t);if(t||this.dates.clear(),-1!==e?(this.o.multidate===!0||this.o.multidate>1||this.o.toggleActive)&&this.dates.remove(e):this.o.multidate===!1?(this.dates.clear(),this.dates.push(t)):this.dates.push(t),"number"==typeof this.o.multidate)for(;this.dates.length>this.o.multidate;)this.dates.remove(0)},_setDate:function(t,e){e&&"date"!==e||this._toggle_multidate(t&&new Date(t)),e&&"view"!==e||(this.viewDate=t&&new Date(t)),this.fill(),this.setValue(),e&&"view"===e||this._trigger("changeDate");var i;this.isInput?i=this.element:this.component&&(i=this.element.find("input")),i&&i.change(),!this.o.autoclose||e&&"date"!==e||this.hide()},moveMonth:function(t,i){if(!t)return e;if(!i)return t;var a,s,n=new Date(t.valueOf()),r=n.getUTCDate(),h=n.getUTCMonth(),o=Math.abs(i);if(i=i>0?1:-1,1===o)s=-1===i?function(){return n.getUTCMonth()===h}:function(){return n.getUTCMonth()!==a},a=h+i,n.setUTCMonth(a),(0>a||a>11)&&(a=(a+12)%12);else{for(var d=0;o>d;d++)n=this.moveMonth(n,i);a=n.getUTCMonth(),n.setUTCDate(r),s=function(){return a!==n.getUTCMonth()}}for(;s();)n.setUTCDate(--r),n.setUTCMonth(a);return n},moveYear:function(t,e){return this.moveMonth(t,12*e)},dateWithinRange:function(t){return t>=this.o.startDate&&t<=this.o.endDate},keydown:function(t){if(!this.picker.is(":visible"))return void((40===t.keyCode||27===t.keyCode)&&this.show());var e,i,s,n=!1,r=this.focusDate||this.viewDate;switch(t.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide(),t.preventDefault();break;case 37:case 39:if(!this.o.keyboardNavigation)break;e=37===t.keyCode?-1:1,t.ctrlKey?(i=this.moveYear(this.dates.get(-1)||a(),e),s=this.moveYear(r,e),this._trigger("changeYear",this.viewDate)):t.shiftKey?(i=this.moveMonth(this.dates.get(-1)||a(),e),s=this.moveMonth(r,e),this._trigger("changeMonth",this.viewDate)):(i=new Date(this.dates.get(-1)||a()),i.setUTCDate(i.getUTCDate()+e),s=new Date(r),s.setUTCDate(r.getUTCDate()+e)),this.dateWithinRange(s)&&(this.focusDate=this.viewDate=s,this.setValue(),this.fill(),t.preventDefault());break;case 38:case 40:if(!this.o.keyboardNavigation)break;e=38===t.keyCode?-1:1,t.ctrlKey?(i=this.moveYear(this.dates.get(-1)||a(),e),s=this.moveYear(r,e),this._trigger("changeYear",this.viewDate)):t.shiftKey?(i=this.moveMonth(this.dates.get(-1)||a(),e),s=this.moveMonth(r,e),this._trigger("changeMonth",this.viewDate)):(i=new Date(this.dates.get(-1)||a()),i.setUTCDate(i.getUTCDate()+7*e),s=new Date(r),s.setUTCDate(r.getUTCDate()+7*e)),this.dateWithinRange(s)&&(this.focusDate=this.viewDate=s,this.setValue(),this.fill(),t.preventDefault());break;case 32:break;case 13:r=this.focusDate||this.dates.get(-1)||this.viewDate,this.o.keyboardNavigation&&(this._toggle_multidate(r),n=!0),this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.setValue(),this.fill(),this.picker.is(":visible")&&(t.preventDefault(),"function"==typeof t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,this.o.autoclose&&this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}if(n){this.dates.length?this._trigger("changeDate"):this._trigger("clearDate");var h;this.isInput?h=this.element:this.component&&(h=this.element.find("input")),h&&h.change()}},showMode:function(t){t&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(this.o.maxViewMode,this.viewMode+t))),this.picker.children("div").hide().filter(".datepicker-"+D.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()}};var l=function(e,i){this.element=t(e),this.inputs=t.map(i.inputs,function(t){return t.jquery?t[0]:t}),delete i.inputs,u.call(t(this.inputs),i).on("changeDate",t.proxy(this.dateUpdated,this)),this.pickers=t.map(this.inputs,function(e){return t(e).data("datepicker")}),this.updateDates()};l.prototype={updateDates:function(){this.dates=t.map(this.pickers,function(t){return t.getUTCDate()}),this.updateRanges()},updateRanges:function(){var e=t.map(this.dates,function(t){return t.valueOf()});t.each(this.pickers,function(t,i){i.setRange(e)})},dateUpdated:function(e){if(!this.updating){this.updating=!0;var i=t(e.target).data("datepicker"),a=i.getUTCDate(),s=t.inArray(e.target,this.inputs),n=s-1,r=s+1,h=this.inputs.length;if(-1!==s){if(t.each(this.pickers,function(t,e){e.getUTCDate()||e.setUTCDate(a)}),a<this.dates[n])for(;n>=0&&a<this.dates[n];)this.pickers[n--].setUTCDate(a);else if(a>this.dates[r])for(;h>r&&a>this.dates[r];)this.pickers[r++].setUTCDate(a);this.updateDates(),delete this.updating}}},remove:function(){t.map(this.pickers,function(t){t.remove()}),delete this.element.data().datepicker}};var c=t.fn.datepicker,u=function(i){var a=Array.apply(null,arguments);a.shift();var s;return this.each(function(){var n=t(this),o=n.data("datepicker"),c="object"==typeof i&&i;if(!o){var u=r(this,"date"),f=t.extend({},p,u,c),g=h(f.language),D=t.extend({},p,g,u,c);if(n.hasClass("input-daterange")||D.inputs){var v={inputs:D.inputs||n.find("input").toArray()};n.data("datepicker",o=new l(this,t.extend(D,v)))}else n.data("datepicker",o=new d(this,D))}return"string"==typeof i&&"function"==typeof o[i]&&(s=o[i].apply(o,a),s!==e)?!1:void 0}),s!==e?s:this};t.fn.datepicker=u;var p=t.fn.datepicker.defaults={autoclose:!1,beforeShowDay:t.noop,beforeShowMonth:t.noop,calendarWeeks:!1,clearBtn:!1,toggleActive:!1,daysOfWeekDisabled:[],daysOfWeekHighlighted:[],datesDisabled:[],endDate:1/0,forceParse:!0,format:"mm/dd/yyyy",keyboardNavigation:!0,language:"en",minViewMode:0,maxViewMode:2,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-(1/0),startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0,disableTouchKeyboard:!1,enableOnReadonly:!0,container:".w1",immediateUpdates:!1},f=t.fn.datepicker.locale_opts=["format","rtl","weekStart"];t.fn.datepicker.Constructor=d;var g=t.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear"}},D={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(t){return t%4===0&&t%100!==0||t%400===0},getDaysInMonth:function(t,e){return[31,D.isLeapYear(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(t){var e=t.replace(this.validParts,"\x00").split("\x00"),i=t.match(this.validParts);if(!e||!e.length||!i||0===i.length)throw new Error("Invalid date format.");return{separators:e,parts:i}},parseDate:function(a,s,n){function r(){var t=this.slice(0,u[l].length),e=u[l].slice(0,t.length);return t.toLowerCase()===e.toLowerCase()}if(!a)return e;if(a instanceof Date)return a;"string"==typeof s&&(s=D.parseFormat(s));var h,o,l,c=/([\-+]\d+)([dmwy])/,u=a.match(/([\-+]\d+)([dmwy])/g);if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(a)){for(a=new Date,l=0;l<u.length;l++)switch(h=c.exec(u[l]),o=parseInt(h[1]),h[2]){case"d":a.setUTCDate(a.getUTCDate()+o);break;case"m":a=d.prototype.moveMonth.call(d.prototype,a,o);break;case"w":a.setUTCDate(a.getUTCDate()+7*o);break;case"y":a=d.prototype.moveYear.call(d.prototype,a,o)}return i(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),0,0,0)}u=a&&a.match(this.nonpunctuation)||[],a=new Date;var p,f,v={},m=["yyyy","yy","M","MM","m","mm","d","dd"],y={yyyy:function(t,e){return t.setUTCFullYear(e)},yy:function(t,e){return t.setUTCFullYear(2e3+e)},m:function(t,e){if(isNaN(t))return t;for(e-=1;0>e;)e+=12;for(e%=12,t.setUTCMonth(e);t.getUTCMonth()!==e;)t.setUTCDate(t.getUTCDate()-1);return t},d:function(t,e){return t.setUTCDate(e)}};y.M=y.MM=y.mm=y.m,y.dd=y.d,a=i(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0);var w=s.parts.slice();if(u.length!==w.length&&(w=t(w).filter(function(e,i){return-1!==t.inArray(i,m)}).toArray()),u.length===w.length){var k;for(l=0,k=w.length;k>l;l++){if(p=parseInt(u[l],10),h=w[l],isNaN(p))switch(h){case"MM":f=t(g[n].months).filter(r),p=t.inArray(f[0],g[n].months)+1;break;case"M":f=t(g[n].monthsShort).filter(r),p=t.inArray(f[0],g[n].monthsShort)+1}v[h]=p}var C,b;for(l=0;l<m.length;l++)b=m[l],b in v&&!isNaN(v[b])&&(C=new Date(a),y[b](C,v[b]),isNaN(C)||(a=C))}return a},formatDate:function(e,i,a){if(!e)return"";"string"==typeof i&&(i=D.parseFormat(i));var s={d:e.getUTCDate(),D:g[a].daysShort[e.getUTCDay()],DD:g[a].days[e.getUTCDay()],m:e.getUTCMonth()+1,M:g[a].monthsShort[e.getUTCMonth()],MM:g[a].months[e.getUTCMonth()],yy:e.getUTCFullYear().toString().substring(2),yyyy:e.getUTCFullYear()};s.dd=(s.d<10?"0":"")+s.d,s.mm=(s.m<10?"0":"")+s.m,e=[];for(var n=t.extend([],i.separators),r=0,h=i.parts.length;h>=r;r++)n.length&&e.push(n.shift()),e.push(s[i.parts[r]]);return e.join("")},headTemplate:'<thead><tr><th class="prev"><i class="glyphicon glyphicon-chevron-left"></i></th><th colspan="5" class="datepicker-switch"></th><th class="next"><i class="glyphicon glyphicon-chevron-right"></i></th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};D.template='<div class="datepicker"><div class="datepicker-days"><table class=" table-condensed">'+D.headTemplate+"<tbody></tbody>"+D.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+D.headTemplate+D.contTemplate+D.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+D.headTemplate+D.contTemplate+D.footTemplate+"</table></div></div>",t.fn.datepicker.DPGlobal=D,t.fn.datepicker.noConflict=function(){return t.fn.datepicker=c,this},t.fn.datepicker.version="1.4.1-dev",t(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(e){var i=t(this);i.data("datepicker")||(e.preventDefault(),u.call(i,"show"))}),t(function(){u.call(t('[data-provide="datepicker-inline"]'))})});;trkbook.controller("LoginController",function($scope,$window,$rootScope,AUTH_EVENTS,AuthService){$scope.credentials={username:"",password:"",rememberme:false,ajaxRequest:true};$scope.loginReqState=false;$scope.login=function(credentials){if(!checkCookie()){error=new Object;error.cookie=["Cookies are disabled in your browser. Please enable and re-login."];console.log(error);$scope.setLoginError(error);return false}$scope.loginReqState=true;AuthService.login(credentials).then(function(data){if(data.status){if(data.redirect){var curl=$window.location;if(curl&&curl.hash==="#/group"){$window.location.reload()}else{$window.location=data.redirectUrl}}}else{$scope.loginReqState=false;if(data.verify){$scope.emailVerify.message=data.message;$scope.emailVerify.email=data.email}else{$scope.setLoginError(data.error)}}},function(error){})};function checkCookie(){var cookieEnabled=navigator.cookieEnabled?true:false;if(typeof navigator.cookieEnabled=="undefined"&&!cookieEnabled){document.cookie="testcookie";cookieEnabled=document.cookie.indexOf("testcookie")!=-1?true:false}return cookieEnabled?true:false}});;trkbook.controller("SignupController",function($scope,$rootScope,AUTH_EVENTS,AuthService){$scope.credentials={username:"",confirmemail:"",password:"",fullname:"",country:"",verifypassword:""};$scope.signup=function(credentials){if($scope.credentials.confirmemail!=""){return false}else{AuthService.registration(credentials).then(function(data){if(data.status){if(data.verify){$scope.emailVerify.message=data.message;$scope.emailVerify.email=data.email;$("#loginTabLink").trigger("click")}$scope.credentials={username:"",password:"",fullname:"",verifypassword:""}}else{$scope.setSignupError(data.error)}},function(){})}}});;trkbook.factory("AuthService",function($http,$window,Session){var authService={};authService.login=function(credentials){return $http.post($window.baseUrl+"/user/login",credentials).then(function(res){return res.data})};authService.registration=function(credentials){return $http.post($window.baseUrl+"/user/registration",credentials).then(function(res){return res.data})};authService.verifyKey=function(credentials){return $http.post($window.baseUrl+"/user/activation",credentials).then(function(res){return res.data})};authService.resendKey=function(credentials){return $http.post($window.baseUrl+"/user/activation/resendkey",credentials).then(function(res){return res.data})};authService.isAuthenticated=function(){return!!Session.userId};authService.isAuthorized=function(authorizedRoles){if(!angular.isArray(authorizedRoles)){authorizedRoles=[authorizedRoles]}return authService.isAuthenticated()&&authorizedRoles.indexOf(Session.userRole)!==-1};return authService});;trkbook.service("Session",function(){this.create=function(sessionId,userId,userRole){this.id=sessionId;this.userId=userId;this.userRole=userRole};this.destroy=function(){this.id=null;this.userId=null;this.userRole=null};return this});;trkbook.service("googlemapservice",function($http,$q,$window){var self=this;var zoomLevelSingleMap=12;var zoomLevelPolyMap=null;var initialize=function(mapId,searchBoxId,isNotDestLatitude){zoomLevelPolyMap=null;self.mapOptions={};self.mapId=mapId;self.lat=undefined;self.lng=undefined;self.map=undefined;self.searchBoxId=searchBoxId?searchBoxId:false;self.isDestLatitude=!isNotDestLatitude;self.zoomSize=10;if(isNotDestLatitude)self.zoomSize=6;self.infowindow=new google.maps.InfoWindow({});self.bounds=new google.maps.LatLngBounds;self.marker;self.centerPoint=null;self.markerIcon=$window.baseUrl+"/themes/global/resources/images/bookmundi-pin.png";self.mapStyles=getStyles()};var setLatLngInput=function(){if(document.getElementById("latitudeInp"))document.getElementById("latitudeInp").value=self.lat;if(document.getElementById("longitudeInp"))document.getElementById("longitudeInp").value=self.lng};var resetSingleMap=function(plotInfos){var element=document.getElementById(plotInfos.mapId);if(element){element.style.width="380px";element.style.height="160px"}viewSingleMap(plotInfos)};var viewSingleMap=function(plotInfos){var latLng=new google.maps.LatLng(plotInfos.lat,plotInfos.lng);var mapOptions={zoom:plotInfos.isStepSeven?zoomLevelSingleMap:12,center:latLng,mapTypeId:google.maps.MapTypeId.ROADMAP,fullscreenControl:false,styles:getStylesSimple()};var singleMap=new google.maps.Map(document.getElementById(plotInfos.mapId),mapOptions);google.maps.event.trigger(singleMap,"resize");var marker=new google.maps.Marker({position:latLng,map:singleMap,draggable:false,optimized:false,icon:$window.baseUrl+"/themes/global/resources/images/bookmundi-pin.png"});var infowindow=new google.maps.InfoWindow({});google.maps.event.addListener(marker,"click",function(){var location=plotInfos.name.charAt(0).toUpperCase()+plotInfos.name.slice(1);infowindow.setContent("<div><strong>"+location+'</strong><br><span style="font-size:9px">(Approximate Starting Point)</span></div>');infowindow.open(singleMap,this)});google.maps.event.addListener(singleMap,"zoom_changed",function(){var zoomLevel=singleMap.getZoom();zoomLevelSingleMap=zoomLevel})};var viewMap=function(lat,lng){var latLng=new google.maps.LatLng(lat,lng);self.lat=lat;self.lng=lng;self.mapOptions={zoom:self.zoomSize,center:latLng,mapTypeId:google.maps.MapTypeId.ROADMAP,styles:self.mapStyles};self.map=new google.maps.Map(document.getElementById(self.mapId),self.mapOptions);self.marker=new google.maps.Marker({position:latLng,map:self.map,optimized:false,icon:self.markerIcon});listenerForDragMarker();getExactClickedLocation(latLng);setLatLngInput();if(self.searchBoxId){populateSearchBox();listenEventForSearches()}listenEventForClicks();findLatLongOnBtnPressEvent()};var getLatLng=function(){var obj={};obj.lat=document.getElementById("latitudeInp").value;obj.lng=document.getElementById("longitudeInp").value;return obj};var viewPolyLineMap=function(mapInfo){if(!!mapInfo.details&&mapInfo.details.length>1){var mapOptions={mapTypeId:google.maps.MapTypeId.ROADMAP,styles:getStylesSimple(mapInfo.size),fullscreenControl:false}}else{var mapOptions={zoom:12,mapTypeId:google.maps.MapTypeId.ROADMAP,styles:getStylesSimple(mapInfo.size),fullscreenControl:false}}var lineSymbol={path:google.maps.SymbolPath.CIRCLE,scale:mapInfo.size?1:4,fillColor:"#1c98f7",fillOpacity:1,strokeWeight:0};var padding=null;self.bounds=new google.maps.LatLngBounds;mapInfo.coordinates.forEach(function(n){self.bounds.extend(n)});initMap(mapOptions);self.centerPoint=self.bounds.getCenter();self.map.setCenter(self.bounds.getCenter());if(!!mapInfo.details&&mapInfo.details.length>1){self.map.fitBounds(self.bounds)}if(mapInfo.size){padding={top:10,right:8,left:8,bottom:6}}var itineraryPath=new google.maps.Polyline({path:mapInfo.coordinates,geodesic:true,strokeColor:"#3eb368",strokeOpacity:1,strokeWeight:2,icons:[{icon:lineSymbol,offset:"100%"}]});animateCircle(itineraryPath);setMarkerAndLabels(mapInfo);itineraryPath.setMap(self.map)};var setMarkerAndLabels=function(mapInfo){var marker=[];var latlng=[];for(var i=0;i<mapInfo.coordinates.length;i++){(function(i){var _coordinate=mapInfo.coordinates[i];marker[i]=new google.maps.Marker({draggable:false,map:self.map,optimized:false});marker[i].setPosition(_coordinate);latlng[i]=_coordinate;setMarkerIcon(marker[i],i,mapInfo);google.maps.event.addListener(marker[i],"click",function(){var markerText=mapInfo.details[i].marker;var day=mapInfo.details[i].day;var text="";if(!mapInfo.is_api)text=day+"<br> <div> <strong> "+markerText+"</strong></div>";else text="<div><strong> "+markerText+"</strong></div>";self.infowindow.setContent(text);self.infowindow.open(self.map,marker[i])})})(i)}};var setMarkerIcon=function(marker,index,mapInfo){var icon=null;if(index==0){icon={url:$window.baseUrl+"/themes/global/resources/images/map-markers/pointer-blue-sm.png",anchor:new google.maps.Point(8,22)}}else if(index==mapInfo.coordinates.length-1){if(mapInfo.details[0].latitude!=mapInfo.details[index].latitude&&mapInfo.details[0].longitude!=mapInfo.details[index].longitude)icon={url:$window.baseUrl+"/themes/global/resources/images/map-markers/pointer-red-sm.png",anchor:new google.maps.Point(8,22)};else icon={url:$window.baseUrl+"/themes/global/resources/images/map-markers/t.png",anchor:new google.maps.Point(0,0)}}else{if(mapInfo.details[0].latitude!=mapInfo.details[index].latitude&&mapInfo.details[0].longitude!=mapInfo.details[index].longitude&&(mapInfo.details[mapInfo.details.length-1].latitude!=mapInfo.details[index].latitude&&mapInfo.details[mapInfo.details.length-1].longitude!=mapInfo.details[index].longitude))icon={url:$window.baseUrl+"/themes/global/resources/images/map-markers/round.png",anchor:new google.maps.Point(6,6)};else icon={url:$window.baseUrl+"/themes/global/resources/images/map-markers/t.png",anchor:new google.maps.Point(0,0)}}marker.setIcon(icon)};var drawPolyLine=function(pathCoordinates,destns,duplicates,latlngsObj,names,differentFirstLocation,markerType,size,lineType,lenTwoMarker,showLabel){$("#map-search").remove();self.pathCoordinates=pathCoordinates;self.destns=destns;self.duplicates=duplicates;self.latlngsObj=latlngsObj;self.names=names;self.differentFirstLocation=differentFirstLocation;self.markerType=markerType;self.centerPoint=bounds.getCenter();self.map.setCenter(bounds.getCenter());var lineSymbol={path:google.maps.SymbolPath.CIRCLE,scale:size?1:4,fillColor:"#1c98f7",fillOpacity:1,strokeWeight:0};var bounds=new google.maps.LatLngBounds;pathCoordinates.forEach(function(n){bounds.extend(n)});self.bounds=bounds;var mapOptions={mapTypeId:google.maps.MapTypeId.ROADMAP,styles:getStylesSimple(size),fullscreenControl:false};initMap(mapOptions);self.centerPoint=bounds.getCenter();self.map.setCenter(bounds.getCenter());var padding;if(size){padding={top:10,right:8,left:8,bottom:6}}if(lineType&&size){padding={top:10,right:5,left:5,bottom:6}}self.map.fitBounds(bounds);setMarkerPolyLine(pathCoordinates,duplicates,latlngsObj,names,differentFirstLocation,markerType,lineType,lenTwoMarker,showLabel);if(!lineType){var itineraryPath=new google.maps.Polyline({path:pathCoordinates,geodesic:true,strokeColor:"#3eb368",strokeOpacity:1,strokeWeight:2,icons:[{icon:lineSymbol,offset:"100%"}]})}else{var itineraryPath=new google.maps.Polyline({path:pathCoordinates,strokeColor:"#3eb368",strokeOpacity:0,icons:[{icon:{path:"M 0,-1 0,1",strokeOpacity:1,scale:4},offset:"5px",repeat:"20px"}]})}if(!lineType)animateCircle(itineraryPath);itineraryPath.setMap(self.map)};var resetView=function(resetView,mapDetails){var element=document.getElementById("map");if(element){element.style.width="380px";element.style.height="160px";var mapOptions={mapTypeId:google.maps.MapTypeId.ROADMAP,styles:getStylesSimple(),fullscreenControl:false};self.map=new google.maps.Map(document.getElementById("map"),mapOptions);var typeOfLine=null;if(resetView)typeOfLine="dash";viewPolyLineMap(mapDetails)}};var viewMapInDiv=function(lat,lng){var latLng=new google.maps.LatLng(lat,lng);var mapOptions={zoom:self.zoomSize,center:latLng,mapTypeId:google.maps.MapTypeId.ROADMAP,styles:getStylesSimple()};self.mapDiv=new google.maps.Map(document.getElementById("mapse"),mapOptions);google.maps.event.trigger(self.mapDiv,"resize");var marker=new google.maps.Marker({position:latLng,map:self.mapDiv,optimized:false,icon:$window.baseUrl+"/themes/global/resources/images/bookmundi-pin.png"});google.maps.event.addListener(marker,"click",function(){getExactClickedLocation(latLng,marker)})};function getStylesSimple(size){return[{elementType:"labels.text",stylers:[{saturation:-5},{lightness:-100},{visibility:"simplified"}]},{elementType:"labels.text.fill",stylers:[{color:"#aca595"},{visibility:"simplified"}]},{elementType:"labels.text.stroke",stylers:[{visibility:"simplified"}]},{featureType:"administrative",stylers:[{color:"#f2f2f2"}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#c5c5c5"}]},{featureType:"administrative",elementType:"labels.text",stylers:[{color:"#f2f2f2"}]},{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#807f7f"}]},{featureType:"landscape",stylers:[{color:"#f2f2f2"}]},{featureType:"landscape",elementType:"geometry.fill",stylers:[{color:"#e8e8e8"}]},{featureType:"landscape.natural",elementType:"labels.text",stylers:[{color:"#959595"}]},{featureType:"landscape.natural",elementType:"labels.icon",stylers:[{color:"#d8d8d8"},{visibility:"simplified"}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"road",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"simplified"}]},{featureType:"road.highway",stylers:[{visibility:"simplified"}]},{featureType:"water",stylers:[{color:"#f7f7f7"}]},{featureType:"water",elementType:"labels.text",stylers:[{visibility:"off"}]}]}function getStyles(){return[{elementType:"labels.text",stylers:[{saturation:-5},{lightness:-100},{visibility:"on"}]},{elementType:"labels.text.fill",stylers:[{color:"#aca595"},{visibility:"simplified"}]},{elementType:"labels.text.stroke",stylers:[{visibility:"simplified"}]},{featureType:"administrative",stylers:[{color:"#f2f2f2"}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#999999"}]},{featureType:"administrative",elementType:"labels.text",stylers:[{color:"#f2f2f2"}]},{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#959595"}]},{featureType:"landscape",stylers:[{color:"#f2f2f2"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"poi.business",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"administrative.neighborhood",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"geometry.fill",stylers:[{color:"#ececec"}]},{featureType:"road",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"water",stylers:[{color:"#f5f5f5"}]}]}function animateCircle(line){var count=0;window.setInterval(function(){count=(count+1)%200;var icons=line.get("icons");icons[0].offset=count/2+"%";line.set("icons",icons)},50)}function initializePolyLine(){var obj={};obj.numDeltas=100;obj.delay=10;obj.i=0;obj.deltaLat;obj.deltaLng;return obj}function findLatLongOnBtnPressEvent(){if(document.getElementById("btnLngLatFind"))document.getElementById("btnLngLatFind").addEventListener("click",function(){if(document.getElementById("latitudeInp"))self.lat=document.getElementById("latitudeInp").value;if(document.getElementById("longitudeInp"))self.lng=document.getElementById("longitudeInp").value;setMarkerLatLongInput()})}function initMap(mapOptions){self.map=new google.maps.Map(document.getElementById(self.mapId),mapOptions)}function populateSearchBox(){var elem=document.getElementById(self.searchBoxId);if(elem==null){$("<input>").attr({type:"text",id:"map-search",placeholder:"Search Box"}).appendTo("#map-html-canvas")}self.searchBoxInstance=new google.maps.places.SearchBox(document.getElementById(self.searchBoxId))}function listenEventForSearches(){self.map.controls[google.maps.ControlPosition.TOP_CENTER].push(document.getElementById(self.searchBoxId));google.maps.event.addListener(self.searchBoxInstance,"places_changed",function(){self.searchBoxInstance.set("map",null);var places=self.searchBoxInstance.getPlaces();var i,place;for(i=0;place=places[i];i++){setMarkerWhileSearch(place)}self.map.fitBounds(self.bounds);self.searchBoxInstance.set("map",self.map);self.map.setZoom(Math.min(self.map.getZoom(),12))})}function listenEventForClicks(){google.maps.event.addListener(self.map,"click",function(event){setMarkerOnClick(event);self.lat=event.latLng.lat();self.lng=event.latLng.lng();getExactClickedLocation(event.latLng)})}function listenerForDragMarker(){function inner(event){self.lat=event.latLng.lat();self.lng=event.latLng.lng();setLatLngInput()}self.marker.addListener("drag",function(event){inner(event)});self.marker.addListener("dragend",function(event){inner(event)})}function setMarkerWhileSearch(place){if(self.marker&&self.marker.setMap){self.marker.setMap(null)}self.marker=new google.maps.Marker({position:place.geometry.location,draggable:false,optimized:false,map:self.map,icon:self.markerIcon});self.marker.bindTo(self.mapId,self.searchBoxInstance,self.mapId);google.maps.event.addListener(self.marker,"map_changed",function(){if(!this.getMap()){this.unbindAll()}});self.bounds.extend(place.geometry.location);listenerForDragMarker();self.lat=place.geometry.location.lat();self.lng=place.geometry.location.lng();setLatLngInput();viewLocationDetailOnMarkerClickWithEvent(place)}function setMarkerPolyLine(latlngs,duplicates,latlngsObj,names,differentFirstLocation,markerType,lineType,lenTwoMarker,showLabel){var geocoder=new google.maps.Geocoder;self.tempLatlngs=latlngs;self.marker=[];self.latlng=[];for(var i=0;i<latlngs.length;i++){(function(i){self.marker[i]=new google.maps.Marker({draggable:false,map:self.map,optimized:false});setLabelForMarkers(i,duplicates,latlngsObj[i],self.marker[i],differentFirstLocation,markerType);self.marker[i].setPosition(latlngs[i]);self.latlng[i]=latlngs[i];google.maps.event.addListener(self.marker[i],"click",function(){var name=names&&names[i]?names[i]:null;if(!showLabel){var text="<strong>"+name+"</strong>";self.infowindow.setContent(text);self.infowindow.open(self.map,self.marker[i])}else{if(!lineType){if(markerType==1){setMarkerLabelInNoMarkerType(differentFirstLocation,i,duplicates,names[i],latlngsObj)}else{getExactClickedLocation(self.latlng[i],self.marker[i],name)}}else{if(i==0){text="Day 1";text+="<br> <div><strong>"+name+"</strong>"}else{text="Day "+lenTwoMarker;text+="<br> <div><strong>"+name+"</strong>"}self.infowindow.setContent(text);self.infowindow.open(self.map,self.marker[i])}}})})(i)}}function setMarkerLabelInNoMarkerType(differentFirstLocation,k,duplicates,name,latlngsObj){if(latlngsObj&&latlngsObj[k]){var lat=latlngsObj[k][0];var lng=latlngsObj[k][1]}else{var lat=self.latlng[k].lat();var lng=self.latlng[k].lng()}var prop=lat+"-"+lng;var arrDup=getConsecutiveMarkers(duplicates[prop]);var text1="";var text2="";if(arrDup){var sequence=arrDup["sequence"];var nonsequence=arrDup["notsequence"];if(sequence&&sequence[0]){for(var i=0;i<sequence.length;i++){if(differentFirstLocation){if(sequence[i][0]-1==0&&sequence[i][sequence[i].length-1]-1!=1){sequence[i][0]=2;text1+=sequence[i][0]-1+"-"+(sequence[i][sequence[i].length-1]-1)}else if(sequence[i][0]-1==0&&sequence[i][sequence[i].length-1]-1==1){text1="1"}else text1+=sequence[i][0]-1+"-"+(sequence[i][sequence[i].length-1]-1)}else{text1+=sequence[i][0]+"-"+sequence[i][sequence[i].length-1]}if(sequence.length>1&&i!=sequence.length-1)text1+=","}}if(nonsequence&&nonsequence[0]){nonsequence.sort(function(a,b){return a-b});var text2="";if(differentFirstLocation){text2=nonsequence.map(function(e){return e-1>0?e-1:1}).join(",")}else{text2=text2+nonsequence.join(",")}}if(sequence&&sequence[0]&&sequence[0][0]&&nonsequence&&nonsequence[0]&&sequence[0][0]<nonsequence[0]){text=text1+", "+text2}else if(sequence&&sequence[0]&&sequence[0][0]&&(!nonsequence||nonsequence&&!nonsequence[0])){text=text1}else if(sequence&&sequence[0]&&sequence[0][0]&&nonsequence&&nonsequence[0]&&sequence[0][0]>nonsequence[0]){text=text2+", "+text1}else if(nonsequence&&nonsequence[0]&&(!sequence||sequence&&!sequence[0]||sequence&&sequence[0]&&!sequence[0][0])){text=text2}else text=duplicates[prop].join(",")}else{var text=k+1;if(differentFirstLocation&&k>=1){text=k}}text="Day "+text;text+="<br> <div><strong>"+name+"</strong>";self.infowindow.setContent(text);self.infowindow.open(self.map,self.marker[k])}function setLabelForMarkers(i,duplicates,latlngs,marker,differentFirstLocation,markerType){if(duplicates&&!isEmpty(duplicates)&&latlngs){setLabelForMarkersWithOverride(i,latlngs,marker,duplicates,differentFirstLocation,markerType)}else{setLabelForMarkersWithNoOverride(i,latlngs,marker,duplicates,differentFirstLocation,markerType)}}function isEmpty(obj){for(var prop in obj){if(obj.hasOwnProperty(prop))return false}return true}function includesCustom(container,value){var returnValue=false;var pos=container.indexOf(value);if(pos>=0){returnValue=true}return returnValue}function setLabelForMarkersWithOverride(i,latlngs,marker,duplicates,differentFirstLocation,markerType){var lat=latlngs[0];var lng=latlngs[1];var prop=lat+"-"+lng;if(duplicates[prop]){var arrDup=getConsecutiveMarkers(duplicates[prop]);var sequence=arrDup["sequence"];var nonsequence=arrDup["notsequence"];var text1="";var text2="";if(sequence&&sequence[0]){for(var i=0;i<sequence.length;i++){if(differentFirstLocation){text1+=sequence[i][0]-1+"-"+(sequence[i][sequence[i].length-1]-1)}else text1+=sequence[i][0]+"-"+sequence[i][sequence[i].length-1]}}if(nonsequence&&nonsequence[0]){nonsequence.sort(function(a,b){return a-b});var text2="";if(differentFirstLocation){text2=nonsequence.map(function(e){return e-1}).join(",")}else{text2=text2+nonsequence.join(",")}}if(includesCustom(text1,"0-")&&!includesCustom(text1,"0-1")){text1=text1.replace("0-","1-")}else if(includesCustom(text1,"0-1"))text1=text1.replace("0-1","1");if(includesCustom(text2,"0,")){text2=text2.replace("0,","1,")}if(sequence&&sequence[0]&&sequence[0][0]&&nonsequence&&nonsequence[0]&&sequence[0][0]<nonsequence[0]){text=text1+", "+text2}else if(sequence&&sequence[0]&&sequence[0][0]&&(!nonsequence||nonsequence&&!nonsequence[0])){text=text1}else if(sequence&&sequence[0]&&sequence[0][0]&&nonsequence&&nonsequence[0]&&sequence[0][0]>nonsequence[0]){text=text2+", "+text1}else if(nonsequence&&nonsequence[0]&&(!sequence||sequence&&!sequence[0]||sequence&&sequence[0]&&!sequence[0][0])){text=text2}else text=duplicates[prop].join(",");if(markerType==0){var label={text:text,color:"#ffffff",fontSize:"12px"};var icon={url:$window.baseUrl+"/themes/global/resources/images/map-markers/marker-round-"+duplicates[prop].length+".png",anchor:new google.maps.Point(13,13)};if(duplicates[prop].indexOf(1)!=-1||duplicates[prop].indexOf(1)!=-1&&duplicates[prop].indexOf(self.tempLatlngs.length)!=-1){icon={url:$window.baseUrl+"/themes/global/resources/images/map-markers/pointer-blue-"+duplicates[prop].length+".png",anchor:new google.maps.Point(duplicates[prop].length==2?18:duplicates[prop].length==3?23:28,48)};label.color="#1c98f7"}else if(duplicates[prop].indexOf(self.tempLatlngs.length)!=-1){icon={url:$window.baseUrl+"/themes/global/resources/images/map-markers/pointer-red-"+duplicates[prop].length+".png",anchor:new google.maps.Point(duplicates[prop].length==2?18:duplicates[prop].length==3?23:28,48)};label.color="#da5869"}}else{if(i===0){icon={url:$window.baseUrl+"/themes/global/resources/images/map-markers/pointer-blue-sm.png",anchor:new google.maps.Point(8,22)}}else if(duplicates[prop].indexOf(1)!=-1||duplicates[prop].indexOf(1)!=-1&&duplicates[prop].indexOf(self.tempLatlngs.length)!=-1){icon={url:$window.baseUrl+"/themes/global/resources/images/map-markers/pointer-blue-sm.png",anchor:new google.maps.Point(8,22)}}else if(i==self.tempLatlngs.length-1){icon={url:$window.baseUrl+"/themes/global/resources/images/map-markers/pointer-red-sm.png",anchor:new google.maps.Point(8,22)}}else if(duplicates[prop].indexOf(self.tempLatlngs.length)!=-1){icon={url:$window.baseUrl+"/themes/global/resources/images/map-markers/pointer-red-sm.png",anchor:new google.maps.Point(8,22)}}else{if(!duplicates[prop].indexOf(self.tempLatlngs.length)!=-1){icon={url:$window.baseUrl+"/themes/global/resources/images/map-markers/round.png",anchor:new google.maps.Point(6,6)}}else{icon={url:$window.baseUrl+"/themes/global/resources/images/map-markers/t.png",anchor:new google.maps.Point(0,0)}}}label={}}marker.setIcon(icon);if(markerType==0&&label.text){marker.setLabel(label)}}else{setLabelForMarkersWithNoOverride(i,latlngs,marker,duplicates,differentFirstLocation,markerType)}}function setLabelForMarkersWithNoOverride(i,latlngs,marker,duplicates,differentFirstLocation,markerType){var text=i+1;var icon={url:$window.baseUrl+"/themes/global/resources/images/map-markers/marker-round.png",anchor:new google.maps.Point(13,13)};if(differentFirstLocation&&i>=1){text=i}var label={text:text+"",color:"#ffffff",fontWeight:"500",fontSize:"12px"};if(markerType==1){icon={url:$window.baseUrl+"/themes/global/resources/images/map-markers/round.png",anchor:new google.maps.Point(6,6)};label={};if(i===0){icon={url:$window.baseUrl+"/themes/global/resources/images/map-markers/pointer-blue-sm.png",anchor:new google.maps.Point(8,22)}}else if(i==self.tempLatlngs.length-1){icon={url:$window.baseUrl+"/themes/global/resources/images/map-markers/pointer-red-sm.png",anchor:new google.maps.Point(8,22)}}}else{if(i===0){if(differentFirstLocation){icon={url:$window.baseUrl+"/themes/global/resources/images/map-markers/dest-flag.png",anchor:new google.maps.Point(12,35)}}else{icon={url:$window.baseUrl+"/themes/global/resources/images/map-markers/pointer-blue.png",anchor:new google.maps.Point(12,48)}}label={text:i+1+"",color:"#1c98f7",fontWeight:"bold",fontSize:"13px"};if(differentFirstLocation)label={}}else if(!differentFirstLocation&&i==self.tempLatlngs.length-1){icon={url:$window.baseUrl+"/themes/global/resources/images/map-markers/pointer-red.png",anchor:new google.maps.Point(12,48)};label={text:i+1+"",color:"#da5869",fontWeight:"bold",fontSize:"13px"}}else if(differentFirstLocation&&i==self.tempLatlngs.length-1){icon={url:$window.baseUrl+"/themes/global/resources/images/map-markers/pointer-red.png",anchor:new google.maps.Point(12,48)};label={text:i+"",color:"#da5869",fontWeight:"bold",fontSize:"13px"}}}marker.setIcon(icon);if(markerType==0&&label.text)marker.setLabel(label)}function setMarkerOnClick(event){self.lat=event.latLng.lat();self.lng=event.latLng.lng();if(self.marker&&self.marker.setMap){self.marker.setMap(null)}self.marker=new google.maps.Marker({draggable:true,map:self.map,optimized:false,icon:self.markerIcon});listenerForDragMarker();self.marker.setPosition(event.latLng);setLatLngInput()}function setMarkerLatLongInput(){if(self.marker&&self.marker.setMap){self.marker.setMap(null)}self.marker=new google.maps.Marker({draggable:true,map:self.map,optimized:false,icon:self.markerIcon});var latLng=new google.maps.LatLng(self.lat,self.lng);listenerForDragMarker();getExactClickedLocation(latLng);self.marker.setPosition(latLng);self.map.setCenter(latLng);setLatLngInput()}function getExactClickedLocation(latlng,marker,name){var geocoder=new google.maps.Geocoder;geocoder.geocode({latLng:latlng},function(results,status){if(status==google.maps.GeocoderStatus.OK){if(results[0]){if(marker)viewLocationDetailOnMarkerClick(results,marker,name);else viewLocationDetailOnMarkerClickWithEvent(results[0])}}})}function viewLocationDetailOnMarkerClick(results,marker,name){var city;var country;if(results[1]){for(var i=0;i<results[0].address_components.length;i++){for(var b=0;b<results[0].address_components[i].types.length;b++){if(results[0].address_components[i].types[b]=="locality"){city=results[0].address_components[i]}if(results[0].address_components[i].types[b]=="country"){country=results[0].address_components[i]}if(city&&country)break}}$string="";if(name&&country){$string="<div><strong>"+name+", "+country.long_name+"</strong>"}else if(!country&&name){$string="<div><strong>"+name+"</strong>"}else if(city&&country)$string="<div><strong>"+city.long_name+", "+country.long_name+"</strong>";else if(country&&!city)$string="<div><strong>"+country.long_name+"</strong>";else if(!country&&city)$string="<div><strong>"+city.long_name+"</strong>";self.infowindow.setContent($string);self.infowindow.open(self.map,marker)}}function viewLocationDetailOnMarkerClickWithEvent(place){google.maps.event.addListener(self.marker,"click",function(){self.infowindow.setContent("<div><strong>"+"Location"+"</strong><br>"+place.formatted_address+"</div>");self.infowindow.open(self.map,this)})}function getConsecutiveMarkers(arr){if(arr){arr.sort(function(a,b){return a-b});var i=0;var count=0;var temp={sequence:[],notsequence:[]};while(1){if(arr[i+1]!=arr[i]+1&&(i==0||i>0&&arr[i-1]&&arr[i-1]+1!=arr[i])){temp["notsequence"].push(arr[i]);count=temp["sequence"].length}else if(arr[i+1]&&arr[i+1]==arr[i]+1){if(!temp["sequence"][count])temp["sequence"][count]=[];if(temp["sequence"][count].length==0){temp["sequence"][count].push(arr[i])}temp["sequence"][count].push(arr[i+1])}else{count=temp["sequence"].length}if(!arr[i+1])break;i++}return temp}}function rad2degr(rad){return rad*180/Math.PI}function degr2rad(degr){return degr*Math.PI/180}var getLatLngCenter=function(latLngInDegr,latIndex,lngIndex){var LATIDX=latIndex||0;var LNGIDX=lngIndex||1;var sumX=0;var sumY=0;var sumZ=0;for(var i=0;i<latLngInDegr.length;i++){var lat=degr2rad(latLngInDegr[i][LATIDX]);var lng=degr2rad(latLngInDegr[i][LNGIDX]);sumX+=Math.cos(lat)*Math.cos(lng);sumY+=Math.cos(lat)*Math.sin(lng);sumZ+=Math.sin(lat)}var avgX=sumX/latLngInDegr.length;var avgY=sumY/latLngInDegr.length;var avgZ=sumZ/latLngInDegr.length;var lng=Math.atan2(avgY,avgX);var hyp=Math.sqrt(avgX*avgX+avgY*avgY);var lat=Math.atan2(avgZ,hyp);return[rad2degr(lat),rad2degr(lng)]};return{initialize:initialize,viewMap:viewMap,getLatLng:getLatLng,drawPolyLine:drawPolyLine,getLatLngCenter:getLatLngCenter,resetView:resetView,viewMapInDiv:viewMapInDiv,viewSingleMap:viewSingleMap,resetSingleMap:resetSingleMap,zoomLevelSingleMap:zoomLevelSingleMap,viewPolyLineMap:viewPolyLineMap}});;trkbook.controller("searchMapController",["$scope","$http","notify","$timeout","$window","$q","googlemapservice",function($scope,$http,notify,$timeout,$window,$q,googlemapservice){var self=this;$scope=self;self.isApiLoaded=false;self.disableBtn=false;function initialize(){var src="https://maps.googleapis.com/maps/api/js?libraries=geometry,places&language=en&v=3.33&key="+bmGlobalVars.GOOGLE_KEY;if(!self.isApiLoaded){load_js(src,onLoadMapApi)}}function onLoadMapApi(){self.isApiLoaded=true}self.showMapNew=function(productId,isApi){self.disableBtn=true;$http.post($window.baseUrl+"/products/ws/mapdetails",{productId:productId}).success(function(data){self.disableBtn=false;if(data&&data.map_details&&data.map_details.length>0){var coordinates=[];for(var i=0;i<data.map_details.length;i++){var _eachPoint=data.map_details[i];coordinates.push(new google.maps.LatLng(_eachPoint.latitude,_eachPoint.longitude))}$timeout(function(){var obj={};obj.coordinates=coordinates;obj.details=data.map_details;obj.size=null;obj.is_api=isApi=="YES";googlemapservice.initialize("searchMap"+productId,null,true);googlemapservice.viewPolyLineMap(obj)},500)}}).error(function(data,status,headers,config){console.log("error while saving lat lng")})};self.showMap=function(productId,isItineraryTrip,isApi){var tripTitle=$("#map-"+productId).attr("data-triptitle");self.trip_title=tripTitle;self.disableBtn=true;buildModal(productId);if(true){self.showMapNew(productId,isApi)}else{$http.post($window.baseUrl+"/products/ws/getProductMapDetails",{productId:productId}).success(function(data){self.disableBtn=false;if(data&&data[0]&&(data[0].trip_duration_type=="hours"||data[0].trip_duration_type=="minutes"||data[0].trip_duration_type=="days"&&data[0].trip_duration==1)){plotSingleMap(data[0],productId)}else if(data&&data[0]&&!isItineraryTrip){plotImage(data[0].bm_map_url,productId)}else return}).error(function(data,status,headers,config){console.log("error while getting map details")})}};function plotSingleMap(data,productId){var obj={lat:data.start_lat,lng:data.start_long,name:data.start_city,mapId:"searchMap"+productId};$timeout(function(){googlemapservice.viewSingleMap(obj)},500)}function plotImage(imgSrc,productId){document.getElementById("searchModalBody"+productId).innerHTML="";var html="";imgSrc=$window.baseUrl+"/"+imgSrc;html+='<img src="'+imgSrc+'" class="img-responsive" alt="map">';document.getElementById("searchModalBody"+productId).innerHTML=html}function buildModal(productId){$("[id^=searchModal]").remove();var durationStr="";if(self.duration&&self.duration>1&&self.durationType)durationStr=self.duration+" "+self.durationType;else if(self.duration&&self.duration==1)durationStr=self.duration+" day";html='<div id="searchModal'+productId+'" class="search-anim-map modal fade" tabindex="-1" role="dialog">';html+='<div class="modal-dialog">';html+='<div class="modal-content">';html+='<button type="button" class="close" data-dismiss="modal" >&times;</button>';html+='<div class="modal-div" id="searchModalBody'+productId+'">';html+='<div class="dym-map" style="height: 430px; position: relative;" id="searchMap'+productId+'"><span class="spinner-circle"></span>';html+="</div>";html+='<div class="content-div"><strong class="m-title">'+self.trip_title+'</strong><ul class="trips-list">';html+="<li><strong>Duration: </strong><span>"+durationStr+"</span></li>";html+="<li><strong>Starts/Ends: </strong><span>"+self.startEnd+"</span></li>";html+="</ul>";html+='<div class="ab-holder">';html+='<span class="m-price"><i class="icon-eco7"></i> From <b>'+self.symbol+" "+self.productPrice+"</b>";if(self.crossedPrice!="N/A")html+='<span class="crossed-price">'+self.symbol+" "+self.crossedPrice+"</span>";html+="</span>";html+='<a href="'+self.productPageUrl+'" onclick="window.open(this.href,\'_blank\'); return false;" class="modal-view">View Tour</a>';html+="</div>";html+='</div><span class="bm-watermark"><span class="icon-logo"></span></span>';html+="</div>";html+="</div>";html+="</div>";html+="</div>";$("#main").append(html);$("body").css("position","static");$("#searchModal"+productId).modal({backdrop:"static",keyboard:false});$("#searchModal"+productId).modal("show")}initialize()}]);;var iOSCheck=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;var updateWishList=function(data){var wishListTop=document.getElementById("wish-list-top-li");var id="#wishlist-"+data.userId+"-"+data.productId;$(id).toggleClass("wish-active");if($(id).hasClass("wish-active")){$(id+" .wish-popover").html("<span>Added to your Tour Wish List.<br>To access your Tour Wish List, click <a href='"+baseUrl+"/your-tour-wish-list' target='_blank' rel='noopener'>here</a>.</span>")}else{$(id+" .wish-popover").html("<span>Removed from your Tour Wish List</span>")}$.ajax({type:"POST",url:window.baseUrl+"/products/ws/updatewishlist",data:data,success:function(result){if(!!wishListTop&&result){if(result["count"]>0)wishListTop.style.display="block";else wishListTop.style.display="none"}}})};var listenClickEvent=function(uid,pid){var data={};data.productId=pid;data.userId=uid;updateWishList(data)};var listenHoverEvent=function(uid,pid){var tid="#wishlist-"+uid+"-"+pid;if(!isTouchDevice){$(tid).addClass("showing-popover");if($(tid).hasClass("wish-active")){$(tid+" .wish-popover").html("<span>Remove from your Tour Wish List</span>")}else{$(tid+" .wish-popover").html("<span>Add to your Tour Wish List</span>")}}else{$(tid).addClass("showing-popover touch-mode");if(iOSCheck)listenClickEvent(uid,pid)}};$(function(){var checkTooltipActive=function(id){};var activateWishListOnLoad=function(){$.ajax({type:"GET",url:window.baseUrl+"/products/ws/getwishList",success:function(results){if(results&&results[0]){for(var i=0;i<results.length;i++){(function(){var id="#wishlist-"+results[i].user_id+"-"+results[i].product_id;$(id).addClass("wish-active")})()}}}})};var init=function(){activateWishListOnLoad()};init()});